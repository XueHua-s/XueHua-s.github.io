import{j as p}from"./jsx-runtime.D_zvdyIk.js";import{r as u}from"./index.vDeobAm6.js";import{M as G,u as R,P as V,j as K,a as U,L as W,k as X,l as Y,p as J}from"./proxy.DzZABkkb.js";import{a as $}from"./utils.09jiQjc0.js";import{c as Q}from"./index.CDeUW-aT.js";class Z extends u.Component{getSnapshotBeforeUpdate(n){const t=this.props.childRef.current;if(t&&n.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function ee({children:e,isPresent:n}){const t=u.useId(),r=u.useRef(null),o=u.useRef({width:0,height:0,top:0,left:0}),{nonce:l}=u.useContext(G);return u.useInsertionEffect(()=>{const{width:c,height:d,top:s,left:i}=o.current;if(n||!r.current||!c||!d)return;r.current.dataset.motionPopId=t;const a=document.createElement("style");return l&&(a.nonce=l),document.head.appendChild(a),a.sheet&&a.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${d}px !important;
            top: ${s}px !important;
            left: ${i}px !important;
          }
        `),()=>{document.head.removeChild(a)}},[n]),p.jsx(Z,{isPresent:n,childRef:r,sizeRef:o,children:u.cloneElement(e,{ref:r})})}const te=({children:e,initial:n,isPresent:t,onExitComplete:r,custom:o,presenceAffectsLayout:l,mode:c})=>{const d=R(ne),s=u.useId(),i=u.useCallback(f=>{d.set(f,!0);for(const h of d.values())if(!h)return;r&&r()},[d,r]),a=u.useMemo(()=>({id:s,initial:n,isPresent:t,custom:o,onExitComplete:i,register:f=>(d.set(f,!1),()=>d.delete(f))}),l?[Math.random(),i]:[t,i]);return u.useMemo(()=>{d.forEach((f,h)=>d.set(h,!1))},[t]),u.useEffect(()=>{!t&&!d.size&&r&&r()},[t]),c==="popLayout"&&(e=p.jsx(ee,{isPresent:t,children:e})),p.jsx(V.Provider,{value:a,children:e})};function ne(){return new Map}const L=e=>e.key||"";function M(e){const n=[];return u.Children.forEach(e,t=>{u.isValidElement(t)&&n.push(t)}),n}const ge=({children:e,custom:n,initial:t=!0,onExitComplete:r,presenceAffectsLayout:o=!0,mode:l="sync",propagate:c=!1})=>{const[d,s]=K(c),i=u.useMemo(()=>M(e),[e]),a=c&&!d?[]:i.map(L),f=u.useRef(!0),h=u.useRef(i),m=R(()=>new Map),[b,A]=u.useState(i),[v,w]=u.useState(i);U(()=>{f.current=!1,h.current=i;for(let x=0;x<v.length;x++){const g=L(v[x]);a.includes(g)?m.delete(g):m.get(g)!==!0&&m.set(g,!1)}},[v,a.length,a.join("-")]);const I=[];if(i!==b){let x=[...i];for(let g=0;g<v.length;g++){const E=v[g],j=L(E);a.includes(j)||(x.splice(g,0,E),I.push(E))}l==="wait"&&I.length&&(x=I),w(M(x)),A(i);return}const{forceRender:k}=u.useContext(W);return p.jsx(p.Fragment,{children:v.map(x=>{const g=L(x),E=c&&!d?!1:i===v||a.includes(g),j=()=>{if(m.has(g))m.set(g,!0);else return;let T=!0;m.forEach(D=>{D||(T=!1)}),T&&(k?.(),w(h.current),c&&s?.(),r&&r())};return p.jsx(te,{isPresent:E,initial:!f.current||t?void 0:!1,custom:E?void 0:n,presenceAffectsLayout:o,mode:l,onExitComplete:E?void 0:j,children:x},g)})})};function be(){!X.current&&Y();const[e]=u.useState(J.current);return e}const N=[];function z(e){const n=[],t=[];return e.forEach(r=>{const o={...r,children:[]};for(;t.length>0&&t[t.length-1].level>=o.level;)t.pop();if(t.length===0)n.push(o);else{const l=t[t.length-1];l.children.push(o),o.parent=l}t.push(o)}),n}function re(e){return e?e.map(n=>"depth"in n?{id:n.slug,text:n.text,level:n.depth}:n):[]}const H={key:"",headings:N};function B(e){return e.map(n=>`${n.id}:${n.level}:${n.text}:${B(n.children)}`).join("|")}function oe(){if(typeof document>"u")return[];const e=document.querySelector(".custom-content")??document.querySelector("article");if(!e)return[];const n=Array.from(e.querySelectorAll("h1, h2, h3, h4, h5, h6")).filter(t=>!t.closest(".link-preview-block"));return n.length===0?[]:z(n.map((t,r)=>{let o=t.id;return o||(o=(t.textContent||"").toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").trim()||`heading-${r}`,t.id=o),{id:o,text:t.textContent||"",level:parseInt(t.tagName.substring(1),10)}}))}function P(){const e=oe(),n=B(e);return n===H.key?!1:(H.key=n,H.headings=e,!0)}function se(e){if(typeof document>"u")return()=>{};let n=null,t=null,r=null;const o=()=>{r===null&&(r=requestAnimationFrame(()=>{r=null,P()&&e()}))},l=()=>{n?.disconnect();const a=document.querySelector(".custom-content")??document.querySelector("article");if(!a){t=requestAnimationFrame(()=>{l()});return}n=new MutationObserver(()=>{o()}),n.observe(a,{childList:!0,subtree:!0}),P(),o()},c=document.querySelector(".custom-content")??document.querySelector("article"),d=c?c.querySelector("h1, h2, h3, h4, h5, h6"):null;c&&d?l():requestAnimationFrame(()=>{requestAnimationFrame(()=>{l()})});const s=()=>{t&&cancelAnimationFrame(t),requestAnimationFrame(()=>{requestAnimationFrame(()=>{l()})})};document.addEventListener("astro:page-load",s),document.addEventListener("astro:after-swap",s);const i=setTimeout(()=>{o()},100);return()=>{t&&cancelAnimationFrame(t),r&&cancelAnimationFrame(r),clearTimeout(i),n?.disconnect(),document.removeEventListener("astro:page-load",s),document.removeEventListener("astro:after-swap",s)}}function ve(e){const n=u.useSyncExternalStore(se,()=>H.headings,()=>N);return u.useMemo(()=>n.length>0?n:e&&e.length>0?z(re(e)):n,[n,e])}function S(e,n){for(const t of e){if(t.id===n)return t;const r=S(t.children,n);if(r)return r}return null}function O(e){const n=[];let t=e.parent;for(;t;)n.push(t.id),t=t.parent;return n}function _(e,n){const t=[];return e.parent?(e.parent.children.forEach(r=>{r.id!==e.id&&r.children.length>0&&t.push(r.id)}),t):(n.forEach(r=>{r.id!==e.id&&r.children.length>0&&t.push(r.id)}),t)}function ie(e){let n="";const t=new Set;let r=null;const o=new Map,l=()=>{t.forEach(i=>i())},c=()=>{if(o.size===0)return;let i="",a=Number.POSITIVE_INFINITY;o.forEach((f,h)=>{f<a&&(a=f,i=h)}),n!==i&&(n=i,l())},d=()=>{r&&r.disconnect(),o.clear();const i=`-${e}px 0px -70% 0px`;r=new IntersectionObserver(f=>{for(const h of f){const m=h.target.id;m&&(h.isIntersecting?o.set(m,h.boundingClientRect.top):o.delete(m))}c()},{rootMargin:i,threshold:0});const a=document.querySelectorAll("h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]");a.forEach(f=>{r?.observe(f)}),a.length>0&&o.size===0&&requestAnimationFrame(()=>{const f=Array.from(a);for(let h=f.length-1;h>=0;h--){const m=f[h];if(m.getBoundingClientRect().top<e&&m.id){n!==m.id&&(n=m.id,l());break}}})},s=()=>{n="",o.clear(),requestAnimationFrame(()=>{d()})};return{subscribe:i=>(t.size===0&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{d()})}),document.addEventListener("astro:page-load",s)),t.add(i),()=>{t.delete(i),t.size===0&&(r&&(r.disconnect(),r=null),document.removeEventListener("astro:page-load",s),o.clear())}),getSnapshot:()=>n,getServerSnapshot:()=>""}}function xe({offsetTop:e=120}={}){const n=u.useMemo(()=>ie(e),[e]);return u.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getServerSnapshot)}function ye({headings:e,activeId:n,defaultExpanded:t=!1}){const[r,o]=u.useState(()=>{if(t){let s=function(a){a.forEach(f=>{f.children.length>0&&i.add(f.id),s(f.children)})};const i=new Set;return s(e),i}return new Set}),l=u.useMemo(()=>{const s=new Set(r);if(!n||e.length===0)return s;const i=S(e,n);if(!i)return s;const f=[...O(i)];if(i.children.length>0&&f.unshift(n),f.length===0)return s;const h={};return f.forEach(m=>{const b=S(e,m);b&&(h[b.level]||(h[b.level]=[]),h[b.level].push(m))}),Object.keys(h).forEach(m=>{const b=parseInt(m);h[b].forEach(v=>{const w=S(e,v);w&&(_(w,e).forEach(k=>s.delete(k)),s.add(v))})}),s},[n,e,r]),c=u.useCallback(s=>l.has(s),[l]),d=u.useCallback(s=>{o(i=>{const a=new Set(i);return a.has(s)?a.delete(s):a.add(s),a})},[]);return{expandedIds:l,isExpanded:c,toggleExpanded:d,setExpandedIds:o}}function Ee({headings:e,setExpandedIds:n}){return u.useCallback(t=>{const r=document.getElementById(t);if(!r)return;r.scrollIntoView({behavior:"smooth",block:"start"}),window.location.hash!==`#${t}`&&history.pushState(null,"",`#${t}`);const o=S(e,t);if(!o)return;const l=O(o);o.children.length>0&&l.unshift(t),l.length!==0&&n(c=>{const d=new Set(c),s={};return l.forEach(i=>{const a=S(e,i);a&&(s[a.level]||(s[a.level]=[]),s[a.level].push(i))}),Object.keys(s).forEach(i=>{const a=parseInt(i,10);s[a].forEach(h=>{const m=S(e,h);m&&(_(m,e).forEach(A=>d.delete(A)),d.add(h))})}),d})},[e,n])}const ae=.75,le=1,ce=({heading:e,depth:n=0,isActive:t=!1,isExpanded:r=!1,onHeadingClick:o,renderChildren:l})=>{const c=e.children.length>0;return p.jsxs("div",{className:"heading-tree-item relative",children:[p.jsxs("a",{href:`#${e.id}`,onClick:d=>{d.preventDefault(),o(e.id)},className:$("heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2",{"bg-primary/10 text-primary border-l-primary hover:text-primary hover:bg-primary/10 font-medium":t}),style:{paddingLeft:`${ae+n*le}rem`,paddingRight:c?"0.5rem":"0.75rem"},"data-level":e.level,"aria-label":e.text,"aria-current":t?"location":void 0,children:[p.jsx("span",{className:"heading-text block flex-1 truncate leading-relaxed",children:e.text}),t&&p.jsx("span",{className:"text-primary ml-2 text-xs",children:"•"})]}),c&&r&&l&&p.jsx("div",{className:"heading-children",children:l(e.children,n+1)})]},e.id)},q=u.memo(ce),ue=({headings:e,depth:n=0,activeId:t,expandedIds:r,onHeadingClick:o})=>{const l=(c,d)=>c.map(s=>p.jsx(q,{heading:s,depth:d,isActive:t===s.id,isExpanded:r.has(s.id),onHeadingClick:o,renderChildren:l},s.id));return p.jsx(p.Fragment,{children:e.map(c=>p.jsx(q,{heading:c,depth:n,isActive:t===c.id,isExpanded:r.has(c.id),onHeadingClick:o,renderChildren:l},c.id))})},Ce=u.memo(ue),Se={alternate:"snow"},we={github:{url:"https://github.com/XueHua-s",label:"GitHub",iconText:"GH",iconClass:"fa-brands fa-github",color:"#191717"},x:{url:"https://x.com/xiaoxueljx?s=21",label:"X (推特)",iconText:"X",iconClass:"fa-brands fa-x-twitter",color:"#4b9ae4"},email:{url:"mailto:xuehualjx@gmail.com",label:"Email",iconText:"@",iconClass:"fa-regular fa-envelope",color:"#55acd5"},telegram:{url:"https://t.me/litleSnow",label:"Telegram",iconText:"TG",iconClass:"fa-brands fa-telegram",color:"#229ed9"},bilibili:{url:"https://space.bilibili.com/158525031",label:"哔哩哔哩",iconText:"B",iconClass:"fa-brands fa-bilibili",color:"#00a1d6"}};Array.from({length:13},(e,n)=>n+1).map(e=>`/img/cover/${e}.webp`);const y="/blog";var C=(e=>(e[e.Home=y]="Home",e.About=`${y}/about`,e.Categories=`${y}/categories`,e.Tags=`${y}/tags`,e.Friends=`${y}/friends`,e.Weekly=`${y}/weekly`,e.Post=`${y}/post`,e.Posts=`${y}/posts`,e.Archives=`${y}/archives`,e))(C||{});const ke=[{name:"首页",path:C.Home,icon:"fa-solid fa-house-chimney"},{name:"文章",icon:"fa-solid fa-pen-nib",children:[{name:"分类",path:C.Categories,icon:"fa-solid fa-layer-group"},{name:"标签",path:C.Tags,icon:"fa-solid fa-tags"},{name:"周刊",path:C.Weekly,icon:"fa-regular fa-newspaper"}]},{name:"友链",path:C.Friends,icon:"fa-solid fa-link"},{name:"关于",path:C.About,icon:"fa-regular fa-circle-user"}],F=Q("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline","gradient-shoka":"bg-gradient-shoka-button text-primary-foreground",unstyle:""},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}});function Ae({url:e,label:n,variant:t,size:r,className:o,children:l,...c}){if(typeof e=="string"&&e.length>0){const s=c;return p.jsx("a",{href:e,"aria-label":n,className:$(F({variant:t,size:r}),o),...s,children:l})}return p.jsx("button",{type:"button",className:$(F({variant:t,size:r}),o),...c,children:l})}export{ge as A,Ae as B,Ce as H,C as R,xe as a,ye as b,Ee as c,be as d,we as e,Se as f,ke as r,ve as u};
