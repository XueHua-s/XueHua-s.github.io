const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/mermaid.core.qLugkBY0.js","_astro/preload-helper.BlTxHScW.js","_astro/_commonjsHelpers.CqkleIqs.js","_astro/_Uint8Array.CF0sjrPO.js"])))=>i.map(i=>d[i]);
import{r as O}from"./index.vDeobAm6.js";import{c as H,a as R}from"./clipboard.o_vaJMhi.js";import{_ as j}from"./preload-helper.BlTxHScW.js";import"./_commonjsHelpers.CqkleIqs.js";function V(e){if(e.classList.contains("mermaid"))return"mermaid";const n=e.getAttribute("data-language");if(n)return n;const t=e.querySelector("code");if(t){const r=t.className.split(" ").find(o=>o.startsWith("language-"));if(r)return r.replace("language-","")}return"text"}function Z(e){return e.querySelector("code")?.textContent||""}function G(e){return e.querySelector("code")?.innerHTML||""}function K(e){return e.className}function U(e){return e.getAttribute("style")||""}function J(e){return e.querySelector("code")?.className||""}function Q(e){return e.replace(/[&<>"']/g,"")}function ee(e,n={}){const{enableCopy:t=!0,enableFullscreen:a=!0}=n;return`
    <div class="code-block-toolbar">
      <div class="code-block-dots">
        <span class="code-block-dot red"></span>
        <span class="code-block-dot yellow"></span>
        <span class="code-block-dot green"></span>
        <span class="code-block-language">${Q(e)}</span>
      </div>
      <div class="code-block-actions">
        ${a?`
        <button
          class="code-block-button code-block-fullscreen"
          aria-label="全屏查看"
          title="全屏查看"
        >
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
          </svg>
        </button>`:""}
        ${t?`
        <button
          class="code-block-button code-block-copy"
          aria-label="复制代码"
          title="复制代码"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 448 512" fill="currentColor">
            <path d="M192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-200.6c0-17.4-7.1-34.1-19.7-46.2L370.6 17.8C358.7 6.4 342.8 0 326.3 0L192 0zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-64 0 0 16-192 0 0-256 16 0 0-64-16 0z"/>
          </svg>
        </button>`:""}
      </div>
    </div>
  `}function te(e,n={}){if(e.dataset.enhanced==="true")return null;const t=V(e);if(t==="mermaid")return null;const a=Z(e),r=G(e),o=K(e),i=U(e),c=J(e),l=document.createElement("div");return l.className="code-block-wrapper",e.parentNode?.insertBefore(l,e),l.appendChild(e),e.insertAdjacentHTML("beforebegin",ee(t,n)),e.dataset.enhanced="true",e.dataset.language=t,{element:e,language:t,code:a,codeHTML:r,preClassName:o,preStyle:i,codeClassName:c}}function ne(e,n={}){const{enableCopy:t=!0,enableFullscreen:a=!0}=n;e.querySelectorAll("pre").forEach(o=>{const i=o,c=te(i,{enableCopy:t,enableFullscreen:a});if(c){if(t){const l=i.parentElement?.querySelector(".code-block-copy");if(l){const m=l.innerHTML,d=R("checkmark-anim"),f=async()=>{await H(c.code)&&(l.classList.add("copied"),l.innerHTML=d,n.onCopy?.(c.code),setTimeout(()=>{l.classList.remove("copied"),l.innerHTML=m},2e3))};l.addEventListener("click",()=>{f()})}}if(a){const l=i.parentElement?.querySelector(".code-block-fullscreen");l&&l.addEventListener("click",()=>{n.onFullscreen?.(c)})}}})}function ae(e,n){let t=e.nextSibling;for(;t;){if(t.nodeType===Node.TEXT_NODE&&t.textContent?.trim()===""){t=t.nextSibling;continue}return t===n}return!1}function A(e){const n=Array.from(e.querySelectorAll(".markdown-image-wrapper"));let t=[];const a=()=>{if(t.length>=2){const r=document.createElement("div");r.className="markdown-image-row",t[0].parentNode?.insertBefore(r,t[0]);const o=document.createDocumentFragment();t.forEach(i=>{o.appendChild(i)}),r.appendChild(o)}t=[]};n.forEach((r,o)=>{const i=r.classList.contains("portrait");if(r.parentElement?.classList.contains("markdown-image-row"))return;if(!i){a();return}const c=n[o-1];if(t.length>0&&c&&c.classList.contains("portrait")&&ae(c,r)){t.push(r);return}a(),t=[r]}),a()}const S=1,T=5;function q(){return{scale:1,translateX:0,translateY:0,lastPinchDistance:0,isPinching:!1,isPanning:!1,isMouseDragging:!1,lastPanPoint:{x:0,y:0}}}let s=q();function N(e){if(e.length<2)return 0;const n=e[0].clientX-e[1].clientX,t=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+t*t)}function re(e){return e.length<2?{x:e[0].clientX,y:e[0].clientY}:{x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}}function oe(e){if(s.scale<=1)return;const n=e.getBoundingClientRect(),t=window.innerWidth,a=window.innerHeight,r=Math.max(0,(n.width-t)/2+t*.3),o=Math.max(0,(n.height-a)/2+a*.3);s.translateX=Math.max(-r,Math.min(r,s.translateX)),s.translateY=Math.max(-o,Math.min(o,s.translateY))}function w(e){oe(e);const{scale:n,translateX:t,translateY:a}=s;e.style.transform=`translate(${t}px, ${a}px) scale(${n})`,e.style.cursor=n>1?s.isMouseDragging?"grabbing":"grab":"zoom-in"}function b(e){s=q(),e&&(e.style.transform="",e.style.cursor="zoom-in")}function se(e,n){e.addEventListener("touchstart",t=>{t.touches.length===2?(t.preventDefault(),s.isPinching=!0,s.lastPinchDistance=N(t.touches)):t.touches.length===1&&s.scale>1&&(s.isPanning=!0,s.lastPanPoint={x:t.touches[0].clientX,y:t.touches[0].clientY})},{passive:!1}),e.addEventListener("touchmove",t=>{if(t.touches.length===2&&s.isPinching){t.preventDefault();const a=N(t.touches),r=a/s.lastPinchDistance;let o=s.scale*r;if(o=Math.max(S,Math.min(T,o)),o!==s.scale){const i=re(t.touches),c=n.getBoundingClientRect(),l=c.left+c.width/2,m=c.top+c.height/2,d=o/s.scale;s.translateX=i.x-(i.x-l-s.translateX)*d-l,s.translateY=i.y-(i.y-m-s.translateY)*d-m,s.scale=o,w(n)}s.lastPinchDistance=a}else if(t.touches.length===1&&s.isPanning&&s.scale>1){t.preventDefault();const a=t.touches[0].clientX-s.lastPanPoint.x,r=t.touches[0].clientY-s.lastPanPoint.y;s.translateX+=a,s.translateY+=r,s.lastPanPoint={x:t.touches[0].clientX,y:t.touches[0].clientY},w(n)}},{passive:!1}),e.addEventListener("touchend",t=>{t.touches.length<2&&(s.isPinching=!1),t.touches.length===0&&(s.isPanning=!1,s.scale>1&&(n.style.cursor="grab")),s.scale<1.05&&b(n)}),e.addEventListener("wheel",t=>{if(!t.ctrlKey&&!t.metaKey)return;t.preventDefault();const a=t.deltaY>0?.9:1.1;let r=s.scale*a;if(r=Math.max(S,Math.min(T,r)),r!==s.scale){const o=n.getBoundingClientRect(),i=o.left+o.width/2,c=o.top+o.height/2,l=r/s.scale;s.translateX=t.clientX-(t.clientX-i-s.translateX)*l-i,s.translateY=t.clientY-(t.clientY-c-s.translateY)*l-c,s.scale=r,w(n)}s.scale<1.05&&b(n)},{passive:!1})}function ce(e,n){n.addEventListener("dblclick",c=>{if(!c.target.classList.contains("markdown-image-lightbox-img"))return;c.preventDefault(),c.stopPropagation();const m=n.style.transform;if(m&&m!==""){b(n);return}const d=n.getBoundingClientRect(),f=d.left+d.width/2,v=d.top+d.height/2,z=c.clientX-(c.clientX-f)*2-f,W=c.clientY-(c.clientY-v)*2-v;n.style.transform=`translate(${z}px, ${W}px) scale(2)`,n.style.cursor="grab"});let t=!1,a={x:0,y:0},r=0,o=0;n.addEventListener("mousedown",c=>{n.style.transform.includes("scale(")&&!n.style.transform.includes("scale(1)")&&(c.preventDefault(),t=!0,a={x:c.clientX,y:c.clientY},n.style.cursor="grabbing")}),e.addEventListener("mousemove",c=>{if(!t)return;const l=c.clientX-a.x,m=c.clientY-a.y;a={x:c.clientX,y:c.clientY},r+=l,o+=m;const d=n.style.transform.match(/scale\(([^)]+)\)/),f=d?Number(d[1]):1;n.style.transform=`translate(${r}px, ${o}px) scale(${f})`});const i=()=>{t&&(t=!1,n.style.cursor="grab")};e.addEventListener("mouseup",i),e.addEventListener("mouseleave",i),se(e,n)}let u=null;function D(e){e.key==="Escape"&&k()}function ie(){const e=document.createElement("div");e.className="markdown-image-lightbox",e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"),e.setAttribute("aria-label","图片全屏查看");const n=document.createElement("button");n.className="markdown-image-lightbox-close",n.setAttribute("type","button"),n.setAttribute("aria-label","关闭"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>';const t=document.createElement("div");t.className="markdown-image-lightbox-content";const a=document.createElement("img");return a.className="markdown-image-lightbox-img",u=a,t.appendChild(a),e.appendChild(n),e.appendChild(t),e.addEventListener("click",r=>{(r.target===e||r.target===t)&&k()}),n.addEventListener("click",k),ce(t,a),e}function le(){let e=document.querySelector(".markdown-image-lightbox");return e?u=e.querySelector(".markdown-image-lightbox-img"):(e=ie(),document.body.appendChild(e)),e}function P(e,n){const t=le();b(u),u&&(u.classList.remove("loaded"),u.src="",u.alt=n,u.src=e,u.onload=()=>{u?.classList.add("loaded")},t.classList.add("active"),document.body.classList.add("lightbox-open"),document.addEventListener("keydown",D))}function k(){const e=document.querySelector(".markdown-image-lightbox");e&&(e.classList.remove("active"),document.body.classList.remove("lightbox-open"),document.removeEventListener("keydown",D),b(u))}const B=new WeakSet;function de(){const e=document.createElement("button");return e.className="markdown-image-fullscreen",e.setAttribute("type","button"),e.setAttribute("aria-label","全屏查看"),e.title="全屏查看",e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" y1="3" x2="14" y2="10"></line><line x1="3" y1="21" x2="10" y2="14"></line></svg>',e}function ue(e){const n=document.createElement("div");n.className="markdown-image-error",n.setAttribute("role","img"),n.setAttribute("aria-label",e.alt?`图片加载失败: ${e.alt}`:"图片加载失败");const t=document.createElement("span");t.className="markdown-image-error-icon",t.setAttribute("aria-hidden","true");const a=document.createElement("span");return a.className="markdown-image-error-text",a.textContent="图片加载失败",n.appendChild(t),n.appendChild(a),n}function X(e){e.classList.add("loaded"),e.naturalHeight>e.naturalWidth*1.2&&e.closest(".markdown-image-wrapper")?.classList.add("portrait");const t=e.closest(".markdown-image-wrapper");if(!t||t.querySelector(".markdown-image-fullscreen"))return;const a=de();t.appendChild(a),e.style.cursor="zoom-in"}function Y(e){e.classList.add("error");const n=e.closest(".markdown-image-wrapper");if(n&&!n.querySelector(".markdown-image-error")){const t=ue(e);n.appendChild(t)}}function me(e){const n=e.target;if(n.classList.contains("markdown-image")){const t=n;P(t.src,t.alt||"图片")}else if(n.closest(".markdown-image-fullscreen")){const a=n.closest(".markdown-image-wrapper")?.querySelector(".markdown-image");a&&(e.stopPropagation(),P(a.src,a.alt||"图片"))}}function he(e){const n=e.querySelectorAll(".markdown-image");let t=0;const a=n.length;e.addEventListener("click",me);const r=()=>{t++,t>=a&&A(e)};n.forEach(o=>{if(B.has(o)){r();return}if(B.add(o),o.complete&&o.naturalWidth>0){X(o),r();return}if(o.complete&&o.naturalWidth===0){Y(o),r();return}o.addEventListener("load",()=>{X(o),r()},{once:!0}),o.addEventListener("error",()=>{Y(o),r()},{once:!0})}),a===0&&A(e)}const h=[],p=[];let x=null,g=null,$=!1,L=null;function F(e){x=e}function fe(e){g=e}function pe(e){$=e}function ge(e){L=e}function be(){return(document.documentElement.getAttribute("data-theme")??document.body?.getAttribute("data-theme"))==="dark"?"dark":"default"}async function C(){const e=document.querySelectorAll("pre.mermaid:not([data-processed])");if(e.length!==0){if(!g){const{default:n}=await j(async()=>{const{default:t}=await import("./mermaid.core.qLugkBY0.js").then(a=>a.be);return{default:t}},__vite__mapDeps([0,1,2,3]));fe(n)}if(g){g.initialize({startOnLoad:!1,theme:be(),gitGraph:{mainBranchName:"main",showCommitLabel:!0,showBranches:!0,rotateCommitLabel:!0}});for(const n of e){n.hasAttribute("data-diagram")||n.setAttribute("data-diagram",n.textContent||"");const t=n.getAttribute("data-diagram")||"",a=`mermaid-${Math.random().toString(36).slice(2,11)}`;try{const{svg:r}=await g.render(a,t);n.innerHTML=r}catch(r){console.error("[mermaid-nav-fix] Error:",r)}finally{n.setAttribute("data-processed","true")}}window.dispatchEvent(new CustomEvent("mermaid:rendered"))}}}function ve(){if($)return;document.addEventListener("astro:after-swap",()=>{requestAnimationFrame(()=>{C()})}),L&&L.disconnect();const e=new MutationObserver(()=>{document.querySelectorAll("pre.mermaid[data-processed]").forEach(n=>n.removeAttribute("data-processed")),C()});e.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),ge(e),pe(!0)}function we(){return`
    <div class="mermaid-toolbar">
      <div class="mermaid-dots">
        <span class="mermaid-dot red"></span>
        <span class="mermaid-dot yellow"></span>
        <span class="mermaid-dot green"></span>
        <span class="mermaid-language">mermaid</span>
      </div>
      <div class="mermaid-actions">
        <button class="mermaid-button mermaid-fullscreen" aria-label="Fullscreen" title="Fullscreen">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
          </svg>
        </button>
        <button class="mermaid-button mermaid-copy" aria-label="Copy source" title="Copy source">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 448 512" fill="currentColor">
            <path d="M192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-200.6c0-17.4-7.1-34.1-19.7-46.2L370.6 17.8C358.7 6.4 342.8 0 326.3 0L192 0zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-64 0 0 16-192 0 0-256 16 0 0-64-16 0z"/>
          </svg>
        </button>
      </div>
    </div>
  `}function ye(){const e=`checkmark-mermaid-${Date.now()}`;return`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
      <mask id="${e}">
        <g fill="none" stroke="#fff" stroke-dasharray="24" stroke-dashoffset="24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
          <path d="M2 13.5l4 4l10.75 -10.75"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.4s" values="24;0"/></path>
          <path stroke="#000" stroke-width="6" d="M7.5 13.5l4 4l10.75 -10.75"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"/></path>
          <path d="M7.5 13.5l4 4l10.75 -10.75"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"/></path>
        </g>
      </mask>
      <rect width="24" height="24" fill="currentColor" mask="url(#${e})"/>
    </svg>`}function E(e){return e.parentElement?.classList.contains("mermaid-wrapper")??!1}function y(e){if(e.dataset.toolbarEnhanced==="true"||E(e))return;const n=document.createElement("div");n.className="mermaid-wrapper",e.parentNode?.insertBefore(n,e),n.appendChild(e),e.insertAdjacentHTML("beforebegin",we()),e.dataset.toolbarEnhanced="true";const t=e.getAttribute("data-diagram")||e.textContent||"",a=n.querySelector(".mermaid-copy");if(a){const o=a.innerHTML,i=async()=>{await H(t)&&(a.classList.add("copied"),a.innerHTML=ye(),setTimeout(()=>{a.classList.remove("copied"),a.innerHTML=o},2e3))};a.addEventListener("click",()=>{i()})}const r=n.querySelector(".mermaid-fullscreen");r&&r.addEventListener("click",()=>{const o=e.innerHTML;window.dispatchEvent(new CustomEvent("open-mermaid-fullscreen",{detail:{svg:o,source:t}}))})}function I(){for(const e of h)e.disconnect();h.length=0;for(const e of p)clearTimeout(e);p.length=0,x&&(window.removeEventListener("mermaid:rendered",x),F(null))}function _(){document.querySelectorAll("pre.mermaid").forEach(n=>{const t=n;if(t.dataset.toolbarEnhanced==="true"||E(t))return;if(t.getAttribute("data-processed")==="true"){y(t);return}const a=new MutationObserver((o,i)=>{for(const c of o)if(c.type==="attributes"&&c.attributeName==="data-processed"&&t.getAttribute("data-processed")==="true"){y(t),i.disconnect();const l=h.indexOf(i);l>-1&&h.splice(l,1);return}});a.observe(t,{attributes:!0,attributeFilter:["data-processed"]}),h.push(a);const r=setTimeout(()=>{a.disconnect();const o=h.indexOf(a);o>-1&&h.splice(o,1);const i=p.indexOf(r);i>-1&&p.splice(i,1),t.dataset.toolbarEnhanced!=="true"&&!E(t)&&y(t)},5e3);p.push(r)})}function ke(){const e=()=>{setTimeout(_,50)};F(e),window.addEventListener("mermaid:rendered",e)}function xe(){ve(),I(),C();const e=setTimeout(_,100);p.push(e),ke()}typeof document<"u"&&document.addEventListener("astro:before-swap",I);const M="data-enhanced";function Le(e){const n=document.querySelector(".custom-content");n&&n.getAttribute(M)!=="true"&&(e.addBlankTarget&&n.querySelectorAll("a[href]").forEach(a=>{const r=a,o=r.getAttribute("href")||"";(o.startsWith("http")||o.startsWith("//"))&&r.setAttribute("target","_blank")}),e.smoothScroll&&n.querySelectorAll('a.anchor-link[href^="#"]').forEach(a=>{const r=a;r.addEventListener("click",o=>{o.preventDefault();const i=r.getAttribute("href")?.substring(1);if(!i)return;const c=document.getElementById(i);c&&(c.scrollIntoView({behavior:"smooth",block:"start"}),history.pushState(null,"",`#${i}`))})}),e.addHeadingLevel&&n.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(a=>{const r=a.tagName[1];a.setAttribute("data-level",`H${r}`)}),e.enhanceCodeBlock&&(ne(n,{enableCopy:e.enableCodeCopy,enableFullscreen:e.enableCodeFullscreen,onFullscreen:t=>{window.dispatchEvent(new CustomEvent("open-code-fullscreen",{detail:{code:t.code,codeHTML:t.codeHTML,language:t.language,preClassName:t.preClassName,preStyle:t.preStyle,codeClassName:t.codeClassName}}))}}),xe()),he(n),n.setAttribute(M,"true"))}function Se({config:e}){return O.useEffect(()=>{const n=()=>{const t=document.querySelector(".custom-content");t&&t.removeAttribute(M),Le(e)};return n(),document.addEventListener("astro:page-load",n),()=>{document.removeEventListener("astro:page-load",n)}},[e]),null}export{Se as CustomContentEnhancer};
