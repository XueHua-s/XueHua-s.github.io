import{j as E}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.vDeobAm6.js";import{M as I,u as k,P as H,e as S,b as T,L as B}from"./proxy.k8ZnVpfL.js";class F extends n.Component{getSnapshotBeforeUpdate(c){const t=this.props.childRef.current;if(t&&c.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function D({children:e,isPresent:c}){const t=n.useId(),s=n.useRef(null),g=n.useRef({width:0,height:0,top:0,left:0}),{nonce:h}=n.useContext(I);return n.useInsertionEffect(()=>{const{width:f,height:r,top:p,left:o}=g.current;if(c||!s.current||!f||!r)return;s.current.dataset.motionPopId=t;const a=document.createElement("style");return h&&(a.nonce=h),document.head.appendChild(a),a.sheet&&a.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${f}px !important;
            height: ${r}px !important;
            top: ${p}px !important;
            left: ${o}px !important;
          }
        `),()=>{document.head.removeChild(a)}},[c]),E.jsx(F,{isPresent:c,childRef:s,sizeRef:g,children:n.cloneElement(e,{ref:s})})}const G=({children:e,initial:c,isPresent:t,onExitComplete:s,custom:g,presenceAffectsLayout:h,mode:f})=>{const r=k(K),p=n.useId(),o=n.useCallback(d=>{r.set(d,!0);for(const x of r.values())if(!x)return;s&&s()},[r,s]),a=n.useMemo(()=>({id:p,initial:c,isPresent:t,custom:g,onExitComplete:o,register:d=>(r.set(d,!1),()=>r.delete(d))}),h?[Math.random(),o]:[t,o]);return n.useMemo(()=>{r.forEach((d,x)=>r.set(x,!1))},[t]),n.useEffect(()=>{!t&&!r.size&&s&&s()},[t]),f==="popLayout"&&(e=E.jsx(D,{isPresent:t,children:e})),E.jsx(H.Provider,{value:a,children:e})};function K(){return new Map}const P=e=>e.key||"";function R(e){const c=[];return n.Children.forEach(e,t=>{n.isValidElement(t)&&c.push(t)}),c}const V=({children:e,custom:c,initial:t=!0,onExitComplete:s,presenceAffectsLayout:g=!0,mode:h="sync",propagate:f=!1})=>{const[r,p]=S(f),o=n.useMemo(()=>R(e),[e]),a=f&&!r?[]:o.map(P),d=n.useRef(!0),x=n.useRef(o),v=k(()=>new Map),[z,A]=n.useState(o),[m,j]=n.useState(o);T(()=>{d.current=!1,x.current=o;for(let l=0;l<m.length;l++){const i=P(m[l]);a.includes(i)?v.delete(i):v.get(i)!==!0&&v.set(i,!1)}},[m,a.length,a.join("-")]);const $=[];if(o!==z){let l=[...o];for(let i=0;i<m.length;i++){const C=m[i],b=P(C);a.includes(b)||(l.splice(i,0,C),$.push(C))}h==="wait"&&$.length&&(l=$),j(R(l)),A(o);return}const{forceRender:M}=n.useContext(B);return E.jsx(E.Fragment,{children:m.map(l=>{const i=P(l),C=f&&!r?!1:o===m||a.includes(i),b=()=>{if(v.has(i))v.set(i,!0);else return;let w=!0;v.forEach(L=>{L||(w=!1)}),w&&(M?.(),j(x.current),f&&p?.(),s&&s())};return E.jsx(G,{isPresent:C,initial:!d.current||t?void 0:!1,custom:C?void 0:c,presenceAffectsLayout:g,mode:h,onExitComplete:C?void 0:b,children:l},i)})})},u="/blog";var y=(e=>(e[e.Home=u]="Home",e.About=`${u}/about`,e.Categories=`${u}/categories`,e.Tags=`${u}/tags`,e.Friends=`${u}/friends`,e.Post=`${u}/post`,e.Posts=`${u}/posts`,e.Archives=`${u}/archives`,e))(y||{});y.Home,y.Categories,y.Tags,y.Friends,y.About;export{V as A,y as R};
