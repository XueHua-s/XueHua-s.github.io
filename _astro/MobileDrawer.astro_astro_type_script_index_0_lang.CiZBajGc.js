import{c as r,d as i}from"./ui.BLGQxPlq.js";import"./index.BSdFiPHn.js";const d={drawer:"mobile-drawer",closeBtn:"close-drawer",overlay:"drawer-overlay"},n={hidden:"hidden",translateX:"-translate-x-full"};class a{elements;unsubscribe=null;constructor(){this.elements=this.initElements(),this.validateElements()&&(this.bindEvents(),this.subscribeToStore())}initElements(){return Object.entries(d).reduce((e,[t,s])=>({...e,[t]:document.getElementById(s)}),{})}validateElements(){return Object.entries(this.elements).every(([e,t])=>{const s=!!t;return s||console.error(`抽屉元素未找到: ${e}`),s})}bindEvents(){document.addEventListener("keydown",this.handleKeyDown),this.elements.closeBtn?.addEventListener("click",this.handleClose),this.elements.overlay?.addEventListener("click",this.handleClose)}subscribeToStore(){this.unsubscribe=i.subscribe(e=>{e?this.open():this.close()})}handleKeyDown=e=>{e.key==="Escape"&&i.get()&&r()};handleClose=()=>{r()};open(){const{drawer:e,overlay:t,closeBtn:s}=this.elements;!e||!t||(e.classList.remove(n.translateX),t.classList.remove(n.hidden),document.body.style.overflow="hidden",s?.focus())}close(){const{drawer:e,overlay:t}=this.elements;!e||!t||(e.classList.add(n.translateX),t.classList.add(n.hidden),document.body.style.overflow="")}destroy(){document.removeEventListener("keydown",this.handleKeyDown),this.elements.closeBtn?.removeEventListener("click",this.handleClose),this.elements.overlay?.removeEventListener("click",this.handleClose),this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}}let o;function l(){o?.destroy(),o=new a}document.readyState!=="loading"&&l();document.addEventListener("astro:page-load",l);document.addEventListener("astro:before-preparation",()=>{r()});
