<!DOCTYPE html><html lang="zh-CN" class="vertical-scrollbar" data-astro-transition-scope="astro-smooz4hq-1"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><meta name="generator" content="Astro v5.16.6"><title>Rust 引用生命周期：不只是切片 | Rust 学习笔记 | 雪花の博客</title><!-- Preconnect to third-party origins for faster resource loading --><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="preconnect" href="https://chinese-font.netlify.app" crossorigin><link rel="dns-prefetch" href="https://chinese-font.netlify.app"><!-- Async load Chinese fonts to avoid render-blocking --><link rel="stylesheet" href="/fonts/ChillRoundFRegular/result.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/fonts/ChillRoundFBold/result.css" media="print" onload="this.media='all'"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.QW52Ox2j.js"></script><style>.astro-loading-indicator {
  pointer-events: none;
  background-color: #e9536a;
  position: fixed;
  z-index: 1031;
  top: 0;
  left: 0;
  width: 100%;
  height: 2px;
  transition: transform 300ms ease-out, opacity 150ms 150ms ease-in;
	transform: translate3d(0, 0, 0) scaleX(var(--progress, 0));
  transform-origin: 0;
}

[dir="rtl"] .astro-loading-indicator {
  transform-origin: 100% 0;
}
</style><script>(function(){const className = "astro-loading-indicator";
const animationDuration = 300;
const threshold = 200;

(() => {
  let progress = 0.25
  let opacity = 0
  /** @type {number | undefined} */
  let trickleInterval = undefined
  /** @type {number | undefined} */
  let thresholdTimeout = undefined;

  const element = document.createElement("div")
  element.classList.add(className)
  element.ariaHidden = "true"

  /** @param {typeof progress} _progress */
  const setProgress = (_progress) => {
    progress = _progress
    element.style.setProperty('--progress', String(progress))
  }

  /** @param {typeof opacity} _opacity */
  const setOpacity = (_opacity) => {
    opacity = _opacity
    element.style.setProperty('opacity', String(opacity))
  }

  setOpacity(opacity)

  document.addEventListener("DOMContentLoaded", () => {
    document.body.prepend(element)
  })

  document.addEventListener("astro:before-preparation", () => {
    thresholdTimeout = setTimeout(() => {
      setOpacity(1)
      trickleInterval = window.setInterval(() => {
        setProgress(progress + Math.random() * 0.03)
      }, animationDuration)
    }, threshold)
  })

  document.addEventListener("astro:before-swap", (ev) => {
    if (!thresholdTimeout) {
      return
    }
    window.clearTimeout(thresholdTimeout)

    ev.newDocument.body.prepend(element)
    window.clearInterval(trickleInterval)
    trickleInterval = undefined

    setProgress(1)
    window.setTimeout(() => {
      setOpacity(0)
    }, animationDuration / 2)

    window.setTimeout(() => {
      setProgress(0.25)
    }, animationDuration * 2)
  })
})()
})();</script><script type="module" src="/_astro/Tooltips.astro_astro_type_script_index_0_lang.Bx2cGmPu.js"></script><!-- metadata --><meta name="description" content="探讨 Rust 中引用生命周期的普遍规律，揭示所有引用类型（切片、结构体字段、数组元素等）都遵循&#34;可短不可长&#34;的生命周期原则。"><meta name="author" content="snow"><meta property="og:type" content="website"><meta property="og:site_name" content="snow"><meta property="og:url" content="https://xhblog.top/blog/post/19/"><meta property="og:title" content="Rust 引用生命周期：不只是切片 | Rust 学习笔记 | 雪花の博客"><meta property="og:description" content="探讨 Rust 中引用生命周期的普遍规律，揭示所有引用类型（切片、结构体字段、数组元素等）都遵循&#34;可短不可长&#34;的生命周期原则。"><!-- <meta property="og:image" content="/opengraph.png?v=1" /> TODO: og image--><meta name="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://xhblog.top/blog/post/19/"><meta name="twitter:title" content="Rust 引用生命周期：不只是切片 | Rust 学习笔记 | 雪花の博客"><meta name="twitter:description" content="探讨 Rust 中引用生命周期的普遍规律，揭示所有引用类型（切片、结构体字段、数组元素等）都遵循&#34;可短不可长&#34;的生命周期原则。"><meta charset="UTF-8"><script>
      // 立即执行主题检查 否则会闪烁
      if (
        localStorage.theme === 'dark' ||
        (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)
      ) {
        document.documentElement.classList.add('dark');
        document.documentElement.classList.remove('light');
        document.documentElement.dataset.theme = 'dark';
      } else {
        document.documentElement.classList.remove('dark');
        document.documentElement.classList.add('light');
        document.documentElement.dataset.theme = 'light';
      }
    </script><script type="module" src="/_astro/Layout.astro_astro_type_script_index_0_lang.IKozfkSn.js"></script><script type="module">let d=!1;function r(){return new Promise((n,t)=>{if(d||window.__CPEmbed){n();return}const e=document.createElement("script");e.src="https://cpwebassets.codepen.io/assets/embed/ei.js",e.async=!0,e.onload=()=>{d=!0,n()},e.onerror=t,document.head.appendChild(e)})}async function o(){if(document.querySelectorAll(".codepen").length!==0)try{await r(),window.__CPEmbed&&window.__CPEmbed()}catch(t){console.error("[CodePen Embed] Failed to load CodePen embed script:",t)}}document.readyState!=="loading"&&o();document.addEventListener("astro:page-load",o);</script><script type="module">function e(){localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.documentElement.classList.add("dark"),document.documentElement.classList.remove("light"),document.documentElement.dataset.theme="dark"):(document.documentElement.classList.remove("dark"),document.documentElement.classList.add("light"),document.documentElement.dataset.theme="light")}document.addEventListener("astro:page-load",e);</script><link rel="stylesheet" href="/_astro/index.Lf6pSiPd.css">
<link rel="stylesheet" href="/_astro/about.DFYg06Ey.css">
<link rel="stylesheet" href="/_astro/_slug_.D059aVq8.css">
<link rel="stylesheet" href="/_astro/about.zl5RRl8W.css"><script type="module" src="/_astro/page.BkXf7kEf.js"></script><style>[data-astro-transition-scope="astro-smooz4hq-1"] { view-transition-name: root; }@layer astro { ::view-transition-old(root) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(root) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(root) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(root) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-smooz4hq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-smooz4hq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-smooz4hq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-smooz4hq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-w335yabn-2"] { view-transition-name: site-header; }@layer astro { ::view-transition-old(site-header) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(site-header) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(site-header) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(site-header) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-w335yabn-2"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-w335yabn-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-w335yabn-2"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-w335yabn-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-w335yabn-2"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-w335yabn-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-w335yabn-2"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-w335yabn-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-uuq6zr5f-3"] { view-transition-name: page-header; }@layer astro { ::view-transition-old(page-header) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(page-header) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(page-header) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(page-header) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-uuq6zr5f-3"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-uuq6zr5f-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-uuq6zr5f-3"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-uuq6zr5f-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-uuq6zr5f-3"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-uuq6zr5f-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-uuq6zr5f-3"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-uuq6zr5f-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style></head> <body> <div class="flex min-h-screen flex-col text-black dark:text-white"> <div id="site-header" class="shadow-text fixed tablet:backdrop-blur inset-x-0 top-0 z-10 gap-4 py-2.5 text-white select-none tablet:py-2 tablet:pl-3 tablet:pr-3" data-astro-transition-scope="astro-w335yabn-2"> <div class="mx-auto flex items-center justify-between tablet:w-full px-6 tablet:px-0 max-w-7xl"> <!-- Desktop: Always show logo --> <a data-astro-transition-persist="page-header-avatar" class="tablet:hidden -my-4 mr-4 flex cursor-pointer items-center justify-center gap-1 whitespace-nowrap" href="/blog" target="_self" title="snow" aria-label="snow"> <img src="/_astro/logo.Bpp0JPuA.webp" alt="snow" class="h-16 mt-2 mb-2"> </a> <!-- Mobile: Menu button + Logo/Header --> <div class="hidden tablet:flex items-center grow"> <!-- 移动端菜单按钮 --> <div id="mobile-menu-container" class="shrink-0"> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><script>(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="ZD9FlW" prefix="r19" component-url="/_astro/MenuIcon.C9Ecrjfj.js" component-export="MenuIcon" renderer-url="/_astro/client.lBR8ML2S.js" props="{}" ssr client="load" opts="{&quot;name&quot;:&quot;MenuIcon&quot;,&quot;value&quot;:true}" await-children><div class="flex-center" style="view-transition-name:home-menu-icon"><button class="flex-center text-shoka size-10 cursor-pointer rounded-full bg-white/20 select-none" aria-label="打开菜单" aria-expanded="false" type="button" style="view-transition-name:menu-icon"><i class="text-xl fa-solid fa-bars" aria-hidden="true" style="opacity:1;transform:none"></i></button></div><!--astro:end--></astro-island> </div> <!-- 移动端logo（非文章页）或 MobilePostHeader（文章页显示标题）- 居中显示 --> <div class="flex-1 flex items-center justify-center"> <astro-island uid="1qLBvm" prefix="r20" component-url="/_astro/MobilePostHeader.Dgm1MWUO.js" component-export="MobilePostHeader" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;isPostPage&quot;:[0,true],&quot;enableNumbering&quot;:[0,true],&quot;sourceHeadings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;核心原则&quot;],&quot;text&quot;:[0,&quot;核心原则&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;典型案例&quot;],&quot;text&quot;:[0,&quot;典型案例&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-切片引用&quot;],&quot;text&quot;:[0,&quot;1. 切片引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-结构体字段引用&quot;],&quot;text&quot;:[0,&quot;2. 结构体字段引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-数组元素引用&quot;],&quot;text&quot;:[0,&quot;3. 数组元素引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;4-函数参数的局部引用&quot;],&quot;text&quot;:[0,&quot;4. 函数参数的局部引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;5-嵌套引用&quot;],&quot;text&quot;:[0,&quot;5. 嵌套引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;为什么可以更短&quot;],&quot;text&quot;:[0,&quot;为什么可以更短？&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;为什么不能更长&quot;],&quot;text&quot;:[0,&quot;为什么不能更长？&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;实际应用场景&quot;],&quot;text&quot;:[0,&quot;实际应用场景&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-1临时处理数据片段&quot;],&quot;text&quot;:[0,&quot;场景 1：临时处理数据片段&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-2链式引用&quot;],&quot;text&quot;:[0,&quot;场景 2：链式引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-3迭代器中的引用&quot;],&quot;text&quot;:[0,&quot;场景 3：迭代器中的引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;常见陷阱&quot;],&quot;text&quot;:[0,&quot;常见陷阱&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;陷阱-1试图返回局部变量的引用&quot;],&quot;text&quot;:[0,&quot;陷阱 1：试图返回局部变量的引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;陷阱-2在结构体中存储临时引用&quot;],&quot;text&quot;:[0,&quot;陷阱 2：在结构体中存储临时引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;总结&quot;],&quot;text&quot;:[0,&quot;总结&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;核心要点&quot;],&quot;text&quot;:[0,&quot;核心要点&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;记忆口诀&quot;],&quot;text&quot;:[0,&quot;记忆口诀&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;延伸思考&quot;],&quot;text&quot;:[0,&quot;延伸思考&quot;]}]]],&quot;logoElement&quot;:[0,&quot;svg&quot;],&quot;logoText&quot;:[0,&quot;snow&quot;],&quot;logoSrc&quot;:[0,&quot;/_astro/logo.Bpp0JPuA.webp&quot;]}" ssr client="load" opts="{&quot;name&quot;:&quot;MobilePostHeader&quot;,&quot;value&quot;:true}" await-children><link rel="preload" as="image" href="/_astro/logo.Bpp0JPuA.webp"/><a href="/blog" class="flex items-center gap-1"><img src="/_astro/logo.Bpp0JPuA.webp" alt="snow" class="h-8" height="32"/></a><!--astro:end--></astro-island> </div> </div> <div class="tablet:grow-0 flex grow items-center"> <!-- 导航菜单 --> <div class="tablet:hidden flex grow items-center gap-4"> <a href="/blog" aria-label="首页" class="inline-flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 relative text-base tracking-wider after:absolute after:bottom-1 after:left-1/2 after:block after:h-0.5 after:w-0 after:-translate-x-1/2 after:transition-all after:duration-300 hover:after:w-9/12"> <i class="mr-1.5 fa-solid fa-house-chimney" aria-hidden="true"></i>首页 </a><astro-island uid="Zutbg3" prefix="r32" component-url="/_astro/DropdownNav.h4hRA6lZ.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;item&quot;:[0,{&quot;name&quot;:[0,&quot;文章&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-pen-nib&quot;],&quot;children&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;分类&quot;],&quot;path&quot;:[0,&quot;/blog/categories&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-layer-group&quot;]}],[0,{&quot;name&quot;:[0,&quot;标签&quot;],&quot;path&quot;:[0,&quot;/blog/tags&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-tags&quot;]}]]]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;DropdownNav&quot;,&quot;value&quot;:true}" await-children><button class="inline-flex h-10 items-center px-4 py-2 text-base tracking-wider relative after:absolute after:bottom-1 after:left-1/2 after:h-0.5 after:w-0 after:-translate-x-1/2 after:bg-white after:transition-all after:duration-300 after:content-[&quot;&quot;]" aria-expanded="false" aria-haspopup="dialog" aria-label="文章菜单"><i class="mr-1.5 text-sm fa-solid fa-pen-nib" aria-hidden="true"></i>文章<i class="fa-solid fa-caret-down absolute -right-1.5 text-xl transition-transform duration-300" aria-hidden="true"></i></button><!--astro:end--></astro-island><a href="/blog/friends" aria-label="友链" class="inline-flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 relative text-base tracking-wider after:absolute after:bottom-1 after:left-1/2 after:block after:h-0.5 after:w-0 after:-translate-x-1/2 after:transition-all after:duration-300 hover:after:w-9/12"> <i class="mr-1.5 fa-solid fa-link" aria-hidden="true"></i>友链 </a><a href="/blog/about" aria-label="关于" class="inline-flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 relative text-base tracking-wider after:absolute after:bottom-1 after:left-1/2 after:block after:h-0.5 after:w-0 after:-translate-x-1/2 after:transition-all after:duration-300 hover:after:w-9/12"> <i class="mr-1.5 fa-regular fa-circle-user" aria-hidden="true"></i>关于 </a> </div> <div class="ml-auto flex items-center gap-2"> <!-- Search trigger button --><button id="search-trigger" class="group cursor-pointer transition duration-300 hover:scale-125" aria-label="搜索" title="搜索 (⌘K)" data-astro-cid-qjvbd4rp> <i class="fa-solid fa-magnifying-glass text-2xl" aria-hidden="true" data-astro-cid-qjvbd4rp></i> </button> <!-- Search Component - will be portal'd into dialog --> <div id="search-component-portal" data-astro-cid-qjvbd4rp> <div id="search-for-dialog" class="pagefind-ui pagefind-init" data-pagefind-ui data-bundle-path="/pagefind/" data-ui-options="{&#34;showImages&#34;:false,&#34;resetStyles&#34;:false,&#34;translations&#34;:{&#34;placeholder&#34;:&#34;请输入关键词搜索&#34;,&#34;clear_search&#34;:&#34;清空&#34;,&#34;load_more&#34;:&#34;加载更多结果&#34;,&#34;search_label&#34;:&#34;搜索本站&#34;,&#34;filters_label&#34;:&#34;过滤器&#34;,&#34;zero_results&#34;:&#34;没有找到结果&#34;,&#34;many_results&#34;:&#34;[COUNT] 个结果&#34;,&#34;one_result&#34;:&#34;[COUNT] 个结果&#34;,&#34;alt_search&#34;:&#34;没有找到结果。显示 [DIFFERENT_TERM] 的结果&#34;,&#34;search_suggestion&#34;:&#34;没有找到结果。尝试以下搜索：&#34;,&#34;searching&#34;:&#34;搜索 [SEARCH_TERM]...&#34;}}"></div> <script type="module" src="/_astro/Search.astro_astro_type_script_index_0_lang.mkdr79ir.js"></script> </div> <script type="module" src="/_astro/SearchWithDialog.astro_astro_type_script_index_0_lang.C3hzVZG7.js"></script>  <style is:global>
  /* https://github.com/parcel-bundler/lightningcss/issues/887 */
  .scroll-feather-mask {
    container-type: scroll-state;
  }
  @container scroll-state(scrollable: bottom) {
    .scroll-feather-mask::before {
      content: '';
      background: linear-gradient(
        to bottom,
        transparent 0%,
        var(--gradient-bg-start) var(--scroll-mask-middle, 70%),
        var(--gradient-bg-start) var(--scroll-mask-end, 100%)
      );
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 10;
      display: block;
      height: var(--scroll-mask-height, 5rem);
    }
  }
</style> <div class="theme-toggle text-2xl cursor-pointer transition-transform duration-300 hover:scale-110" id="theme-toggle-btn" role="button" tabindex="0" aria-label="toggle theme" data-astro-cid-bntdbwai> <i class="fa-solid fa-sun text-2xl light-icon transition-all duration-300" data-astro-cid-bntdbwai></i> <i class="fa-solid fa-moon text-2xl dark-icon transition-all duration-300" data-astro-cid-bntdbwai></i> </div> <script type="module" src="/_astro/ThemeToggle.astro_astro_type_script_index_0_lang.CQInHujw.js"></script>  </div> </div> <script>
  let firstScroll = true;
  let triggerDistance = window.innerHeight * 0.45;
  let lastScrollY = 0;
  let scrollHandler = null;

  const handleScroll = () => {
    const siteHeader = document.getElementById('site-header');
    const currentScrollY = window.scrollY;
    const isBeyond = currentScrollY > triggerDistance;

    if (siteHeader) {
      if (isBeyond) {
        siteHeader.classList.add('with-background');
      } else {
        siteHeader.classList.remove('with-background');
      }
    }

    if (firstScroll) {
      firstScroll = false;
      return;
    }

    // Header 保持固定在顶部，不随滚动隐藏
    lastScrollY = currentScrollY;
  };

  // 节流函数
  function throttle(func, limit) {
    let lastFunc;
    let lastRan;
    return function () {
      const context = this;
      const args = arguments;
      if (!lastRan) {
        func.apply(context, args);
        lastRan = Date.now();
      } else {
        clearTimeout(lastFunc);
        lastFunc = setTimeout(
          function () {
            if (Date.now() - lastRan >= limit) {
              func.apply(context, args);
              lastRan = Date.now();
            }
          },
          limit - (Date.now() - lastRan),
        );
      }
    };
  }

  function initNavigator() {
    // 清理旧的监听器
    if (scrollHandler) {
      window.removeEventListener('scroll', scrollHandler);
    }

    // 重置状态
    firstScroll = true;
    triggerDistance = window.innerHeight * 0.45;
    lastScrollY = 0;

    // 添加新监听器
    scrollHandler = throttle(handleScroll, 80);
    window.addEventListener('scroll', scrollHandler, { passive: true });
  }

  // 首次加载时立即初始化
  if (document.readyState !== 'loading') {
    initNavigator();
  }

  // 监听后续页面导航
  document.addEventListener('astro:page-load', initNavigator);

  // 页面切换前清理
  document.addEventListener('astro:before-swap', () => {
    if (scrollHandler) {
      window.removeEventListener('scroll', scrollHandler);
      scrollHandler = null;
    }
  });
</script> </div> </div> <main class="relative flex grow flex-col gap-4">   <div class="flex flex-col"> <div class="relative flex h-[60dvh] max-h-200 overflow-hidden"> <div class="absolute inset-0 h-full bg-black/40"></div> <div class="absolute inset-0 bottom-[8dvh] flex flex-col items-center justify-center px-5 text-white">  <h1 class="shadow-text word-break text-4.5xl text-center font-bold md:text-2xl max-w-7xl flex flex-wrap items-center justify-center gap-3"> Rust 引用生命周期：不只是切片  </h1> <p class="mt-3 flex items-center justify-center gap-4 md:text-xs"> <span class="flex items-center gap-1"> <i class="fa-regular fa-calendar-days" aria-hidden="true"></i>
发表于 2025-11-27 </span> <span class="flex items-center gap-1"> <i class="fa-solid fa-pen-nib" aria-hidden="true"></i> 1767 字
</span> <span class="flex items-center gap-1"> <i class="fa-regular fa-clock" aria-hidden="true"></i> 9 min read </span> </p> </div> <div class="relative -z-10 h-full min-h-60 w-full" data-astro-transition-persist="page-cover-banner" id="banner-box"> <img src="/img/backgrounds/3088f24fa2ad95399511f6af3f456dbe.webp" alt="cover" class="h-full w-full object-cover" sizes="50vw"> </div> <div class="wave-wrap"><svg class="wave" xmlns="http://www.w3.org/2000/svg" viewBox="0 24 150 28" preserveAspectRatio="none"><defs><path id="gentle-wave" d="m -160,44.4 c 30,0 58,-18 87.7,-18 30.3,0 58.3,18 87.3,18 30,0 58,-18 88,-18 30,0 58,18 88,18 l 0,34.5 -351,0 z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="50" y="0" fill="rgba(255, 255, 255, 0.48)"></use><use xlink:href="#gentle-wave" x="50" y="3" fill="rgba(255, 255, 255, 0.78)"></use><use xlink:href="#gentle-wave" x="50" y="6" fill="rgba(255, 255, 255, 0.8)"></use></g></svg></div> </div> <div class="mx-auto md:mx-0 flex w-full items-start justify-center gap-6 lg:gap-10 md:w-full max-w-7xl"> <div class="mx-6 lg:mx-8"> <div class="page-home-sider shadow-home-sider sticky top-0 self-start flex min-w-64 max-w-64 flex-col tablet:hidden overflow-auto h-screen items-center px-2" transition:name="page-home-sider" data-astro-cid-nxumbhks> <astro-island uid="ZITM8i" prefix="r10" component-url="/_astro/HomeSiderSegmented.Ci8JRtoo.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;className&quot;:[0,&quot;my-4 flex w-full justify-between text-sm/6&quot;],&quot;itemClass&quot;:[0,&quot;grow&quot;],&quot;defaultValue&quot;:[0,&quot;directory&quot;],&quot;id&quot;:[0,&quot;inner-home-sider&quot;],&quot;data-astro-cid-nxumbhks&quot;:[0,true]}" ssr client="load" opts="{&quot;name&quot;:&quot;HomeSiderSegmented&quot;,&quot;value&quot;:true}" await-children><div class="cursor-pointer rounded-sm bg-black/8 p-1 font-semibold backdrop-blur-lg select-none my-4 flex w-full justify-between text-sm/6"><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs opacity-50 grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM15.8329 7.33748C16.0697 7.17128 16.3916 7.19926 16.5962 7.40381C16.8002 7.60784 16.8267 7.92955 16.6587 8.16418C14.479 11.2095 13.2796 12.8417 13.0607 13.0607C12.4749 13.6464 11.5251 13.6464 10.9393 13.0607C10.3536 12.4749 10.3536 11.5251 10.9393 10.9393C11.3126 10.5661 12.9438 9.36549 15.8329 7.33748ZM17.5 11C18.0523 11 18.5 11.4477 18.5 12C18.5 12.5523 18.0523 13 17.5 13C16.9477 13 16.5 12.5523 16.5 12C16.5 11.4477 16.9477 11 17.5 11ZM6.5 11C7.05228 11 7.5 11.4477 7.5 12C7.5 12.5523 7.05228 13 6.5 13C5.94772 13 5.5 12.5523 5.5 12C5.5 11.4477 5.94772 11 6.5 11ZM8.81802 7.40381C9.20854 7.79433 9.20854 8.4275 8.81802 8.81802C8.4275 9.20854 7.79433 9.20854 7.40381 8.81802C7.01328 8.4275 7.01328 7.79433 7.40381 7.40381C7.79433 7.01328 8.4275 7.01328 8.81802 7.40381ZM12 5.5C12.5523 5.5 13 5.94772 13 6.5C13 7.05228 12.5523 7.5 12 7.5C11.4477 7.5 11 7.05228 11 6.5C11 5.94772 11.4477 5.5 12 5.5Z"></path></svg></span></div><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs text-primary-foreground grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M5.75024 3.5H4.71733L3.25 3.89317V5.44582L4.25002 5.17782L4.25018 8.5H3V10H7V8.5H5.75024V3.5ZM10 4H21V6H10V4ZM10 11H21V13H10V11ZM10 18H21V20H10V18ZM2.875 15.625C2.875 14.4514 3.82639 13.5 5 13.5C6.17361 13.5 7.125 14.4514 7.125 15.625C7.125 16.1106 6.96183 16.5587 6.68747 16.9167L6.68271 16.9229L5.31587 18.5H7V20H3.00012L2.99959 18.8786L5.4717 16.035C5.5673 15.9252 5.625 15.7821 5.625 15.625C5.625 15.2798 5.34518 15 5 15C4.67378 15 4.40573 15.2501 4.37747 15.5688L4.3651 15.875H2.875V15.625Z"></path></svg></span><span class="overflow-hidden whitespace-nowrap" style="width:auto;opacity:1">文章目录</span><div class="bg-gradient-shoka-button absolute inset-0 -z-10 rounded-sm" style="will-change:transform"></div></div><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs opacity-50 grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM7 6H11V10H7V6ZM7 12H17V14H7V12ZM7 16H17V18H7V16ZM13 7H17V9H13V7Z"></path></svg></span></div></div><!--astro:end--></astro-island> <script>(()=>{var l=(n,t)=>{let i=async()=>{await(await n())()},e=typeof t.value=="object"?t.value:void 0,s={timeout:e==null?void 0:e.timeout};"requestIdleCallback"in window?window.requestIdleCallback(i,s):setTimeout(i,s.timeout||200)};(self.Astro||(self.Astro={})).idle=l;window.dispatchEvent(new Event("astro:idle"));})();</script><sider-content class="vertical-scrollbar scroll-gutter-stable block w-full flex-1 overflow-x-hidden overflow-y-auto md:pt-4 md:pl-3" data-type="post" data-default-type="directory" data-astro-cid-nxumbhks="true"> <div slot="info" class="sider-slot" data-slot-type="info" data-astro-cid-nxumbhks> <div class="flex flex-col items-center" data-home-info-container="home-info-fvormpc0u" data-astro-cid-dafxfumg> <div class="h-40 w-40 rounded-full" data-astro-cid-dafxfumg> <img class="shadow-card-darker hover:animate-shake h-full w-full rounded-full transition" src="/img/724d7fb480c8ac0db472ca5c7e36d239.jpg" alt="snow avatar" loading="eager" fetchpriority="high" data-astro-cid-dafxfumg> </div> <p class="mt-2" data-astro-cid-dafxfumg>snow</p> <p class="text-muted-foreground mt-3 text-center" data-astro-cid-dafxfumg>ACG / 养猫人 / 菜逼 / 前端什锦</p> <!-- TODO: use CSS squircle corner-shape replace the rounded-xl border-radius with a squircle corner-shape (https://www.squircle.style/) --><div class="mt-2 grid grid-cols-3 gap-2" data-astro-cid-xsmk7zsr> <div data-astro-cid-xsmk7zsr> <a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color: #191717" data-platform="github" href="https://github.com/XueHua-s" title="GitHub" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="GitHub" data-astro-cid-xsmk7zsr> <i class="fa-brands fa-github social-icon" aria-hidden="true" data-astro-cid-xsmk7zsr></i> <span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0" data-astro-cid-xsmk7zsr></span> </a> </div><div data-astro-cid-xsmk7zsr> <a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color: #4b9ae4" data-platform="x" href="https://x.com/xiaoxueljx?s=21" title="X (推特)" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="X (推特)" data-astro-cid-xsmk7zsr> <i class="fa-brands fa-x-twitter social-icon" aria-hidden="true" data-astro-cid-xsmk7zsr></i> <span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0" data-astro-cid-xsmk7zsr></span> </a> </div><div data-astro-cid-xsmk7zsr> <a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color: #55acd5" data-platform="email" href="mailto:xuehualjx@gmail.com" title="Email" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="Email" data-astro-cid-xsmk7zsr> <i class="fa-regular fa-envelope social-icon" aria-hidden="true" data-astro-cid-xsmk7zsr></i> <span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0" data-astro-cid-xsmk7zsr></span> </a> </div> </div>  <div class="text-muted-foreground mt-3 flex justify-center text-center text-sm/4 whitespace-nowrap select-none dark:text-white/80" data-astro-cid-dafxfumg> <a href="/blog" class="hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition" data-astro-cid-dafxfumg> <span class="text-lg/5 font-bold" data-astro-cid-dafxfumg>23</span>
文章
</a> <div class="bg-muted-foreground mx-3 w-px" data-astro-cid-dafxfumg></div> <a href="/blog/categories" aria-label="分类" class="hover:text-blue" data-astro-cid-dafxfumg> <p class="flex cursor-pointer flex-col gap-2 p-1 transition" data-astro-cid-dafxfumg> <span class="text-lg/5 font-bold" data-astro-cid-dafxfumg>5</span>
分类
</p> </a> <div class="bg-muted-foreground mx-3 w-px" data-astro-cid-dafxfumg></div> <a href="/blog/tags" class="hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition" data-astro-cid-dafxfumg> <span class="text-lg/5 font-bold" data-astro-cid-dafxfumg>38</span>
标签
</a> </div> <div class="mt-6 flex w-full flex-col items-center gap-2.5" data-astro-cid-dafxfumg> <a href="/blog" aria-label="首页" data-astro-cid-dafxfumg="true" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"> <i class="mr-1.5 fa-solid fa-house-chimney" aria-hidden="true" data-astro-cid-dafxfumg></i>首页 </a><div class="bg-foreground/10 flex w-40 flex-col rounded-xl opacity-75 transition-all duration-300 hover:opacity-100" data-collapsible data-astro-cid-dafxfumg> <button class="flex-center hover:bg-foreground/5 h-12 w-full cursor-pointer rounded-xl transition-colors" data-collapse-trigger="home-info-fvormpc0u-collapse-1" aria-expanded="false" aria-label="文章菜单" type="button" data-astro-cid-dafxfumg> <i class="mr-1.5 fa-solid fa-pen-nib" aria-hidden="true" data-astro-cid-dafxfumg></i> 文章 <i class="fa-solid fa-caret-down ml-2 text-base transition-transform duration-300" data-collapse-icon="home-info-fvormpc0u-collapse-1" aria-hidden="true" data-astro-cid-dafxfumg></i> </button> <div class="collapse-hidden" data-collapse-content="home-info-fvormpc0u-collapse-1" data-astro-cid-dafxfumg> <div class="flex flex-col items-center" data-astro-cid-dafxfumg> <a href="/blog/categories" aria-label="分类" data-astro-cid-dafxfumg="true" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"> <i class="mr-1.5 fa-solid fa-layer-group" aria-hidden="true" data-astro-cid-dafxfumg></i>分类 </a><a href="/blog/tags" aria-label="标签" data-astro-cid-dafxfumg="true" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"> <i class="mr-1.5 fa-solid fa-tags" aria-hidden="true" data-astro-cid-dafxfumg></i>标签 </a> </div> </div> </div><a href="/blog/friends" aria-label="友链" data-astro-cid-dafxfumg="true" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"> <i class="mr-1.5 fa-solid fa-link" aria-hidden="true" data-astro-cid-dafxfumg></i>友链 </a><a href="/blog/about" aria-label="关于" data-astro-cid-dafxfumg="true" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"> <i class="mr-1.5 fa-regular fa-circle-user" aria-hidden="true" data-astro-cid-dafxfumg></i>关于 </a> </div> </div>  <script type="module">let t=null;function n(){document.querySelectorAll("[data-home-info-container]").forEach(a=>{a.querySelectorAll("[data-collapse-trigger]").forEach(e=>{const o=e.getAttribute("data-collapse-trigger");if(!o||e.hasAttribute("data-initialized"))return;e.setAttribute("data-initialized","true");const s=a.querySelector(`[data-collapse-content="${o}"]`),r=e.querySelector(`[data-collapse-icon="${o}"]`);!s||!r||e.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),e.getAttribute("aria-expanded")==="true"?(s.classList.add("collapse-hidden"),r.style.transform="rotate(0deg)",e.setAttribute("aria-expanded","false")):(s.classList.remove("collapse-hidden"),r.style.transform="rotate(180deg)",e.setAttribute("aria-expanded","true"))})})})}function c(){t&&(t.disconnect(),t=null)}function d(){c(),t=new MutationObserver(i=>{i.forEach(a=>{a.addedNodes.length&&setTimeout(n,100)})}),t.observe(document.body,{childList:!0,subtree:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{n(),d()}):(n(),d());document.addEventListener("astro:page-load",()=>{n(),d()});document.addEventListener("astro:before-swap",c);</script> </div> <div slot="directory" class="sider-slot" data-slot-type="directory" data-astro-cid-nxumbhks> <astro-island uid="iWeBV" prefix="r11" component-url="/_astro/index.177fiMIz.js" component-export="TableOfContents" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;enableNumbering&quot;:[0,true],&quot;sourceHeadings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;核心原则&quot;],&quot;text&quot;:[0,&quot;核心原则&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;典型案例&quot;],&quot;text&quot;:[0,&quot;典型案例&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-切片引用&quot;],&quot;text&quot;:[0,&quot;1. 切片引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-结构体字段引用&quot;],&quot;text&quot;:[0,&quot;2. 结构体字段引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-数组元素引用&quot;],&quot;text&quot;:[0,&quot;3. 数组元素引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;4-函数参数的局部引用&quot;],&quot;text&quot;:[0,&quot;4. 函数参数的局部引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;5-嵌套引用&quot;],&quot;text&quot;:[0,&quot;5. 嵌套引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;为什么可以更短&quot;],&quot;text&quot;:[0,&quot;为什么可以更短？&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;为什么不能更长&quot;],&quot;text&quot;:[0,&quot;为什么不能更长？&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;实际应用场景&quot;],&quot;text&quot;:[0,&quot;实际应用场景&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-1临时处理数据片段&quot;],&quot;text&quot;:[0,&quot;场景 1：临时处理数据片段&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-2链式引用&quot;],&quot;text&quot;:[0,&quot;场景 2：链式引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-3迭代器中的引用&quot;],&quot;text&quot;:[0,&quot;场景 3：迭代器中的引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;常见陷阱&quot;],&quot;text&quot;:[0,&quot;常见陷阱&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;陷阱-1试图返回局部变量的引用&quot;],&quot;text&quot;:[0,&quot;陷阱 1：试图返回局部变量的引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;陷阱-2在结构体中存储临时引用&quot;],&quot;text&quot;:[0,&quot;陷阱 2：在结构体中存储临时引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;总结&quot;],&quot;text&quot;:[0,&quot;总结&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;核心要点&quot;],&quot;text&quot;:[0,&quot;核心要点&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;记忆口诀&quot;],&quot;text&quot;:[0,&quot;记忆口诀&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;延伸思考&quot;],&quot;text&quot;:[0,&quot;延伸思考&quot;]}]]],&quot;data-astro-cid-nxumbhks&quot;:[0,true]}" ssr client="idle" opts="{&quot;name&quot;:&quot;TableOfContents&quot;,&quot;value&quot;:true}" await-children><nav class="toc-container max-h-[90dvh] overflow-auto " aria-label="文章目录"><div class="space-y-1 pr-2"><div class="heading-tree-item relative"><a href="#%E5%89%8D%E8%A8%80" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="2" aria-label="前言"><span class="heading-text block flex-1 truncate leading-relaxed">前言</span></a></div><div class="heading-tree-item relative"><a href="#%E6%A0%B8%E5%BF%83%E5%8E%9F%E5%88%99" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="2" aria-label="核心原则"><span class="heading-text block flex-1 truncate leading-relaxed">核心原则</span></a></div><div class="heading-tree-item relative"><a href="#%E5%85%B8%E5%9E%8B%E6%A1%88%E4%BE%8B" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.5rem" data-level="2" aria-label="典型案例"><span class="heading-text block flex-1 truncate leading-relaxed">典型案例</span></a></div><div class="heading-tree-item relative"><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%8F%AF%E4%BB%A5%E6%9B%B4%E7%9F%AD" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="2" aria-label="为什么可以更短？"><span class="heading-text block flex-1 truncate leading-relaxed">为什么可以更短？</span></a></div><div class="heading-tree-item relative"><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E6%9B%B4%E9%95%BF" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="2" aria-label="为什么不能更长？"><span class="heading-text block flex-1 truncate leading-relaxed">为什么不能更长？</span></a></div><div class="heading-tree-item relative"><a href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.5rem" data-level="2" aria-label="实际应用场景"><span class="heading-text block flex-1 truncate leading-relaxed">实际应用场景</span></a></div><div class="heading-tree-item relative"><a href="#%E5%B8%B8%E8%A7%81%E9%99%B7%E9%98%B1" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.5rem" data-level="2" aria-label="常见陷阱"><span class="heading-text block flex-1 truncate leading-relaxed">常见陷阱</span></a></div><div class="heading-tree-item relative"><a href="#%E6%80%BB%E7%BB%93" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.5rem" data-level="2" aria-label="总结"><span class="heading-text block flex-1 truncate leading-relaxed">总结</span></a></div></div></nav><!--astro:end--></astro-island> </div> <div slot="series" class="sider-slot" data-slot-type="series" data-astro-cid-nxumbhks> <astro-island uid="Z1vm6mB" prefix="r12" component-url="/_astro/SeriesPostList.pzWr_qfk.js" component-export="SeriesPostList" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;posts&quot;:[1,[[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;rust算术运算的panic陷阱-从取模零说起&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Rust 算术运算的 Panic 陷阱：从取模零说起&quot;],&quot;description&quot;:[0,&quot;在刷 Rust 算法题时发现了一个独特现象：对零取模会直接导致程序 panic！这与其他语言的行为截然不同。本文深入探讨 Rust 中会导致 panic 的算术运算场景，包括除零、整数溢出、INT_MIN/-1 等特殊情况，以及 Rust 提供的 checked_、wrapping_、saturating_ 等安全替代方案。理解这些行为对于编写健壮的 Rust 程序至关重要。&quot;],&quot;date&quot;:[3,&quot;2025-12-02T10:00:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;算法&quot;],[0,&quot;安全&quot;],[0,&quot;Panic&quot;],[0,&quot;算术运算&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;]}],&quot;body&quot;:[0,&quot;## 前言\n\n今天在刷 Rust 算法题时，遇到了一个让我印象深刻的情况：**当我尝试对 0 取模时，程序直接 panic 了！**\n\n```rust\nfn main() {\n    let x = 10;\n    let y = 0;\n    let result = x % y;  // 💥 thread &#39;main&#39; panicked at &#39;attempt to calculate the remainder with a divisor of zero&#39;\n}\n```\n\n这个行为在其他语言中并不常见。比如在 JavaScript 中，`10 % 0` 会返回 `NaN`；在 Python 中会抛出 `ZeroDivisionError` 异常（可以被捕获）。而 **Rust 选择直接 panic，整个程序崩溃，无法通过普通的错误处理机制捕获**。\n\n这引发了我的好奇：Rust 中还有哪些类似的\&quot;地雷\&quot;？让我们一探究竟。\n\n## Rust 中会导致 Panic 的算术运算\n\n### 1. 除法和取模运算的零除错误\n\n在 Rust 中，**整数的除法和取模运算遇到零除数时会无条件 panic**：\n\n```rust\nfn main() {\n    let a = 10;\n    let b = 0;\n\n    // 💥 除法遇到零：panic!\n    // let div = a / b;\n\n    // 💥 取模遇到零：panic!\n    // let rem = a % b;\n\n    println!(\&quot;这行代码永远不会执行\&quot;);\n}\n```\n\n**为什么会这样？**\n\nRust 的设计哲学是：**宁可 panic 也不产生未定义行为（Undefined Behavior, UB）**。在很多底层语言（如 C/C++）中，除以零会导致 UB，这可能造成：\n- 程序段错误（Segmentation Fault）\n- 返回垃圾值\n- 安全漏洞\n\nRust 通过显式 panic 来避免这些不可预测的行为，让错误在第一时间暴露出来。\n\n**浮点数例外**\n\n有趣的是，**浮点数的除零操作不会 panic**，而是遵循 IEEE 754 标准：\n\n```rust\nfn main() {\n    let x = 10.0;\n    let y = 0.0;\n\n    println!(\&quot;{}\&quot;, x / y);      // ✅ inf (正无穷)\n    println!(\&quot;{}\&quot;, -x / y);     // ✅ -inf (负无穷)\n    println!(\&quot;{}\&quot;, y / y);      // ✅ NaN (Not a Number)\n\n    // 浮点数取模也不会 panic，但会返回 NaN\n    println!(\&quot;{}\&quot;, x % y);      // ✅ NaN\n}\n```\n\n### 2. 整数溢出的特殊边界情况\n\n还有一个更隐蔽的陷阱：**`INT_MIN / -1` 和 `INT_MIN % -1` 也会 panic**！\n\n```rust\nfn main() {\n    let min = i8::MIN;  // -128\n    let divisor = -1;\n\n    // 💥 这会 panic！\n    // let result = min / divisor;\n\n    // 💥 这也会 panic！\n    // let remainder = min % divisor;\n}\n```\n\n**为什么？**\n\n对于 8 位有符号整数 `i8`：\n- 最小值：`i8::MIN = -128`\n- 最大值：`i8::MAX = 127`\n\n当我们计算 `-128 / -1` 时，数学结果应该是 `128`，但这**超出了 `i8` 的表示范围**（最大只能到 127），导致溢出。Rust 选择 panic 而不是返回错误的结果。\n\n```rust\nfn demonstrate_overflow() {\n    // 对于不同的整数类型，都存在这个问题\n    println!(\&quot;i8::MIN  / -1 会 panic: {}\&quot;, i8::MIN);   // -128 / -1 = 128 (溢出!)\n    println!(\&quot;i16::MIN / -1 会 panic: {}\&quot;, i16::MIN);  // -32768 / -1 = 32768 (溢出!)\n    println!(\&quot;i32::MIN / -1 会 panic: {}\&quot;, i32::MIN);  // -2147483648 / -1 = 2147483648 (溢出!)\n    println!(\&quot;i64::MIN / -1 会 panic: {}\&quot;, i64::MIN);  // 同理\n}\n```\n\n### 3. Debug 模式下的整数溢出\n\nRust 在 **debug 模式和 release 模式下对整数溢出的处理不同**：\n\n```rust\nfn main() {\n    let max = u8::MAX;  // 255\n\n    // Debug 模式：💥 panic!\n    // Release 模式：✅ 环绕到 0 (wrapping)\n    let result = max + 1;\n\n    println!(\&quot;Result: {}\&quot;, result);\n}\n```\n\n**行为差异：**\n\n| 模式 | 溢出行为 | 原因 |\n|------|----------|------|\n| **Debug** (`cargo build`) | Panic | 帮助开发者尽早发现 bug |\n| **Release** (`cargo build --release`) | 二进制补码环绕 | 性能优化，避免运行时检查开销 |\n\n在 release 模式下：\n```rust\nu8::MAX + 1      // =&gt; 0   (255 + 1 环绕为 0)\nu8::MIN - 1      // =&gt; 255 (0 - 1 环绕为 255)\ni8::MAX + 1      // =&gt; -128 (127 + 1 环绕为 -128)\n```\n\n这意味着：**同样的代码在不同编译模式下可能有完全不同的行为！**\n\n## Rust 的解决方案：显式的溢出处理\n\n为了让开发者能够精确控制溢出行为，Rust 提供了多种方法变体：\n\n### 1. `checked_*` 系列：安全检查，返回 Option\n\n```rust\nfn safe_division(a: i32, b: i32) -&gt; Option&lt;i32&gt; {\n    a.checked_div(b)\n}\n\nfn main() {\n    println!(\&quot;{:?}\&quot;, 10.checked_div(2));   // Some(5)\n    println!(\&quot;{:?}\&quot;, 10.checked_div(0));   // None - 零除返回 None 而不是 panic\n    println!(\&quot;{:?}\&quot;, i32::MIN.checked_div(-1)); // None - 溢出返回 None\n\n    // 其他 checked 方法\n    println!(\&quot;{:?}\&quot;, 255u8.checked_add(1));     // None\n    println!(\&quot;{:?}\&quot;, 0u8.checked_sub(1));       // None\n    println!(\&quot;{:?}\&quot;, 128i8.checked_mul(2));     // None\n    println!(\&quot;{:?}\&quot;, 10.checked_rem(0));        // None - 取模零也返回 None\n}\n```\n\n**适用场景：**\n- 用户输入处理\n- 外部数据验证\n- 需要优雅处理错误的场景\n\n### 2. `wrapping_*` 系列：显式环绕行为\n\n```rust\nfn main() {\n    // 无论 debug 还是 release 模式，都保证环绕行为\n    println!(\&quot;{}\&quot;, 255u8.wrapping_add(1));      // 0\n    println!(\&quot;{}\&quot;, 0u8.wrapping_sub(1));        // 255\n    println!(\&quot;{}\&quot;, 200u8.wrapping_mul(2));      // 144 (400 % 256)\n\n    // 环绕除法：零除仍然会 panic！\n    // println!(\&quot;{}\&quot;, 10.wrapping_div(0));  // 💥 仍然 panic\n\n    // 但 INT_MIN / -1 会环绕而不是 panic\n    println!(\&quot;{}\&quot;, i8::MIN.wrapping_div(-1));   // -128 (环绕到自身)\n}\n```\n\n**适用场景：**\n- 哈希计算\n- 密码学算法\n- 需要明确的模运算语义\n\n### 3. `saturating_*` 系列：饱和到边界值\n\n```rust\nfn main() {\n    // 溢出时返回类型的最大/最小值\n    println!(\&quot;{}\&quot;, 255u8.saturating_add(1));    // 255 (不超过最大值)\n    println!(\&quot;{}\&quot;, 0u8.saturating_sub(1));      // 0   (不低于最小值)\n    println!(\&quot;{}\&quot;, 200u8.saturating_mul(2));    // 255 (饱和到最大值)\n\n    // 有符号整数\n    println!(\&quot;{}\&quot;, 127i8.saturating_add(1));    // 127\n    println!(\&quot;{}\&quot;, (-128i8).saturating_sub(1)); // -128\n\n    // 除法仍然对零除 panic\n    // println!(\&quot;{}\&quot;, 10.saturating_div(0));  // 💥 panic\n}\n```\n\n**适用场景：**\n- 音频/视频处理（音量、亮度限制）\n- 游戏开发（生命值、伤害计算）\n- UI 组件（滚动位置、进度条）\n\n### 4. `overflowing_*` 系列：返回结果和溢出标志\n\n```rust\nfn main() {\n    let (result, overflowed) = 255u8.overflowing_add(1);\n    println!(\&quot;Result: {}, Overflowed: {}\&quot;, result, overflowed);\n    // Result: 0, Overflowed: true\n\n    let (result, overflowed) = 100u8.overflowing_add(50);\n    println!(\&quot;Result: {}, Overflowed: {}\&quot;, result, overflowed);\n    // Result: 150, Overflowed: false\n\n    // 可以用来实现自定义的溢出处理逻辑\n    let (div, overflow) = i8::MIN.overflowing_div(-1);\n    println!(\&quot;Division: {}, Overflow: {}\&quot;, div, overflow);\n    // Division: -128, Overflow: true\n}\n```\n\n**适用场景：**\n- 需要记录溢出事件\n- 实现自定义的错误报告\n- 性能敏感但需要溢出信息的代码\n\n### 5. `strict_*` 系列：总是 Panic（Rust 1.80+）\n\n```rust\nfn main() {\n    // 无论 debug 还是 release，溢出总是 panic\n    // let result = 255u8.strict_add(1);  // 💥 panic in both debug and release\n\n    // 这对于需要严格保证数学正确性的场景很有用\n}\n```\n\n**适用场景：**\n- 金融计算\n- 科学计算\n- 任何不能容忍静默溢出的场景\n\n## 完整的除零安全处理示例\n\n结合上面的知识，我们可以写一个安全的计算器函数：\n\n```rust\n#[derive(Debug, PartialEq)]\nenum CalcError {\n    DivisionByZero,\n    Overflow,\n}\n\nfn safe_calculator(a: i32, b: i32, op: char) -&gt; Result&lt;i32, CalcError&gt; {\n    match op {\n        &#39;+&#39; =&gt; a.checked_add(b).ok_or(CalcError::Overflow),\n        &#39;-&#39; =&gt; a.checked_sub(b).ok_or(CalcError::Overflow),\n        &#39;*&#39; =&gt; a.checked_mul(b).ok_or(CalcError::Overflow),\n        &#39;/&#39; =&gt; {\n            if b == 0 {\n                Err(CalcError::DivisionByZero)\n            } else {\n                a.checked_div(b).ok_or(CalcError::Overflow)\n            }\n        }\n        &#39;%&#39; =&gt; {\n            if b == 0 {\n                Err(CalcError::DivisionByZero)\n            } else {\n                a.checked_rem(b).ok_or(CalcError::Overflow)\n            }\n        }\n        _ =&gt; panic!(\&quot;Unsupported operation\&quot;),\n    }\n}\n\nfn main() {\n    println!(\&quot;{:?}\&quot;, safe_calculator(10, 2, &#39;/&#39;));   // Ok(5)\n    println!(\&quot;{:?}\&quot;, safe_calculator(10, 0, &#39;/&#39;));   // Err(DivisionByZero)\n    println!(\&quot;{:?}\&quot;, safe_calculator(10, 0, &#39;%&#39;));   // Err(DivisionByZero)\n    println!(\&quot;{:?}\&quot;, safe_calculator(i32::MAX, 1, &#39;+&#39;)); // Err(Overflow)\n    println!(\&quot;{:?}\&quot;, safe_calculator(i32::MIN, -1, &#39;/&#39;)); // Err(Overflow)\n}\n```\n\n## Rust vs 其他语言\n\n让我们对比一下不同语言对除零的处理：\n\n| 语言 | `10 / 0` 行为 | `10 % 0` 行为 | 可捕获？ |\n|------|---------------|---------------|----------|\n| **Rust** | Panic（程序崩溃） | Panic（程序崩溃） | ❌ 不可用 try-catch 捕获 |\n| **Python** | 抛出 `ZeroDivisionError` | 抛出 `ZeroDivisionError` | ✅ 可用 try-except 捕获 |\n| **JavaScript** | `Infinity` | `NaN` | ✅ 不抛出异常，返回特殊值 |\n| **Java** | 抛出 `ArithmeticException` | 抛出 `ArithmeticException` | ✅ 可用 try-catch 捕获 |\n| **C/C++** | 未定义行为（UB） | 未定义行为（UB） | ❌ 无标准异常机制 |\n| **Go** | Panic | Panic | ⚠️ 可用 recover 捕获（不推荐） |\n\n**Rust 的设计权衡：**\n\n1. **不使用异常机制**：Rust 没有 try-catch 异常系统，这避免了隐藏的控制流和性能开销\n2. **强制显式处理**：通过 `checked_*` 等方法，强制开发者在可能出错的地方显式处理\n3. **Panic 是最后手段**：Panic 用于\&quot;不可恢复的错误\&quot;，而零除被认为是编程错误而非业务逻辑错误\n\n## 实战建议\n\n### 1. 算法题中的处理\n\n在刷算法题时，可以这样处理：\n\n```rust\n// ❌ 危险：可能 panic\nfn solve_naive(n: i32, m: i32) -&gt; i32 {\n    (n * n) % m  // 如果 m 为 0，直接崩溃\n}\n\n// ✅ 安全：添加前置检查\nfn solve_safe(n: i32, m: i32) -&gt; Option&lt;i32&gt; {\n    if m == 0 {\n        return None;\n    }\n    Some((n * n) % m)\n}\n\n// ✅ 更好：使用 checked 方法\nfn solve_better(n: i32, m: i32) -&gt; Option&lt;i32&gt; {\n    n.checked_mul(n)?.checked_rem(m)\n}\n```\n\n### 2. 生产代码的建议\n\n```rust\n// 对于用户输入，总是使用 checked_* 方法\nfn process_user_input(dividend: i32, divisor: i32) -&gt; Result&lt;i32, String&gt; {\n    dividend\n        .checked_div(divisor)\n        .ok_or_else(|| {\n            if divisor == 0 {\n                \&quot;除数不能为零\&quot;.to_string()\n            } else {\n                \&quot;计算溢出\&quot;.to_string()\n            }\n        })\n}\n\n// 对于性能敏感且确定不会溢出的代码，可以使用普通运算符\nfn fast_index_calculation(base: usize, offset: usize, size: usize) -&gt; usize {\n    // 假设已经在外层保证了不会溢出\n    (base + offset) % size\n}\n\n// 对于需要环绕语义的场景，明确使用 wrapping_*\nfn hash_combine(hash1: u64, hash2: u64) -&gt; u64 {\n    hash1.wrapping_add(hash2).wrapping_mul(0x9e3779b97f4a7c15)\n}\n```\n\n### 3. 测试建议\n\n```rust\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    #[should_panic(expected = \&quot;divide by zero\&quot;)]\n    fn test_division_by_zero_panics() {\n        let _ = 10 / 0;\n    }\n\n    #[test]\n    #[should_panic(expected = \&quot;remainder\&quot;)]\n    fn test_modulo_by_zero_panics() {\n        let _ = 10 % 0;\n    }\n\n    #[test]\n    fn test_safe_division() {\n        assert_eq!(10.checked_div(2), Some(5));\n        assert_eq!(10.checked_div(0), None);\n        assert_eq!(i32::MIN.checked_div(-1), None);\n    }\n}\n```\n\n## 总结\n\n### 关键要点\n\n1. **Rust 中会导致 panic 的算术运算：**\n   - `a / 0` 和 `a % 0`（整数）\n   - `INT_MIN / -1` 和 `INT_MIN % -1`\n   - Debug 模式下的整数溢出\n\n2. **浮点数例外：**\n   - `f32/f64` 的除零不会 panic，返回 `Infinity` 或 `NaN`\n\n3. **Debug vs Release 的差异：**\n   - Debug：溢出 panic，帮助调试\n   - Release：溢出环绕，优化性能\n   - 使用 `checked_*` 等方法可以统一行为\n\n4. **Rust 的解决方案：**\n   - `checked_*`：安全检查，返回 `Option&lt;T&gt;`\n   - `wrapping_*`：显式环绕\n   - `saturating_*`：饱和到边界\n   - `overflowing_*`：返回结果和溢出标志\n   - `strict_*`：总是 panic（Rust 1.80+）\n\n5. **设计哲学：**\n   - 避免未定义行为\n   - 强制显式处理\n   - Panic 用于不可恢复的编程错误\n\n### 实践建议\n\n- ✅ **用户输入和外部数据**：总是使用 `checked_*` 方法\n- ✅ **算法题**：添加边界检查或使用 `checked_*`\n- ✅ **性能关键路径**：如果确定安全，可以用普通运算符，但要有充分的注释说明\n- ✅ **需要环绕语义**：明确使用 `wrapping_*`\n- ✅ **测试**：为边界情况编写测试，包括 panic 测试\n\n### 延伸阅读\n\n- [Rust RFC 560 - Integer Overflow](https://rust-lang.github.io/rfcs/0560-integer-overflow.html)\n- [Myths and Legends about Integer Overflow in Rust](https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/)\n- [Rust Documentation - Div trait](https://doc.rust-lang.org/std/ops/trait.Div.html)\n- [Behavior not considered unsafe - Rust Reference](https://doc.rust-lang.org/reference/behavior-not-considered-unsafe.html)\n- [Exploring Rust&#39;s Overflow Behavior - Sling Academy](https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/)\n\n---\n\n**最后提醒：** 这些行为不是 bug，而是 Rust 为了安全性做出的有意设计。理解这些特性，才能写出既安全又高效的 Rust 代码。下次刷算法题时，记得留意除法和取模操作，不要让你的解答因为一个 `% 0` 而崩溃！\n\n写到这里，我想起了前一个月的 cloudflare的unwarp 造成的panic!。真的很好笑。\n\n一定要注意rust一切可能引起panic!的可能性，才不会像cloudflare的unwarp方法一样，搞出的几十亿美金的全球网站崩溃漏洞。\n\nSources:\n- [Rust RFC 560 - Integer Overflow](https://rust-lang.github.io/rfcs/0560-integer-overflow.html)\n- [Myths and Legends about Integer Overflow in Rust](https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/)\n- [What happens in Rust programming language when an integer arithmetic operation overflows? - Stack Overflow](https://stackoverflow.com/questions/68807024/what-happens-in-rust-programming-language-when-an-integer-arithmetic-operation-o)\n- [Exploring Rust&#39;s Overflow Behavior: Wrapping, Saturating, and Panicking - Sling Academy](https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/)\n- [Div in std::ops - Rust](https://doc.rust-lang.org/std/ops/trait.Div.html)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Rust算术运算的Panic陷阱-从取模零说起.md&quot;],&quot;digest&quot;:[0,&quot;a24451f5fe38d184&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h2 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;今天在刷 Rust 算法题时，遇到了一个让我印象深刻的情况：&lt;strong&gt;当我尝试对 0 取模时，程序直接 panic 了！&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; result &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y;  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 💥 thread &#39;main&#39; panicked at &#39;attempt to calculate the remainder with a divisor of zero&#39;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这个行为在其他语言中并不常见。比如在 JavaScript 中，&lt;code&gt;10 % 0&lt;/code&gt; 会返回 &lt;code&gt;NaN&lt;/code&gt;；在 Python 中会抛出 &lt;code&gt;ZeroDivisionError&lt;/code&gt; 异常（可以被捕获）。而 &lt;strong&gt;Rust 选择直接 panic，整个程序崩溃，无法通过普通的错误处理机制捕获&lt;/strong&gt;。&lt;/p&gt;\n&lt;p&gt;这引发了我的好奇：Rust 中还有哪些类似的”地雷”？让我们一探究竟。&lt;/p&gt;\n&lt;h2 id=\&quot;rust-中会导致-panic-的算术运算\&quot;&gt;Rust 中会导致 Panic 的算术运算&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#rust-中会导致-panic-的算术运算\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;1-除法和取模运算的零除错误\&quot;&gt;1. 除法和取模运算的零除错误&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-除法和取模运算的零除错误\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在 Rust 中，&lt;strong&gt;整数的除法和取模运算遇到零除数时会无条件 panic&lt;/strong&gt;：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; b &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 除法遇到零：panic!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let div = a / b;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 取模遇到零：panic!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let rem = a % b;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;这行代码永远不会执行\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;为什么会这样？&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Rust 的设计哲学是：&lt;strong&gt;宁可 panic 也不产生未定义行为（Undefined Behavior, UB）&lt;/strong&gt;。在很多底层语言（如 C/C++）中，除以零会导致 UB，这可能造成：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;程序段错误（Segmentation Fault）&lt;/li&gt;\n&lt;li&gt;返回垃圾值&lt;/li&gt;\n&lt;li&gt;安全漏洞&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Rust 通过显式 panic 来避免这些不可预测的行为，让错误在第一时间暴露出来。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;浮点数例外&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;有趣的是，&lt;strong&gt;浮点数的除零操作不会 panic&lt;/strong&gt;，而是遵循 IEEE 754 标准：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ inf (正无穷)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ -inf (负无穷)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, y &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ NaN (Not a Number)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 浮点数取模也不会 panic，但会返回 NaN&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ NaN&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;2-整数溢出的特殊边界情况\&quot;&gt;2. 整数溢出的特殊边界情况&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-整数溢出的特殊边界情况\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;还有一个更隐蔽的陷阱：&lt;strong&gt;&lt;code&gt;INT_MIN / -1&lt;/code&gt; 和 &lt;code&gt;INT_MIN % -1&lt;/code&gt; 也会 panic&lt;/strong&gt;！&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; min &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; divisor &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; -&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 这会 panic！&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let result = min / divisor;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 这也会 panic！&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let remainder = min % divisor;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;为什么？&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;对于 8 位有符号整数 &lt;code&gt;i8&lt;/code&gt;：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;最小值：&lt;code&gt;i8::MIN = -128&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;最大值：&lt;code&gt;i8::MAX = 127&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;当我们计算 &lt;code&gt;-128 / -1&lt;/code&gt; 时，数学结果应该是 &lt;code&gt;128&lt;/code&gt;，但这&lt;strong&gt;超出了 &lt;code&gt;i8&lt;/code&gt; 的表示范围&lt;/strong&gt;（最大只能到 127），导致溢出。Rust 选择 panic 而不是返回错误的结果。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; demonstrate_overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 对于不同的整数类型，都存在这个问题&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i8::MIN  / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128 / -1 = 128 (溢出!)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i16::MIN / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i16&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -32768 / -1 = 32768 (溢出!)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i32::MIN / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -2147483648 / -1 = 2147483648 (溢出!)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i64::MIN / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i64&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 同理&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;3-debug-模式下的整数溢出\&quot;&gt;3. Debug 模式下的整数溢出&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-debug-模式下的整数溢出\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;Rust 在 &lt;strong&gt;debug 模式和 release 模式下对整数溢出的处理不同&lt;/strong&gt;：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; max &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Debug 模式：💥 panic!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Release 模式：✅ 环绕到 0 (wrapping)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; result &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; max &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Result: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, result);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;行为差异：&lt;/strong&gt;&lt;/p&gt;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;模式&lt;/th&gt;&lt;th&gt;溢出行为&lt;/th&gt;&lt;th&gt;原因&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Debug&lt;/strong&gt; (&lt;code&gt;cargo build&lt;/code&gt;)&lt;/td&gt;&lt;td&gt;Panic&lt;/td&gt;&lt;td&gt;帮助开发者尽早发现 bug&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Release&lt;/strong&gt; (&lt;code&gt;cargo build --release&lt;/code&gt;)&lt;/td&gt;&lt;td&gt;二进制补码环绕&lt;/td&gt;&lt;td&gt;性能优化，避免运行时检查开销&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;\n&lt;p&gt;在 release 模式下：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; +&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;      // =&gt; 0   (255 + 1 环绕为 0)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; -&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;      // =&gt; 255 (0 - 1 环绕为 255)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; +&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;      // =&gt; -128 (127 + 1 环绕为 -128)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这意味着：&lt;strong&gt;同样的代码在不同编译模式下可能有完全不同的行为！&lt;/strong&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;rust-的解决方案显式的溢出处理\&quot;&gt;Rust 的解决方案：显式的溢出处理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#rust-的解决方案显式的溢出处理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;为了让开发者能够精确控制溢出行为，Rust 提供了多种方法变体：&lt;/p&gt;\n&lt;h3 id=\&quot;1-checked_-系列安全检查返回-option\&quot;&gt;1. &lt;code&gt;checked_*&lt;/code&gt; 系列：安全检查，返回 Option&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-checked_-系列安全检查返回-option\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; safe_division&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, b&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Some(5)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None - 零除返回 None 而不是 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None - 溢出返回 None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 其他 checked 方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));       &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;128&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_rem&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));        &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None - 取模零也返回 None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;用户输入处理&lt;/li&gt;\n&lt;li&gt;外部数据验证&lt;/li&gt;\n&lt;li&gt;需要优雅处理错误的场景&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;2-wrapping_-系列显式环绕行为\&quot;&gt;2. &lt;code&gt;wrapping_*&lt;/code&gt; 系列：显式环绕行为&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-wrapping_-系列显式环绕行为\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 无论 debug 还是 release 模式，都保证环绕行为&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 0&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));        &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;200&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 144 (400 % 256)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 环绕除法：零除仍然会 panic！&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // println!(\&quot;{}\&quot;, 10.wrapping_div(0));  // 💥 仍然 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 但 INT_MIN / -1 会环绕而不是 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128 (环绕到自身)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;哈希计算&lt;/li&gt;\n&lt;li&gt;密码学算法&lt;/li&gt;\n&lt;li&gt;需要明确的模运算语义&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;3-saturating_-系列饱和到边界值\&quot;&gt;3. &lt;code&gt;saturating_*&lt;/code&gt; 系列：饱和到边界值&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-saturating_-系列饱和到边界值\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 溢出时返回类型的最大/最小值&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));    &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255 (不超过最大值)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 0   (不低于最小值)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;200&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));    &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255 (饱和到最大值)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 有符号整数&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;127&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));    &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 127&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, (&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;128&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 除法仍然对零除 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // println!(\&quot;{}\&quot;, 10.saturating_div(0));  // 💥 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;音频/视频处理（音量、亮度限制）&lt;/li&gt;\n&lt;li&gt;游戏开发（生命值、伤害计算）&lt;/li&gt;\n&lt;li&gt;UI 组件（滚动位置、进度条）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;4-overflowing_-系列返回结果和溢出标志\&quot;&gt;4. &lt;code&gt;overflowing_*&lt;/code&gt; 系列：返回结果和溢出标志&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#4-overflowing_-系列返回结果和溢出标志\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (result, overflowed) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;overflowing_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Result: {}, Overflowed: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, result, overflowed);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Result: 0, Overflowed: true&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (result, overflowed) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 100&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;overflowing_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;50&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Result: {}, Overflowed: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, result, overflowed);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Result: 150, Overflowed: false&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 可以用来实现自定义的溢出处理逻辑&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (div, overflow) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;overflowing_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Division: {}, Overflow: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, div, overflow);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Division: -128, Overflow: true&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;需要记录溢出事件&lt;/li&gt;\n&lt;li&gt;实现自定义的错误报告&lt;/li&gt;\n&lt;li&gt;性能敏感但需要溢出信息的代码&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;5-strict_-系列总是-panicrust-180\&quot;&gt;5. &lt;code&gt;strict_*&lt;/code&gt; 系列：总是 Panic（Rust 1.80+）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#5-strict_-系列总是-panicrust-180\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 无论 debug 还是 release，溢出总是 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let result = 255u8.strict_add(1);  // 💥 panic in both debug and release&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 这对于需要严格保证数学正确性的场景很有用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;金融计算&lt;/li&gt;\n&lt;li&gt;科学计算&lt;/li&gt;\n&lt;li&gt;任何不能容忍静默溢出的场景&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;完整的除零安全处理示例\&quot;&gt;完整的除零安全处理示例&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#完整的除零安全处理示例\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;结合上面的知识，我们可以写一个安全的计算器函数：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;#[derive(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Debug&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;PartialEq&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;enum&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; CalcError&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    DivisionByZero&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, b&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, op&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; char&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Result&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    match&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; op {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;+&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;-&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;*&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; b &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;                Err&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;DivisionByZero&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;                a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;%&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; b &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;                Err&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;DivisionByZero&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;                a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_rem&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        _ &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; panic!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Unsupported operation\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Ok(5)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(DivisionByZero)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;%&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(DivisionByZero)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;+&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(Overflow)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(Overflow)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;rust-vs-其他语言\&quot;&gt;Rust vs 其他语言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#rust-vs-其他语言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;让我们对比一下不同语言对除零的处理：&lt;/p&gt;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;语言&lt;/th&gt;&lt;th&gt;&lt;code&gt;10 / 0&lt;/code&gt; 行为&lt;/th&gt;&lt;th&gt;&lt;code&gt;10 % 0&lt;/code&gt; 行为&lt;/th&gt;&lt;th&gt;可捕获？&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Rust&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;Panic（程序崩溃）&lt;/td&gt;&lt;td&gt;Panic（程序崩溃）&lt;/td&gt;&lt;td&gt;❌ 不可用 try-catch 捕获&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Python&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ZeroDivisionError&lt;/code&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ZeroDivisionError&lt;/code&gt;&lt;/td&gt;&lt;td&gt;✅ 可用 try-except 捕获&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;JavaScript&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;Infinity&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;NaN&lt;/code&gt;&lt;/td&gt;&lt;td&gt;✅ 不抛出异常，返回特殊值&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Java&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ArithmeticException&lt;/code&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ArithmeticException&lt;/code&gt;&lt;/td&gt;&lt;td&gt;✅ 可用 try-catch 捕获&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;C/C++&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;未定义行为（UB）&lt;/td&gt;&lt;td&gt;未定义行为（UB）&lt;/td&gt;&lt;td&gt;❌ 无标准异常机制&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Go&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;Panic&lt;/td&gt;&lt;td&gt;Panic&lt;/td&gt;&lt;td&gt;⚠️ 可用 recover 捕获（不推荐）&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;\n&lt;p&gt;&lt;strong&gt;Rust 的设计权衡：&lt;/strong&gt;&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;不使用异常机制&lt;/strong&gt;：Rust 没有 try-catch 异常系统，这避免了隐藏的控制流和性能开销&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;强制显式处理&lt;/strong&gt;：通过 &lt;code&gt;checked_*&lt;/code&gt; 等方法，强制开发者在可能出错的地方显式处理&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Panic 是最后手段&lt;/strong&gt;：Panic 用于”不可恢复的错误”，而零除被认为是编程错误而非业务逻辑错误&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&quot;实战建议\&quot;&gt;实战建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实战建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;1-算法题中的处理\&quot;&gt;1. 算法题中的处理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-算法题中的处理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在刷算法题时，可以这样处理：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ❌ 危险：可能 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; solve_naive&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, m&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    (n &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; n) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; m  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 如果 m 为 0，直接崩溃&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 安全：添加前置检查&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; solve_safe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, m&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; m &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; None&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    Some&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;((n &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; n) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; m)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 更好：使用 checked 方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; solve_better&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, m&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;?.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_rem&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(m)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;2-生产代码的建议\&quot;&gt;2. 生产代码的建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-生产代码的建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 对于用户输入，总是使用 checked_* 方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process_user_input&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(dividend&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, divisor&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Result&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    dividend&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(divisor)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or_else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;||&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; divisor &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;                \&quot;除数不能为零\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;                \&quot;计算溢出\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        })&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 对于性能敏感且确定不会溢出的代码，可以使用普通运算符&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; fast_index_calculation&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(base&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, offset&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, size&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 假设已经在外层保证了不会溢出&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    (base &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; offset) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; size&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 对于需要环绕语义的场景，明确使用 wrapping_*&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; hash_combine&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(hash1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, hash2&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    hash1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(hash2)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0x9e3779b97f4a7c15&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;3-测试建议\&quot;&gt;3. 测试建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-测试建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;#[cfg(test)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;mod&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; tests&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    use&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; super&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[test]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[should_panic(expected &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;divide by zero\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; test_division_by_zero_panics&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; _ &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; /&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[test]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[should_panic(expected &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;remainder\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; test_modulo_by_zero_panics&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; _ &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; %&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[test]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; test_safe_division&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        assert_eq!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Some&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        assert_eq!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;None&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        assert_eq!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;None&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;总结\&quot;&gt;总结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#总结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;关键要点\&quot;&gt;关键要点&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#关键要点\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Rust 中会导致 panic 的算术运算：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;a / 0&lt;/code&gt; 和 &lt;code&gt;a % 0&lt;/code&gt;（整数）&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;INT_MIN / -1&lt;/code&gt; 和 &lt;code&gt;INT_MIN % -1&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Debug 模式下的整数溢出&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;浮点数例外：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;f32/f64&lt;/code&gt; 的除零不会 panic，返回 &lt;code&gt;Infinity&lt;/code&gt; 或 &lt;code&gt;NaN&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Debug vs Release 的差异：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Debug：溢出 panic，帮助调试&lt;/li&gt;\n&lt;li&gt;Release：溢出环绕，优化性能&lt;/li&gt;\n&lt;li&gt;使用 &lt;code&gt;checked_*&lt;/code&gt; 等方法可以统一行为&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Rust 的解决方案：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;checked_*&lt;/code&gt;：安全检查，返回 &lt;code&gt;Option&amp;#x3C;T&gt;&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;wrapping_*&lt;/code&gt;：显式环绕&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;saturating_*&lt;/code&gt;：饱和到边界&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;overflowing_*&lt;/code&gt;：返回结果和溢出标志&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;strict_*&lt;/code&gt;：总是 panic（Rust 1.80+）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;设计哲学：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;避免未定义行为&lt;/li&gt;\n&lt;li&gt;强制显式处理&lt;/li&gt;\n&lt;li&gt;Panic 用于不可恢复的编程错误&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;实践建议\&quot;&gt;实践建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实践建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;✅ &lt;strong&gt;用户输入和外部数据&lt;/strong&gt;：总是使用 &lt;code&gt;checked_*&lt;/code&gt; 方法&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;算法题&lt;/strong&gt;：添加边界检查或使用 &lt;code&gt;checked_*&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;性能关键路径&lt;/strong&gt;：如果确定安全，可以用普通运算符，但要有充分的注释说明&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;需要环绕语义&lt;/strong&gt;：明确使用 &lt;code&gt;wrapping_*&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;测试&lt;/strong&gt;：为边界情况编写测试，包括 panic 测试&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;延伸阅读\&quot;&gt;延伸阅读&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#延伸阅读\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;https://rust-lang.github.io/rfcs/0560-integer-overflow.html\&quot;&gt;Rust RFC 560 - Integer Overflow&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/\&quot;&gt;Myths and Legends about Integer Overflow in Rust&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/std/ops/trait.Div.html\&quot;&gt;Rust Documentation - Div trait&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/reference/behavior-not-considered-unsafe.html\&quot;&gt;Behavior not considered unsafe - Rust Reference&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/\&quot;&gt;Exploring Rust’s Overflow Behavior - Sling Academy&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;最后提醒：&lt;/strong&gt; 这些行为不是 bug，而是 Rust 为了安全性做出的有意设计。理解这些特性，才能写出既安全又高效的 Rust 代码。下次刷算法题时，记得留意除法和取模操作，不要让你的解答因为一个 &lt;code&gt;% 0&lt;/code&gt; 而崩溃！&lt;/p&gt;\n&lt;p&gt;写到这里，我想起了前一个月的 cloudflare的unwarp 造成的panic!。真的很好笑。&lt;/p&gt;\n&lt;p&gt;一定要注意rust一切可能引起panic!的可能性，才不会像cloudflare的unwarp方法一样，搞出的几十亿美金的全球网站崩溃漏洞。&lt;/p&gt;\n&lt;p&gt;Sources:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;https://rust-lang.github.io/rfcs/0560-integer-overflow.html\&quot;&gt;Rust RFC 560 - Integer Overflow&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/\&quot;&gt;Myths and Legends about Integer Overflow in Rust&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://stackoverflow.com/questions/68807024/what-happens-in-rust-programming-language-when-an-integer-arithmetic-operation-o\&quot;&gt;What happens in Rust programming language when an integer arithmetic operation overflows? - Stack Overflow&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/\&quot;&gt;Exploring Rust’s Overflow Behavior: Wrapping, Saturating, and Panicking - Sling Academy&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/std/ops/trait.Div.html\&quot;&gt;Div in std::ops - Rust&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;rust-中会导致-panic-的算术运算&quot;],&quot;text&quot;:[0,&quot;Rust 中会导致 Panic 的算术运算&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-除法和取模运算的零除错误&quot;],&quot;text&quot;:[0,&quot;1. 除法和取模运算的零除错误&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-整数溢出的特殊边界情况&quot;],&quot;text&quot;:[0,&quot;2. 整数溢出的特殊边界情况&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-debug-模式下的整数溢出&quot;],&quot;text&quot;:[0,&quot;3. Debug 模式下的整数溢出&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;rust-的解决方案显式的溢出处理&quot;],&quot;text&quot;:[0,&quot;Rust 的解决方案：显式的溢出处理&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-checked_-系列安全检查返回-option&quot;],&quot;text&quot;:[0,&quot;1. checked_* 系列：安全检查，返回 Option&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-wrapping_-系列显式环绕行为&quot;],&quot;text&quot;:[0,&quot;2. wrapping_* 系列：显式环绕行为&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-saturating_-系列饱和到边界值&quot;],&quot;text&quot;:[0,&quot;3. saturating_* 系列：饱和到边界值&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;4-overflowing_-系列返回结果和溢出标志&quot;],&quot;text&quot;:[0,&quot;4. overflowing_* 系列：返回结果和溢出标志&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;5-strict_-系列总是-panicrust-180&quot;],&quot;text&quot;:[0,&quot;5. strict_* 系列：总是 Panic（Rust 1.80+）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;完整的除零安全处理示例&quot;],&quot;text&quot;:[0,&quot;完整的除零安全处理示例&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;rust-vs-其他语言&quot;],&quot;text&quot;:[0,&quot;Rust vs 其他语言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;实战建议&quot;],&quot;text&quot;:[0,&quot;实战建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-算法题中的处理&quot;],&quot;text&quot;:[0,&quot;1. 算法题中的处理&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-生产代码的建议&quot;],&quot;text&quot;:[0,&quot;2. 生产代码的建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-测试建议&quot;],&quot;text&quot;:[0,&quot;3. 测试建议&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;总结&quot;],&quot;text&quot;:[0,&quot;总结&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;关键要点&quot;],&quot;text&quot;:[0,&quot;关键要点&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;实践建议&quot;],&quot;text&quot;:[0,&quot;实践建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;延伸阅读&quot;],&quot;text&quot;:[0,&quot;延伸阅读&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Rust 算术运算的 Panic 陷阱：从取模零说起&quot;],&quot;date&quot;:[3,&quot;2025-12-02T10:00:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;算法&quot;],[0,&quot;安全&quot;],[0,&quot;Panic&quot;],[0,&quot;算术运算&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;],&quot;description&quot;:[0,&quot;在刷 Rust 算法题时发现了一个独特现象：对零取模会直接导致程序 panic！这与其他语言的行为截然不同。本文深入探讨 Rust 中会导致 panic 的算术运算场景，包括除零、整数溢出、INT_MIN/-1 等特殊情况，以及 Rust 提供的 checked_、wrapping_、saturating_ 等安全替代方案。理解这些行为对于编写健壮的 Rust 程序至关重要。&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/20&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;rust引用生命周期-不只是切片&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Rust 引用生命周期：不只是切片&quot;],&quot;description&quot;:[0,&quot;探讨 Rust 中引用生命周期的普遍规律，揭示所有引用类型（切片、结构体字段、数组元素等）都遵循\&quot;可短不可长\&quot;的生命周期原则。&quot;],&quot;date&quot;:[3,&quot;2025-11-27T14:30:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;生命周期&quot;],[0,&quot;引用&quot;],[0,&quot;所有权&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;]}],&quot;body&quot;:[0,&quot;## 前言\n\n在学习 Rust 的生命周期时，我们经常会看到切片（slice）作为典型例子：切片的生命周期可以比原始数据短，但不能比原始数据长。但这只是切片的特性吗？实际上，**所有引用类型**都遵循这一规律。\n\n## 核心原则\n\nRust 中的引用生命周期遵循一个简单而强大的原则：\n\n&gt; **任何\&quot;借用\&quot;原始数据一部分的引用，生命周期都可以比原始数据短，但绝不能比原始数据长。**\n\n这不仅适用于切片，还适用于所有引用场景。\n\n## 典型案例\n\n### 1. 切片引用\n\n这是最常见的例子：\n\n```rust\nfn main() {\n    let s = String::from(\&quot;hello world\&quot;);\n\n    {\n        let slice = &amp;s[0..5]; // slice 的生命周期在这个作用域内\n        println!(\&quot;{}\&quot;, slice); // 输出: hello\n    } // slice 在这里结束，但 s 还活着\n\n    println!(\&quot;{}\&quot;, s); // s 仍然有效\n}\n```\n\n**关键点：** `slice` 的生命周期比 `s` 短，只要 `s` 有效，`slice` 就有效。\n\n### 2. 结构体字段引用\n\n如果结构体的某个字段是引用，这个引用的生命周期可以比整个结构体短：\n\n```rust\nstruct Person&lt;&#39;a&gt; {\n    name: &amp;&#39;a str,\n    age: u32,\n}\n\nfn main() {\n    let name = String::from(\&quot;Alice\&quot;);\n\n    {\n        let person = Person {\n            name: &amp;name,\n            age: 30,\n        };\n\n        // person.name 的生命周期在这个作用域内\n        println!(\&quot;{} is {} years old\&quot;, person.name, person.age);\n    } // person 和它的引用在这里结束\n\n    println!(\&quot;Original name: {}\&quot;, name); // name 仍然有效\n}\n```\n\n**关键点：** `person.name` 是对 `name` 的引用，它的生命周期受限于 `person` 所在的作用域，但 `name` 本身可以活得更久。\n\n### 3. 数组元素引用\n\n取数组某个元素的引用，其生命周期可以比整个数组短：\n\n```rust\nfn main() {\n    let arr = [1, 2, 3, 4, 5];\n\n    {\n        let first = &amp;arr[0]; // first 的生命周期在这个作用域内\n        println!(\&quot;First element: {}\&quot;, first); // 输出: 1\n    } // first 在这里结束\n\n    println!(\&quot;Array: {:?}\&quot;, arr); // arr 仍然有效\n}\n```\n\n**关键点：** `&amp;arr[0]` 只在内层作用域有效，但 `arr` 可以在外层作用域继续使用。\n\n### 4. 函数参数的局部引用\n\n函数内部可以创建对参数的局部引用，这些引用的生命周期比参数本身短：\n\n```rust\nfn process_data(data: &amp;Vec&lt;i32&gt;) {\n    // 取 data 的一部分\n    let slice = &amp;data[1..3];\n    println!(\&quot;Slice: {:?}\&quot;, slice);\n\n    // slice 的生命周期在这里结束\n    // 但 data 引用仍然有效，可以继续使用\n    println!(\&quot;Full data: {:?}\&quot;, data);\n}\n\nfn main() {\n    let numbers = vec![1, 2, 3, 4, 5];\n    process_data(&amp;numbers);\n}\n```\n\n**关键点：** `slice` 是对 `data` 的进一步借用，它的生命周期更短，但只要 `data` 有效，`slice` 就可以创建和使用。\n\n### 5. 嵌套引用\n\n引用的引用也遵循相同的规律：\n\n```rust\nfn main() {\n    let x = 42;\n    let r1 = &amp;x;\n\n    {\n        let r2 = &amp;r1; // r2 是对 r1 的引用\n        println!(\&quot;r2: {}\&quot;, r2); // 输出: 42\n    } // r2 在这里结束\n\n    println!(\&quot;r1: {}\&quot;, r1); // r1 仍然有效\n    println!(\&quot;x: {}\&quot;, x);   // x 仍然有效\n}\n```\n\n**关键点：** 每一层引用的生命周期都可以比它所引用的数据短。\n\n## 为什么可以更短？\n\nRust 的借用检查器（borrow checker）会确保：\n\n1. **引用有效期内，原始数据不会被释放**\n2. **引用的生命周期可以比原始数据短**，因为提前结束引用不会影响原始数据\n3. **原始数据的生命周期可以延续**，即使引用已经失效\n\n这就像租房：\n- 房东（原始数据）可以在租约（引用）到期后继续拥有房子\n- 租客（引用）可以提前退租（生命周期更短）\n- 但租客不能在房子被拆除后继续住（引用不能比原始数据长）\n\n## 为什么不能更长？\n\n这是 Rust 所有权系统的核心保证：\n\n```rust\nfn dangling_reference() -&gt; &amp;String {\n    let s = String::from(\&quot;hello\&quot;);\n    &amp;s // ❌ 编译错误：s 在函数结束时被释放\n}      // 但我们试图返回对它的引用\n```\n\n如果允许引用的生命周期比原始数据长，就会出现**悬垂引用**（dangling reference），指向已经被释放的内存，这是内存安全问题的根源。\n\n## 实际应用场景\n\n### 场景 1：临时处理数据片段\n\n```rust\nfn analyze_header(data: &amp;[u8]) {\n    // 只处理前 10 个字节\n    if data.len() &gt;= 10 {\n        let header = &amp;data[0..10];\n        println!(\&quot;Header: {:?}\&quot;, header);\n        // header 在这里结束，但 data 仍然可用\n    }\n\n    // 继续处理完整数据\n    println!(\&quot;Total length: {}\&quot;, data.len());\n}\n```\n\n### 场景 2：链式引用\n\n```rust\nstruct Config {\n    settings: Vec&lt;String&gt;,\n}\n\nimpl Config {\n    fn get_setting(&amp;self, index: usize) -&gt; Option&lt;&amp;str&gt; {\n        self.settings.get(index).map(|s| s.as_str())\n    }\n}\n\nfn main() {\n    let config = Config {\n        settings: vec![String::from(\&quot;debug=true\&quot;), String::from(\&quot;port=8080\&quot;)],\n    };\n\n    if let Some(setting) = config.get_setting(0) {\n        println!(\&quot;Setting: {}\&quot;, setting);\n        // setting 引用在这里有效\n    } // setting 在这里结束\n\n    // config 仍然有效\n    println!(\&quot;Total settings: {}\&quot;, config.settings.len());\n}\n```\n\n### 场景 3：迭代器中的引用\n\n```rust\nfn main() {\n    let words = vec![\n        String::from(\&quot;hello\&quot;),\n        String::from(\&quot;world\&quot;),\n        String::from(\&quot;rust\&quot;),\n    ];\n\n    // 迭代器产生的引用生命周期在循环内\n    for word in words.iter() {\n        // word 是 &amp;String，只在这次循环迭代中有效\n        println!(\&quot;{}\&quot;, word);\n    }\n\n    // words 仍然有效，可以继续使用\n    println!(\&quot;Total words: {}\&quot;, words.len());\n}\n```\n\n## 常见陷阱\n\n### 陷阱 1：试图返回局部变量的引用\n\n```rust\nfn get_first_word(s: &amp;str) -&gt; &amp;str {\n    let words: Vec&lt;&amp;str&gt; = s.split_whitespace().collect();\n    words[0] // ❌ 可能有问题：words 在函数结束时被释放\n}\n```\n\n正确做法：\n\n```rust\nfn get_first_word(s: &amp;str) -&gt; &amp;str {\n    s.split_whitespace().next().unwrap_or(\&quot;\&quot;)\n    // 直接返回原始 s 的切片，生命周期与 s 相同\n}\n```\n\n### 陷阱 2：在结构体中存储临时引用\n\n```rust\nstruct Cache&lt;&#39;a&gt; {\n    data: &amp;&#39;a str,\n}\n\nfn main() {\n    let cache;\n    {\n        let temp = String::from(\&quot;temporary\&quot;);\n        cache = Cache { data: &amp;temp };\n        // ❌ 编译错误：temp 在这里被释放\n    }\n    // println!(\&quot;{}\&quot;, cache.data); // cache.data 会成为悬垂引用\n}\n```\n\n## 总结\n\n### 核心要点\n\n1. **普遍规律**：所有引用类型都遵循\&quot;可短不可长\&quot;的生命周期原则\n   - 切片引用\n   - 结构体字段引用\n   - 数组元素引用\n   - 函数参数的局部引用\n   - 嵌套引用\n\n2. **可以更短的原因**：\n   - 引用提前结束不影响原始数据\n   - 原始数据可以在引用失效后继续存在\n   - 符合 Rust 的内存安全保证\n\n3. **不能更长的原因**：\n   - 防止悬垂引用\n   - 确保引用始终指向有效内存\n   - Rust 所有权系统的核心保证\n\n4. **实践建议**：\n   - 理解引用的生命周期本质\n   - 避免创建比原始数据更长的引用\n   - 利用作用域控制引用的生命周期\n   - 使用借用检查器的错误提示定位问题\n\n### 记忆口诀\n\n**借用可短不可长，原数据寿命是底线。**\n\n### 延伸思考\n\n- 生命周期标注（`&#39;a`）是如何帮助编译器检查的？\n- 静态生命周期（`&#39;static`）为什么可以\&quot;永久存在\&quot;？\n- 如何在复杂数据结构中管理多个引用的生命周期？\n\n希望这篇文章能帮助你全面理解 Rust 中引用生命周期的普遍规律，而不只是局限于切片这一个例子！\n\n---\n\n**提示：** 生命周期是 Rust 最具特色的概念之一，建议结合实际代码练习，多尝试编译器的错误提示，你会逐渐形成直觉。&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Rust引用生命周期-不只是切片.md&quot;],&quot;digest&quot;:[0,&quot;aa17305627bf5bbe&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h2 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;在学习 Rust 的生命周期时，我们经常会看到切片（slice）作为典型例子：切片的生命周期可以比原始数据短，但不能比原始数据长。但这只是切片的特性吗？实际上，&lt;strong&gt;所有引用类型&lt;/strong&gt;都遵循这一规律。&lt;/p&gt;\n&lt;h2 id=\&quot;核心原则\&quot;&gt;核心原则&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#核心原则\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 中的引用生命周期遵循一个简单而强大的原则：&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;&lt;strong&gt;任何”借用”原始数据一部分的引用，生命周期都可以比原始数据短，但绝不能比原始数据长。&lt;/strong&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;这不仅适用于切片，还适用于所有引用场景。&lt;/p&gt;\n&lt;h2 id=\&quot;典型案例\&quot;&gt;典型案例&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#典型案例\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;1-切片引用\&quot;&gt;1. 切片引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-切片引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;这是最常见的例子：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello world\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; slice &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;..&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;]; &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// slice 的生命周期在这个作用域内&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, slice); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: hello&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    } &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// slice 在这里结束，但 s 还活着&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, s); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// s 仍然有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;关键点：&lt;/strong&gt; &lt;code&gt;slice&lt;/code&gt; 的生命周期比 &lt;code&gt;s&lt;/code&gt; 短，只要 &lt;code&gt;s&lt;/code&gt; 有效，&lt;code&gt;slice&lt;/code&gt; 就有效。&lt;/p&gt;\n&lt;h3 id=\&quot;2-结构体字段引用\&quot;&gt;2. 结构体字段引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-结构体字段引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;如果结构体的某个字段是引用，这个引用的生命周期可以比整个结构体短：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;struct&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Person&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;a&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    name&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;a&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    age&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; name &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Alice\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; person &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Person&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            name&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;name,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            age&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 30&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        };&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;        // person.name 的生命周期在这个作用域内&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{} is {} years old\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, person&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;name, person&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;age);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    } &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// person 和它的引用在这里结束&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Original name: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, name); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// name 仍然有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;关键点：&lt;/strong&gt; &lt;code&gt;person.name&lt;/code&gt; 是对 &lt;code&gt;name&lt;/code&gt; 的引用，它的生命周期受限于 &lt;code&gt;person&lt;/code&gt; 所在的作用域，但 &lt;code&gt;name&lt;/code&gt; 本身可以活得更久。&lt;/p&gt;\n&lt;h3 id=\&quot;3-数组元素引用\&quot;&gt;3. 数组元素引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-数组元素引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;取数组某个元素的引用，其生命周期可以比整个数组短：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; arr &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; [&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;4&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; first &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;arr[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;]; &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// first 的生命周期在这个作用域内&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;First element: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, first); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    } &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// first 在这里结束&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Array: {:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, arr); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// arr 仍然有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;关键点：&lt;/strong&gt; &lt;code&gt;&amp;#x26;arr[0]&lt;/code&gt; 只在内层作用域有效，但 &lt;code&gt;arr&lt;/code&gt; 可以在外层作用域继续使用。&lt;/p&gt;\n&lt;h3 id=\&quot;4-函数参数的局部引用\&quot;&gt;4. 函数参数的局部引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#4-函数参数的局部引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;函数内部可以创建对参数的局部引用，这些引用的生命周期比参数本身短：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process_data&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 取 data 的一部分&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; slice &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;data[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;..&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Slice: {:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, slice);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // slice 的生命周期在这里结束&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 但 data 引用仍然有效，可以继续使用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Full data: {:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, data);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;4&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    process_data&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;numbers);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;关键点：&lt;/strong&gt; &lt;code&gt;slice&lt;/code&gt; 是对 &lt;code&gt;data&lt;/code&gt; 的进一步借用，它的生命周期更短，但只要 &lt;code&gt;data&lt;/code&gt; 有效，&lt;code&gt;slice&lt;/code&gt; 就可以创建和使用。&lt;/p&gt;\n&lt;h3 id=\&quot;5-嵌套引用\&quot;&gt;5. 嵌套引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#5-嵌套引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;引用的引用也遵循相同的规律：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 42&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; r1 &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;x;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; r2 &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;r1; &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// r2 是对 r1 的引用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;r2: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, r2); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: 42&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    } &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// r2 在这里结束&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;r1: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, r1); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// r1 仍然有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;x: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, x);   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// x 仍然有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;关键点：&lt;/strong&gt; 每一层引用的生命周期都可以比它所引用的数据短。&lt;/p&gt;\n&lt;h2 id=\&quot;为什么可以更短\&quot;&gt;为什么可以更短？&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#为什么可以更短\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 的借用检查器（borrow checker）会确保：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;引用有效期内，原始数据不会被释放&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;引用的生命周期可以比原始数据短&lt;/strong&gt;，因为提前结束引用不会影响原始数据&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;原始数据的生命周期可以延续&lt;/strong&gt;，即使引用已经失效&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;这就像租房：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;房东（原始数据）可以在租约（引用）到期后继续拥有房子&lt;/li&gt;\n&lt;li&gt;租客（引用）可以提前退租（生命周期更短）&lt;/li&gt;\n&lt;li&gt;但租客不能在房子被拆除后继续住（引用不能比原始数据长）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;为什么不能更长\&quot;&gt;为什么不能更长？&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#为什么不能更长\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;这是 Rust 所有权系统的核心保证：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; dangling_reference&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ❌ 编译错误：s 在函数结束时被释放&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 但我们试图返回对它的引用&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;如果允许引用的生命周期比原始数据长，就会出现&lt;strong&gt;悬垂引用&lt;/strong&gt;（dangling reference），指向已经被释放的内存，这是内存安全问题的根源。&lt;/p&gt;\n&lt;h2 id=\&quot;实际应用场景\&quot;&gt;实际应用场景&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实际应用场景\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;场景-1临时处理数据片段\&quot;&gt;场景 1：临时处理数据片段&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-1临时处理数据片段\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; analyze_header&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;]) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 只处理前 10 个字节&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; header &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;data[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;..&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Header: {:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, header);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;        // header 在这里结束，但 data 仍然可用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 继续处理完整数据&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Total length: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;场景-2链式引用\&quot;&gt;场景 2：链式引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-2链式引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;struct&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Config&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    settings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Config&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; get_setting&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, index&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;settings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;get&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(index)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;map&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;as_str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; config &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Config&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        settings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;debug=true\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;port=8080\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)],&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    };&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    if&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; let&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Some&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(setting) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; config&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;get_setting&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Setting: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, setting);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;        // setting 引用在这里有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    } &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// setting 在这里结束&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // config 仍然有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Total settings: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, config&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;settings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;场景-3迭代器中的引用\&quot;&gt;场景 3：迭代器中的引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-3迭代器中的引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; words &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;world\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;rust\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    ];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 迭代器产生的引用生命周期在循环内&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; word &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; words&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;        // word 是 &amp;#x26;String，只在这次循环迭代中有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, word);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // words 仍然有效，可以继续使用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Total words: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, words&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;常见陷阱\&quot;&gt;常见陷阱&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#常见陷阱\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;陷阱-1试图返回局部变量的引用\&quot;&gt;陷阱 1：试图返回局部变量的引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#陷阱-1试图返回局部变量的引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; get_first_word&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; words&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;split_whitespace&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;collect&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    words[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;] &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ❌ 可能有问题：words 在函数结束时被释放&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;正确做法：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; get_first_word&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;split_whitespace&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;next&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;unwrap_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 直接返回原始 s 的切片，生命周期与 s 相同&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;陷阱-2在结构体中存储临时引用\&quot;&gt;陷阱 2：在结构体中存储临时引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#陷阱-2在结构体中存储临时引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;struct&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Cache&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;a&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;a&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; cache;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; temp &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;temporary\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        cache &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Cache&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; { data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;temp };&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;        // ❌ 编译错误：temp 在这里被释放&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // println!(\&quot;{}\&quot;, cache.data); // cache.data 会成为悬垂引用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;总结\&quot;&gt;总结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#总结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;核心要点\&quot;&gt;核心要点&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#核心要点\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;普遍规律&lt;/strong&gt;：所有引用类型都遵循”可短不可长”的生命周期原则&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;切片引用&lt;/li&gt;\n&lt;li&gt;结构体字段引用&lt;/li&gt;\n&lt;li&gt;数组元素引用&lt;/li&gt;\n&lt;li&gt;函数参数的局部引用&lt;/li&gt;\n&lt;li&gt;嵌套引用&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;可以更短的原因&lt;/strong&gt;：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;引用提前结束不影响原始数据&lt;/li&gt;\n&lt;li&gt;原始数据可以在引用失效后继续存在&lt;/li&gt;\n&lt;li&gt;符合 Rust 的内存安全保证&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;不能更长的原因&lt;/strong&gt;：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;防止悬垂引用&lt;/li&gt;\n&lt;li&gt;确保引用始终指向有效内存&lt;/li&gt;\n&lt;li&gt;Rust 所有权系统的核心保证&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;实践建议&lt;/strong&gt;：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;理解引用的生命周期本质&lt;/li&gt;\n&lt;li&gt;避免创建比原始数据更长的引用&lt;/li&gt;\n&lt;li&gt;利用作用域控制引用的生命周期&lt;/li&gt;\n&lt;li&gt;使用借用检查器的错误提示定位问题&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;记忆口诀\&quot;&gt;记忆口诀&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#记忆口诀\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;&lt;strong&gt;借用可短不可长，原数据寿命是底线。&lt;/strong&gt;&lt;/p&gt;\n&lt;h3 id=\&quot;延伸思考\&quot;&gt;延伸思考&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#延伸思考\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;生命周期标注（&lt;code&gt;&#39;a&lt;/code&gt;）是如何帮助编译器检查的？&lt;/li&gt;\n&lt;li&gt;静态生命周期（&lt;code&gt;&#39;static&lt;/code&gt;）为什么可以”永久存在”？&lt;/li&gt;\n&lt;li&gt;如何在复杂数据结构中管理多个引用的生命周期？&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;希望这篇文章能帮助你全面理解 Rust 中引用生命周期的普遍规律，而不只是局限于切片这一个例子！&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;提示：&lt;/strong&gt; 生命周期是 Rust 最具特色的概念之一，建议结合实际代码练习，多尝试编译器的错误提示，你会逐渐形成直觉。&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;核心原则&quot;],&quot;text&quot;:[0,&quot;核心原则&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;典型案例&quot;],&quot;text&quot;:[0,&quot;典型案例&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-切片引用&quot;],&quot;text&quot;:[0,&quot;1. 切片引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-结构体字段引用&quot;],&quot;text&quot;:[0,&quot;2. 结构体字段引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-数组元素引用&quot;],&quot;text&quot;:[0,&quot;3. 数组元素引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;4-函数参数的局部引用&quot;],&quot;text&quot;:[0,&quot;4. 函数参数的局部引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;5-嵌套引用&quot;],&quot;text&quot;:[0,&quot;5. 嵌套引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;为什么可以更短&quot;],&quot;text&quot;:[0,&quot;为什么可以更短？&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;为什么不能更长&quot;],&quot;text&quot;:[0,&quot;为什么不能更长？&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;实际应用场景&quot;],&quot;text&quot;:[0,&quot;实际应用场景&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-1临时处理数据片段&quot;],&quot;text&quot;:[0,&quot;场景 1：临时处理数据片段&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-2链式引用&quot;],&quot;text&quot;:[0,&quot;场景 2：链式引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-3迭代器中的引用&quot;],&quot;text&quot;:[0,&quot;场景 3：迭代器中的引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;常见陷阱&quot;],&quot;text&quot;:[0,&quot;常见陷阱&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;陷阱-1试图返回局部变量的引用&quot;],&quot;text&quot;:[0,&quot;陷阱 1：试图返回局部变量的引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;陷阱-2在结构体中存储临时引用&quot;],&quot;text&quot;:[0,&quot;陷阱 2：在结构体中存储临时引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;总结&quot;],&quot;text&quot;:[0,&quot;总结&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;核心要点&quot;],&quot;text&quot;:[0,&quot;核心要点&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;记忆口诀&quot;],&quot;text&quot;:[0,&quot;记忆口诀&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;延伸思考&quot;],&quot;text&quot;:[0,&quot;延伸思考&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Rust 引用生命周期：不只是切片&quot;],&quot;date&quot;:[3,&quot;2025-11-27T14:30:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;生命周期&quot;],[0,&quot;引用&quot;],[0,&quot;所有权&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;],&quot;description&quot;:[0,&quot;探讨 Rust 中引用生命周期的普遍规律，揭示所有引用类型（切片、结构体字段、数组元素等）都遵循\&quot;可短不可长\&quot;的生命周期原则。&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/19&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;rust-trait-为泛型类型的具体实例实现特征&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Rust Trait：为泛型类型的具体实例实现特征&quot;],&quot;description&quot;:[0,&quot;深入理解 Rust 中 trait 实现的灵活性：为什么可以为 Vec&lt;String&gt; 这样的泛型类型具体实例实现 trait？探讨 Rust 类型系统中的类型特化（Type Specialization）、trait 实现的作用范围，以及如何利用这一特性编写更灵活的代码。&quot;],&quot;date&quot;:[3,&quot;2025-11-25T10:30:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;Trait&quot;],[0,&quot;泛型&quot;],[0,&quot;类型系统&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;]}],&quot;body&quot;:[0,&quot;## 前言\n\n在学习 Rust 的 trait 系统时，我遇到了一个有趣的问题：**为什么可以为 `Vec&lt;String&gt;` 这样的泛型类型的具体实例实现 trait？** 这似乎与我们通常理解的\&quot;只能为结构体实现 trait\&quot;的观念不太一致。本文将深入探讨这个问题，帮助你更好地理解 Rust 的类型系统。\n\n## 问题的由来\n\n假设我们定义了一个简单的 trait：\n\n```rust\ntrait AppendBar {\n    fn append_bar(&amp;mut self);\n}\n```\n\n然后，我们可以这样为 `Vec&lt;String&gt;` 实现这个 trait：\n\n```rust\nimpl AppendBar for Vec&lt;String&gt; {\n    fn append_bar(&amp;mut self) {\n        self.push(String::from(\&quot;Bar\&quot;));\n    }\n}\n```\n\n这段代码完全合法且能正常工作：\n\n```rust\nfn main() {\n    let mut my_vec: Vec&lt;String&gt; = vec![\n        String::from(\&quot;Foo\&quot;),\n        String::from(\&quot;Baz\&quot;),\n    ];\n\n    my_vec.append_bar();\n\n    println!(\&quot;{:?}\&quot;, my_vec); // 输出: [\&quot;Foo\&quot;, \&quot;Baz\&quot;, \&quot;Bar\&quot;]\n}\n```\n\n但问题来了：**`Vec&lt;String&gt;` 不是一个结构体，而是泛型类型 `Vec&lt;T&gt;` 的一个具体实例，为什么可以为它实现 trait？**\n\n## 核心概念：类型特化（Type Specialization）\n\n### 什么是类型特化？\n\n在 Rust 中，`Vec&lt;T&gt;` 是一个**泛型类型**，其中 `T` 是类型参数。当我们指定 `T = String` 时，`Vec&lt;String&gt;` 就成为了一个**具体类型**（Concrete Type），这个过程被称为**类型特化**。\n\n从 Rust 编译器的角度来看：\n\n- `Vec&lt;T&gt;` 是一个**类型构造器**（Type Constructor），需要一个类型参数才能成为完整的类型\n- `Vec&lt;String&gt;` 是一个**完整的具体类型**，和 `i32`、`String` 等具有同等地位\n\n### 类型特化的实例\n\n```rust\n// 这些都是不同的具体类型\nlet v1: Vec&lt;i32&gt; = vec![1, 2, 3];\nlet v2: Vec&lt;String&gt; = vec![\&quot;hello\&quot;.to_string()];\nlet v3: Vec&lt;Vec&lt;u8&gt;&gt; = vec![vec![1, 2], vec![3, 4]];\n```\n\n在 Rust 的类型系统中，`Vec&lt;i32&gt;`、`Vec&lt;String&gt;` 和 `Vec&lt;Vec&lt;u8&gt;&gt;` 是**三个完全不同的类型**，就像 `Dog` 和 `Cat` 是两个不同的结构体一样。\n\n## Trait 实现的灵活性\n\nRust 的 trait 系统允许你为**任何具体类型**实现 trait，不仅仅是结构体。这包括：\n\n1. **自定义结构体**\n2. **枚举类型**\n3. **泛型类型的具体实例**（如 `Vec&lt;String&gt;`）\n4. **基本类型**（如 `i32`，但需要遵循孤儿规则）\n5. **元组类型**（如 `(i32, String)`）\n\n### 示例 1：为不同的 Vec 实例实现不同的 trait\n\n```rust\ntrait AppendBar {\n    fn append_bar(&amp;mut self);\n}\n\ntrait AppendBaz {\n    fn append_baz(&amp;mut self);\n}\n\n// 为 Vec&lt;String&gt; 实现 AppendBar\nimpl AppendBar for Vec&lt;String&gt; {\n    fn append_bar(&amp;mut self) {\n        self.push(String::from(\&quot;Bar\&quot;));\n    }\n}\n\n// 为 Vec&lt;i32&gt; 实现 AppendBaz\nimpl AppendBaz for Vec&lt;i32&gt; {\n    fn append_baz(&amp;mut self) {\n        self.push(42);\n    }\n}\n\nfn main() {\n    let mut strings = vec![String::from(\&quot;Foo\&quot;)];\n    strings.append_bar(); // ✅ 可以调用\n    // strings.append_baz(); // ❌ 编译错误：Vec&lt;String&gt; 没有实现 AppendBaz\n\n    let mut numbers = vec![1, 2, 3];\n    numbers.append_baz(); // ✅ 可以调用\n    // numbers.append_bar(); // ❌ 编译错误：Vec&lt;i32&gt; 没有实现 AppendBar\n}\n```\n\n### 示例 2：为元组类型实现 trait\n\n```rust\ntrait Describable {\n    fn describe(&amp;self) -&gt; String;\n}\n\n// 为 (i32, String) 元组实现 trait\nimpl Describable for (i32, String) {\n    fn describe(&amp;self) -&gt; String {\n        format!(\&quot;Number: {}, Text: {}\&quot;, self.0, self.1)\n    }\n}\n\nfn main() {\n    let tuple = (42, String::from(\&quot;Hello\&quot;));\n    println!(\&quot;{}\&quot;, tuple.describe()); // 输出: Number: 42, Text: Hello\n}\n```\n\n## 泛型实现 vs 具体实现\n\nRust 允许你选择不同的实现策略：\n\n### 策略 1：为所有 `Vec&lt;T&gt;` 实现（泛型实现）\n\n```rust\ntrait Printable {\n    fn print_all(&amp;self);\n}\n\n// 为所有 Vec&lt;T&gt; 实现，其中 T 必须实现 Debug trait\nimpl&lt;T: std::fmt::Debug&gt; Printable for Vec&lt;T&gt; {\n    fn print_all(&amp;self) {\n        for item in self {\n            println!(\&quot;{:?}\&quot;, item);\n        }\n    }\n}\n\nfn main() {\n    let strings = vec![String::from(\&quot;Foo\&quot;), String::from(\&quot;Bar\&quot;)];\n    strings.print_all(); // ✅ 可以使用\n\n    let numbers = vec![1, 2, 3];\n    numbers.print_all(); // ✅ 也可以使用\n}\n```\n\n**特点：**\n- 为所有满足约束的 `Vec&lt;T&gt;` 实现 trait\n- trait 方法必须对所有可能的 `T` 都有效\n- 实现代码只写一次，适用于多种类型\n\n### 策略 2：为特定的 `Vec&lt;T&gt;` 实现（具体实现）\n\n```rust\ntrait StringOperations {\n    fn to_uppercase_all(&amp;mut self);\n    fn concat_all(&amp;self) -&gt; String;\n}\n\n// 仅为 Vec&lt;String&gt; 实现\nimpl StringOperations for Vec&lt;String&gt; {\n    fn to_uppercase_all(&amp;mut self) {\n        for s in self.iter_mut() {\n            *s = s.to_uppercase();\n        }\n    }\n\n    fn concat_all(&amp;self) -&gt; String {\n        self.join(\&quot;, \&quot;)\n    }\n}\n\nfn main() {\n    let mut strings = vec![String::from(\&quot;hello\&quot;), String::from(\&quot;world\&quot;)];\n    strings.to_uppercase_all();\n    println!(\&quot;{}\&quot;, strings.concat_all()); // 输出: HELLO, WORLD\n\n    // let mut numbers = vec![1, 2, 3];\n    // numbers.to_uppercase_all(); // ❌ 编译错误：Vec&lt;i32&gt; 没有实现 StringOperations\n}\n```\n\n**特点：**\n- 只为特定的 `Vec&lt;String&gt;` 实现\n- 可以使用 `String` 特有的方法（如 `to_uppercase()`）\n- 实现更有针对性，类型更安全\n\n## 实际应用场景\n\n### 场景 1：为标准库类型添加自定义功能\n\n```rust\ntrait Statistics {\n    fn mean(&amp;self) -&gt; f64;\n    fn median(&amp;self) -&gt; f64;\n}\n\nimpl Statistics for Vec&lt;f64&gt; {\n    fn mean(&amp;self) -&gt; f64 {\n        if self.is_empty() {\n            return 0.0;\n        }\n        self.iter().sum::&lt;f64&gt;() / self.len() as f64\n    }\n\n    fn median(&amp;self) -&gt; f64 {\n        if self.is_empty() {\n            return 0.0;\n        }\n        let mut sorted = self.clone();\n        sorted.sort_by(|a, b| a.partial_cmp(b).unwrap());\n        let mid = sorted.len() / 2;\n        if sorted.len() % 2 == 0 {\n            (sorted[mid - 1] + sorted[mid]) / 2.0\n        } else {\n            sorted[mid]\n        }\n    }\n}\n\nfn main() {\n    let data = vec![1.0, 2.0, 3.0, 4.0, 5.0];\n    println!(\&quot;Mean: {}\&quot;, data.mean());     // 输出: Mean: 3\n    println!(\&quot;Median: {}\&quot;, data.median()); // 输出: Median: 3\n}\n```\n\n### 场景 2：实现特定领域的类型约束\n\n```rust\ntrait JsonSerializable {\n    fn to_json(&amp;self) -&gt; String;\n}\n\n// 为字符串数组实现 JSON 序列化\nimpl JsonSerializable for Vec&lt;String&gt; {\n    fn to_json(&amp;self) -&gt; String {\n        let items: Vec&lt;String&gt; = self\n            .iter()\n            .map(|s| format!(\&quot;\\\&quot;{}\\\&quot;\&quot;, s))\n            .collect();\n        format!(\&quot;[{}]\&quot;, items.join(\&quot;, \&quot;))\n    }\n}\n\n// 为数字数组实现 JSON 序列化\nimpl JsonSerializable for Vec&lt;i32&gt; {\n    fn to_json(&amp;self) -&gt; String {\n        let items: Vec&lt;String&gt; = self\n            .iter()\n            .map(|n| n.to_string())\n            .collect();\n        format!(\&quot;[{}]\&quot;, items.join(\&quot;, \&quot;))\n    }\n}\n\nfn main() {\n    let strings = vec![String::from(\&quot;hello\&quot;), String::from(\&quot;world\&quot;)];\n    println!(\&quot;{}\&quot;, strings.to_json()); // 输出: [\&quot;hello\&quot;, \&quot;world\&quot;]\n\n    let numbers = vec![1, 2, 3];\n    println!(\&quot;{}\&quot;, numbers.to_json()); // 输出: [1, 2, 3]\n}\n```\n\n## 孤儿规则（Orphan Rule）\n\n虽然可以为泛型类型的具体实例实现 trait，但必须遵守 Rust 的**孤儿规则**：\n\n&gt; **至少 trait 或类型其中之一必须在当前 crate 中定义。**\n\n### 合法的实现\n\n```rust\n// ✅ 情况 1：trait 在本 crate 中定义\ntrait MyTrait {\n    fn do_something(&amp;self);\n}\n\n// Vec 虽然是标准库的，但 MyTrait 是我们定义的\nimpl MyTrait for Vec&lt;String&gt; {\n    fn do_something(&amp;self) {\n        println!(\&quot;Doing something with {} strings\&quot;, self.len());\n    }\n}\n\n// ✅ 情况 2：类型在本 crate 中定义\nstruct MyType {\n    data: Vec&lt;i32&gt;,\n}\n\n// Display 虽然是标准库的，但 MyType 是我们定义的\nimpl std::fmt::Display for MyType {\n    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#39;_&gt;) -&gt; std::fmt::Result {\n        write!(f, \&quot;MyType with {} elements\&quot;, self.data.len())\n    }\n}\n```\n\n### 非法的实现\n\n```rust\n// ❌ 错误：trait 和类型都不在本 crate 中\n// impl std::fmt::Display for Vec&lt;String&gt; {\n//     fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#39;_&gt;) -&gt; std::fmt::Result {\n//         write!(f, \&quot;Custom Vec Display\&quot;)\n//     }\n// }\n// 编译错误：只有在本地 crate 定义的 trait 才能为外部类型实现\n```\n\n## 特化（Specialization）的未来\n\nRust 正在开发一个更强大的特性：**trait 特化（Trait Specialization）**，它允许你先为泛型类型实现 trait，然后为特定实例提供更优化的实现。\n\n```rust\n#![feature(specialization)] // 需要 nightly Rust\n\ntrait Process {\n    fn process(&amp;self);\n}\n\n// 默认实现：适用于所有 Vec&lt;T&gt;\nimpl&lt;T&gt; Process for Vec&lt;T&gt; {\n    default fn process(&amp;self) {\n        println!(\&quot;Processing {} items (generic)\&quot;, self.len());\n    }\n}\n\n// 特化实现：针对 Vec&lt;String&gt; 的优化版本\nimpl Process for Vec&lt;String&gt; {\n    fn process(&amp;self) {\n        println!(\&quot;Processing {} strings (specialized)\&quot;, self.len());\n        for s in self {\n            println!(\&quot;  - {}\&quot;, s);\n        }\n    }\n}\n```\n\n注意：这个特性目前还在实验阶段，仅在 nightly Rust 中可用。\n\n## 总结\n\n### 关键要点\n\n1. **`Vec&lt;String&gt;` 是一个完整的具体类型**，不是泛型类型\n   - `Vec&lt;T&gt;` 是泛型类型（类型构造器）\n   - `Vec&lt;String&gt;` 是具体类型（`T` 被特化为 `String`）\n\n2. **Rust 允许为任何具体类型实现 trait**\n   - 结构体、枚举\n   - 泛型类型的具体实例（如 `Vec&lt;String&gt;`）\n   - 基本类型、元组等\n\n3. **实现策略的选择**\n   - **泛型实现**：`impl&lt;T&gt; Trait for Vec&lt;T&gt;` - 适用于所有 `T`\n   - **具体实现**：`impl Trait for Vec&lt;String&gt;` - 只适用于特定类型\n\n4. **孤儿规则必须遵守**\n   - trait 或类型至少有一个在本 crate 中定义\n   - 防止不同 crate 之间的实现冲突\n\n5. **类型安全的保证**\n   - 为 `Vec&lt;String&gt;` 实现的 trait 不会影响 `Vec&lt;i32&gt;`\n   - 每个具体类型都是独立的，编译器会严格检查\n\n### 实践建议\n\n- **优先使用泛型实现**：如果 trait 方法适用于所有 `T`，使用 `impl&lt;T&gt; Trait for Vec&lt;T&gt;`\n- **针对性优化时使用具体实现**：当需要使用特定类型的方法时，为具体类型实现 trait\n- **遵守孤儿规则**：确保 trait 或类型至少有一个在本 crate 中定义\n- **类型约束清晰**：使用具体实现可以获得更好的类型安全和代码可读性\n\n### 延伸阅读\n\n- [The Rust Programming Language - Traits](https://doc.rust-lang.org/book/ch10-02-traits.html)\n- [Rust Reference - Trait Implementation](https://doc.rust-lang.org/reference/items/implementations.html)\n- [RFC 1210 - Specialization](https://rust-lang.github.io/rfcs/1210-impl-specialization.html)\n\n希望这篇文章能帮助你更好地理解 Rust 的 trait 系统。记住：**类型特化让 Rust 的类型系统既灵活又安全**，善用这一特性可以写出更优雅的代码！\n\n---\n\n**最后提醒：** 这篇笔记记录了一个初学时容易混淆的概念。如果你也在学习 Rust，建议动手实践这些示例代码，加深理解。类型系统是 Rust 最强大的特性之一，值得深入学习！&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Rust-Trait-为泛型类型的具体实例实现特征.md&quot;],&quot;digest&quot;:[0,&quot;cf3e3092d3e4c992&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h2 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;在学习 Rust 的 trait 系统时，我遇到了一个有趣的问题：&lt;strong&gt;为什么可以为 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 这样的泛型类型的具体实例实现 trait？&lt;/strong&gt; 这似乎与我们通常理解的”只能为结构体实现 trait”的观念不太一致。本文将深入探讨这个问题，帮助你更好地理解 Rust 的类型系统。&lt;/p&gt;\n&lt;h2 id=\&quot;问题的由来\&quot;&gt;问题的由来&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#问题的由来\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;假设我们定义了一个简单的 trait：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;然后，我们可以这样为 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 实现这个 trait：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;push&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Bar\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这段代码完全合法且能正常工作：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; my_vec&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Foo\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Baz\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    ];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    my_vec&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, my_vec); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: [\&quot;Foo\&quot;, \&quot;Baz\&quot;, \&quot;Bar\&quot;]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;但问题来了：&lt;strong&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 不是一个结构体，而是泛型类型 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 的一个具体实例，为什么可以为它实现 trait？&lt;/strong&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;核心概念类型特化type-specialization\&quot;&gt;核心概念：类型特化（Type Specialization）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#核心概念类型特化type-specialization\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;什么是类型特化\&quot;&gt;什么是类型特化？&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#什么是类型特化\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在 Rust 中，&lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 是一个&lt;strong&gt;泛型类型&lt;/strong&gt;，其中 &lt;code&gt;T&lt;/code&gt; 是类型参数。当我们指定 &lt;code&gt;T = String&lt;/code&gt; 时，&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 就成为了一个&lt;strong&gt;具体类型&lt;/strong&gt;（Concrete Type），这个过程被称为&lt;strong&gt;类型特化&lt;/strong&gt;。&lt;/p&gt;\n&lt;p&gt;从 Rust 编译器的角度来看：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 是一个&lt;strong&gt;类型构造器&lt;/strong&gt;（Type Constructor），需要一个类型参数才能成为完整的类型&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 是一个&lt;strong&gt;完整的具体类型&lt;/strong&gt;，和 &lt;code&gt;i32&lt;/code&gt;、&lt;code&gt;String&lt;/code&gt; 等具有同等地位&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;类型特化的实例\&quot;&gt;类型特化的实例&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#类型特化的实例\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 这些都是不同的具体类型&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; v1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; v2&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; v3&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;], &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;4&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;]];&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;在 Rust 的类型系统中，&lt;code&gt;Vec&amp;#x3C;i32&gt;&lt;/code&gt;、&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 和 &lt;code&gt;Vec&amp;#x3C;Vec&amp;#x3C;u8&gt;&gt;&lt;/code&gt; 是&lt;strong&gt;三个完全不同的类型&lt;/strong&gt;，就像 &lt;code&gt;Dog&lt;/code&gt; 和 &lt;code&gt;Cat&lt;/code&gt; 是两个不同的结构体一样。&lt;/p&gt;\n&lt;h2 id=\&quot;trait-实现的灵活性\&quot;&gt;Trait 实现的灵活性&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#trait-实现的灵活性\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 的 trait 系统允许你为&lt;strong&gt;任何具体类型&lt;/strong&gt;实现 trait，不仅仅是结构体。这包括：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;自定义结构体&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;枚举类型&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;泛型类型的具体实例&lt;/strong&gt;（如 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt;）&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;基本类型&lt;/strong&gt;（如 &lt;code&gt;i32&lt;/code&gt;，但需要遵循孤儿规则）&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;元组类型&lt;/strong&gt;（如 &lt;code&gt;(i32, String)&lt;/code&gt;）&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;示例-1为不同的-vec-实例实现不同的-trait\&quot;&gt;示例 1：为不同的 Vec 实例实现不同的 trait&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#示例-1为不同的-vec-实例实现不同的-trait\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBaz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_baz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为 Vec&amp;#x3C;String&gt; 实现 AppendBar&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;push&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Bar\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为 Vec&amp;#x3C;i32&gt; 实现 AppendBaz&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBaz&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_baz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;push&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;42&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Foo\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 可以调用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // strings.append_baz(); // ❌ 编译错误：Vec&amp;#x3C;String&gt; 没有实现 AppendBaz&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    numbers&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;append_baz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 可以调用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // numbers.append_bar(); // ❌ 编译错误：Vec&amp;#x3C;i32&gt; 没有实现 AppendBar&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;示例-2为元组类型实现-trait\&quot;&gt;示例 2：为元组类型实现 trait&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#示例-2为元组类型实现-trait\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Describable&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; describe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为 (i32, String) 元组实现 trait&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Describable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; describe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Number: {}, Text: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; tuple &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;42&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, tuple&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;describe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: Number: 42, Text: Hello&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;泛型实现-vs-具体实现\&quot;&gt;泛型实现 vs 具体实现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#泛型实现-vs-具体实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 允许你选择不同的实现策略：&lt;/p&gt;\n&lt;h3 id=\&quot;策略-1为所有-vect-实现泛型实现\&quot;&gt;策略 1：为所有 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 实现（泛型实现）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#策略-1为所有-vect-实现泛型实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Printable&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为所有 Vec&amp;#x3C;T&gt; 实现，其中 T 必须实现 Debug trait&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Debug&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Printable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; item &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;            println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, item);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Foo\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Bar\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 可以使用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    numbers&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 也可以使用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;特点：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;为所有满足约束的 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 实现 trait&lt;/li&gt;\n&lt;li&gt;trait 方法必须对所有可能的 &lt;code&gt;T&lt;/code&gt; 都有效&lt;/li&gt;\n&lt;li&gt;实现代码只写一次，适用于多种类型&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;策略-2为特定的-vect-实现具体实现\&quot;&gt;策略 2：为特定的 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 实现（具体实现）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#策略-2为特定的-vect-实现具体实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; StringOperations&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_uppercase_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; concat_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 仅为 Vec&amp;#x3C;String&gt; 实现&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; StringOperations&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_uppercase_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter_mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            *&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_uppercase&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; concat_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;join&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;, \&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;world\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_uppercase_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;concat_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: HELLO, WORLD&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let mut numbers = vec![1, 2, 3];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // numbers.to_uppercase_all(); // ❌ 编译错误：Vec&amp;#x3C;i32&gt; 没有实现 StringOperations&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;特点：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;只为特定的 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 实现&lt;/li&gt;\n&lt;li&gt;可以使用 &lt;code&gt;String&lt;/code&gt; 特有的方法（如 &lt;code&gt;to_uppercase()&lt;/code&gt;）&lt;/li&gt;\n&lt;li&gt;实现更有针对性，类型更安全&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;实际应用场景\&quot;&gt;实际应用场景&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实际应用场景\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;场景-1为标准库类型添加自定义功能\&quot;&gt;场景 1：为标准库类型添加自定义功能&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-1为标准库类型添加自定义功能\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Statistics&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; mean&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; median&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Statistics&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; mean&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        if&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;is_empty&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            return&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;sum&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;as&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; median&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        if&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;is_empty&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            return&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;clone&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        sorted&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;sort_by&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;a, b&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;partial_cmp&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;unwrap&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; mid &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 2&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; ==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            (sorted[mid &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;] &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted[mid]) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 2.0&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            sorted[mid]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; data &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;4.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Mean: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;mean&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: Mean: 3&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Median: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;median&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: Median: 3&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;场景-2实现特定领域的类型约束\&quot;&gt;场景 2：实现特定领域的类型约束&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-2实现特定领域的类型约束\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; JsonSerializable&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为字符串数组实现 JSON 序列化&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; JsonSerializable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;map&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;\\\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;{}&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;\\\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, s))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;collect&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;[{}]\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;join&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;, \&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为数字数组实现 JSON 序列化&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; JsonSerializable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;map&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;collect&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;[{}]\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;join&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;, \&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;world\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: [\&quot;hello\&quot;, \&quot;world\&quot;]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, numbers&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: [1, 2, 3]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;孤儿规则orphan-rule\&quot;&gt;孤儿规则（Orphan Rule）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#孤儿规则orphan-rule\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;虽然可以为泛型类型的具体实例实现 trait，但必须遵守 Rust 的&lt;strong&gt;孤儿规则&lt;/strong&gt;：&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;&lt;strong&gt;至少 trait 或类型其中之一必须在当前 crate 中定义。&lt;/strong&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h3 id=\&quot;合法的实现\&quot;&gt;合法的实现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#合法的实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 情况 1：trait 在本 crate 中定义&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyTrait&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; do_something&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Vec 虽然是标准库的，但 MyTrait 是我们定义的&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyTrait&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; do_something&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Doing something with {} strings\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 情况 2：类型在本 crate 中定义&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;struct&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyType&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Display 虽然是标准库的，但 MyType 是我们定义的&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Display&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyType&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; fmt&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, f&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Formatter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;_&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Result&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        write!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(f, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;MyType with {} elements\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;非法的实现\&quot;&gt;非法的实现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#非法的实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ❌ 错误：trait 和类型都不在本 crate 中&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// impl std::fmt::Display for Vec&amp;#x3C;String&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;//     fn fmt(&amp;#x26;self, f: &amp;#x26;mut std::fmt::Formatter&amp;#x3C;&#39;_&gt;) -&gt; std::fmt::Result {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;//         write!(f, \&quot;Custom Vec Display\&quot;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;//     }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 编译错误：只有在本地 crate 定义的 trait 才能为外部类型实现&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;特化specialization的未来\&quot;&gt;特化（Specialization）的未来&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#特化specialization的未来\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 正在开发一个更强大的特性：&lt;strong&gt;trait 特化（Trait Specialization）&lt;/strong&gt;，它允许你先为泛型类型实现 trait，然后为特定实例提供更优化的实现。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;#![feature(specialization)] &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 需要 nightly Rust&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 默认实现：适用于所有 Vec&amp;#x3C;T&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Process&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    default &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Processing {} items (generic)\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 特化实现：针对 Vec&amp;#x3C;String&gt; 的优化版本&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Process&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Processing {} strings (specialized)\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;            println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;  - {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, s);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;注意：这个特性目前还在实验阶段，仅在 nightly Rust 中可用。&lt;/p&gt;\n&lt;h2 id=\&quot;总结\&quot;&gt;总结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#总结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;关键要点\&quot;&gt;关键要点&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#关键要点\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 是一个完整的具体类型&lt;/strong&gt;，不是泛型类型&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 是泛型类型（类型构造器）&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 是具体类型（&lt;code&gt;T&lt;/code&gt; 被特化为 &lt;code&gt;String&lt;/code&gt;）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Rust 允许为任何具体类型实现 trait&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;结构体、枚举&lt;/li&gt;\n&lt;li&gt;泛型类型的具体实例（如 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt;）&lt;/li&gt;\n&lt;li&gt;基本类型、元组等&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;实现策略的选择&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;泛型实现&lt;/strong&gt;：&lt;code&gt;impl&amp;#x3C;T&gt; Trait for Vec&amp;#x3C;T&gt;&lt;/code&gt; - 适用于所有 &lt;code&gt;T&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;具体实现&lt;/strong&gt;：&lt;code&gt;impl Trait for Vec&amp;#x3C;String&gt;&lt;/code&gt; - 只适用于特定类型&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;孤儿规则必须遵守&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;trait 或类型至少有一个在本 crate 中定义&lt;/li&gt;\n&lt;li&gt;防止不同 crate 之间的实现冲突&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;类型安全的保证&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;为 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 实现的 trait 不会影响 &lt;code&gt;Vec&amp;#x3C;i32&gt;&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;每个具体类型都是独立的，编译器会严格检查&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;实践建议\&quot;&gt;实践建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实践建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;优先使用泛型实现&lt;/strong&gt;：如果 trait 方法适用于所有 &lt;code&gt;T&lt;/code&gt;，使用 &lt;code&gt;impl&amp;#x3C;T&gt; Trait for Vec&amp;#x3C;T&gt;&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;针对性优化时使用具体实现&lt;/strong&gt;：当需要使用特定类型的方法时，为具体类型实现 trait&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;遵守孤儿规则&lt;/strong&gt;：确保 trait 或类型至少有一个在本 crate 中定义&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;类型约束清晰&lt;/strong&gt;：使用具体实现可以获得更好的类型安全和代码可读性&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;延伸阅读\&quot;&gt;延伸阅读&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#延伸阅读\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/book/ch10-02-traits.html\&quot;&gt;The Rust Programming Language - Traits&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/reference/items/implementations.html\&quot;&gt;Rust Reference - Trait Implementation&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://rust-lang.github.io/rfcs/1210-impl-specialization.html\&quot;&gt;RFC 1210 - Specialization&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;希望这篇文章能帮助你更好地理解 Rust 的 trait 系统。记住：&lt;strong&gt;类型特化让 Rust 的类型系统既灵活又安全&lt;/strong&gt;，善用这一特性可以写出更优雅的代码！&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;最后提醒：&lt;/strong&gt; 这篇笔记记录了一个初学时容易混淆的概念。如果你也在学习 Rust，建议动手实践这些示例代码，加深理解。类型系统是 Rust 最强大的特性之一，值得深入学习！&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;问题的由来&quot;],&quot;text&quot;:[0,&quot;问题的由来&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;核心概念类型特化type-specialization&quot;],&quot;text&quot;:[0,&quot;核心概念：类型特化（Type Specialization）&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;什么是类型特化&quot;],&quot;text&quot;:[0,&quot;什么是类型特化？&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;类型特化的实例&quot;],&quot;text&quot;:[0,&quot;类型特化的实例&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;trait-实现的灵活性&quot;],&quot;text&quot;:[0,&quot;Trait 实现的灵活性&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;示例-1为不同的-vec-实例实现不同的-trait&quot;],&quot;text&quot;:[0,&quot;示例 1：为不同的 Vec 实例实现不同的 trait&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;示例-2为元组类型实现-trait&quot;],&quot;text&quot;:[0,&quot;示例 2：为元组类型实现 trait&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;泛型实现-vs-具体实现&quot;],&quot;text&quot;:[0,&quot;泛型实现 vs 具体实现&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;策略-1为所有-vect-实现泛型实现&quot;],&quot;text&quot;:[0,&quot;策略 1：为所有 Vec&lt;T&gt; 实现（泛型实现）&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;策略-2为特定的-vect-实现具体实现&quot;],&quot;text&quot;:[0,&quot;策略 2：为特定的 Vec&lt;T&gt; 实现（具体实现）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;实际应用场景&quot;],&quot;text&quot;:[0,&quot;实际应用场景&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-1为标准库类型添加自定义功能&quot;],&quot;text&quot;:[0,&quot;场景 1：为标准库类型添加自定义功能&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-2实现特定领域的类型约束&quot;],&quot;text&quot;:[0,&quot;场景 2：实现特定领域的类型约束&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;孤儿规则orphan-rule&quot;],&quot;text&quot;:[0,&quot;孤儿规则（Orphan Rule）&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;合法的实现&quot;],&quot;text&quot;:[0,&quot;合法的实现&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;非法的实现&quot;],&quot;text&quot;:[0,&quot;非法的实现&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;特化specialization的未来&quot;],&quot;text&quot;:[0,&quot;特化（Specialization）的未来&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;总结&quot;],&quot;text&quot;:[0,&quot;总结&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;关键要点&quot;],&quot;text&quot;:[0,&quot;关键要点&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;实践建议&quot;],&quot;text&quot;:[0,&quot;实践建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;延伸阅读&quot;],&quot;text&quot;:[0,&quot;延伸阅读&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Rust Trait：为泛型类型的具体实例实现特征&quot;],&quot;date&quot;:[3,&quot;2025-11-25T10:30:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;Trait&quot;],[0,&quot;泛型&quot;],[0,&quot;类型系统&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;],&quot;description&quot;:[0,&quot;深入理解 Rust 中 trait 实现的灵活性：为什么可以为 Vec&lt;String&gt; 这样的泛型类型具体实例实现 trait？探讨 Rust 类型系统中的类型特化（Type Specialization）、trait 实现的作用范围，以及如何利用这一特性编写更灵活的代码。&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/18&quot;]}]]],&quot;currentPostSlug&quot;:[0,&quot;rust引用生命周期-不只是切片&quot;],&quot;data-astro-cid-nxumbhks&quot;:[0,true]}" ssr client="load" opts="{&quot;name&quot;:&quot;SeriesPostList&quot;,&quot;value&quot;:true}" await-children><div class="flex flex-col gap-1"><a href="/blog/post/20" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Rust 算术运算的 Panic 陷阱：从取模零说起</span></a><a href="/blog/post/19" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50 text-primary font-medium"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-primary"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-primary">Rust 引用生命周期：不只是切片</span></a><a href="/blog/post/18" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Rust Trait：为泛型类型的具体实例实现特征</span></a></div><!--astro:end--></astro-island> </div> </sider-content> <!-- 内联脚本：在 DOM 解析后立即隐藏不需要的内容，避免闪烁 --> <script data-astro-rerun>
    (function () {
      const container = document.querySelector('sider-content');
      ;
      if (!container) return;

      const defaultType = container.getAttribute('data-default-type') || 'info';
      ;
      const slots = container.querySelectorAll('.sider-slot');
      ;

      slots.forEach((slot) => {
        const slotType = slot.getAttribute('data-slot-type');
        ;
        if (slotType !== defaultType) {
          slot.classList.add('hidden');
        }
      });
    })();
  </script> <astro-island uid="ZaW5Gv" prefix="r13" component-url="/_astro/SeriesNavigation.BuYCsLkT.js" component-export="SeriesNavigation" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;prevPost&quot;:[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;rust算术运算的panic陷阱-从取模零说起&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Rust 算术运算的 Panic 陷阱：从取模零说起&quot;],&quot;description&quot;:[0,&quot;在刷 Rust 算法题时发现了一个独特现象：对零取模会直接导致程序 panic！这与其他语言的行为截然不同。本文深入探讨 Rust 中会导致 panic 的算术运算场景，包括除零、整数溢出、INT_MIN/-1 等特殊情况，以及 Rust 提供的 checked_、wrapping_、saturating_ 等安全替代方案。理解这些行为对于编写健壮的 Rust 程序至关重要。&quot;],&quot;date&quot;:[3,&quot;2025-12-02T10:00:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;算法&quot;],[0,&quot;安全&quot;],[0,&quot;Panic&quot;],[0,&quot;算术运算&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;]}],&quot;body&quot;:[0,&quot;## 前言\n\n今天在刷 Rust 算法题时，遇到了一个让我印象深刻的情况：**当我尝试对 0 取模时，程序直接 panic 了！**\n\n```rust\nfn main() {\n    let x = 10;\n    let y = 0;\n    let result = x % y;  // 💥 thread &#39;main&#39; panicked at &#39;attempt to calculate the remainder with a divisor of zero&#39;\n}\n```\n\n这个行为在其他语言中并不常见。比如在 JavaScript 中，`10 % 0` 会返回 `NaN`；在 Python 中会抛出 `ZeroDivisionError` 异常（可以被捕获）。而 **Rust 选择直接 panic，整个程序崩溃，无法通过普通的错误处理机制捕获**。\n\n这引发了我的好奇：Rust 中还有哪些类似的\&quot;地雷\&quot;？让我们一探究竟。\n\n## Rust 中会导致 Panic 的算术运算\n\n### 1. 除法和取模运算的零除错误\n\n在 Rust 中，**整数的除法和取模运算遇到零除数时会无条件 panic**：\n\n```rust\nfn main() {\n    let a = 10;\n    let b = 0;\n\n    // 💥 除法遇到零：panic!\n    // let div = a / b;\n\n    // 💥 取模遇到零：panic!\n    // let rem = a % b;\n\n    println!(\&quot;这行代码永远不会执行\&quot;);\n}\n```\n\n**为什么会这样？**\n\nRust 的设计哲学是：**宁可 panic 也不产生未定义行为（Undefined Behavior, UB）**。在很多底层语言（如 C/C++）中，除以零会导致 UB，这可能造成：\n- 程序段错误（Segmentation Fault）\n- 返回垃圾值\n- 安全漏洞\n\nRust 通过显式 panic 来避免这些不可预测的行为，让错误在第一时间暴露出来。\n\n**浮点数例外**\n\n有趣的是，**浮点数的除零操作不会 panic**，而是遵循 IEEE 754 标准：\n\n```rust\nfn main() {\n    let x = 10.0;\n    let y = 0.0;\n\n    println!(\&quot;{}\&quot;, x / y);      // ✅ inf (正无穷)\n    println!(\&quot;{}\&quot;, -x / y);     // ✅ -inf (负无穷)\n    println!(\&quot;{}\&quot;, y / y);      // ✅ NaN (Not a Number)\n\n    // 浮点数取模也不会 panic，但会返回 NaN\n    println!(\&quot;{}\&quot;, x % y);      // ✅ NaN\n}\n```\n\n### 2. 整数溢出的特殊边界情况\n\n还有一个更隐蔽的陷阱：**`INT_MIN / -1` 和 `INT_MIN % -1` 也会 panic**！\n\n```rust\nfn main() {\n    let min = i8::MIN;  // -128\n    let divisor = -1;\n\n    // 💥 这会 panic！\n    // let result = min / divisor;\n\n    // 💥 这也会 panic！\n    // let remainder = min % divisor;\n}\n```\n\n**为什么？**\n\n对于 8 位有符号整数 `i8`：\n- 最小值：`i8::MIN = -128`\n- 最大值：`i8::MAX = 127`\n\n当我们计算 `-128 / -1` 时，数学结果应该是 `128`，但这**超出了 `i8` 的表示范围**（最大只能到 127），导致溢出。Rust 选择 panic 而不是返回错误的结果。\n\n```rust\nfn demonstrate_overflow() {\n    // 对于不同的整数类型，都存在这个问题\n    println!(\&quot;i8::MIN  / -1 会 panic: {}\&quot;, i8::MIN);   // -128 / -1 = 128 (溢出!)\n    println!(\&quot;i16::MIN / -1 会 panic: {}\&quot;, i16::MIN);  // -32768 / -1 = 32768 (溢出!)\n    println!(\&quot;i32::MIN / -1 会 panic: {}\&quot;, i32::MIN);  // -2147483648 / -1 = 2147483648 (溢出!)\n    println!(\&quot;i64::MIN / -1 会 panic: {}\&quot;, i64::MIN);  // 同理\n}\n```\n\n### 3. Debug 模式下的整数溢出\n\nRust 在 **debug 模式和 release 模式下对整数溢出的处理不同**：\n\n```rust\nfn main() {\n    let max = u8::MAX;  // 255\n\n    // Debug 模式：💥 panic!\n    // Release 模式：✅ 环绕到 0 (wrapping)\n    let result = max + 1;\n\n    println!(\&quot;Result: {}\&quot;, result);\n}\n```\n\n**行为差异：**\n\n| 模式 | 溢出行为 | 原因 |\n|------|----------|------|\n| **Debug** (`cargo build`) | Panic | 帮助开发者尽早发现 bug |\n| **Release** (`cargo build --release`) | 二进制补码环绕 | 性能优化，避免运行时检查开销 |\n\n在 release 模式下：\n```rust\nu8::MAX + 1      // =&gt; 0   (255 + 1 环绕为 0)\nu8::MIN - 1      // =&gt; 255 (0 - 1 环绕为 255)\ni8::MAX + 1      // =&gt; -128 (127 + 1 环绕为 -128)\n```\n\n这意味着：**同样的代码在不同编译模式下可能有完全不同的行为！**\n\n## Rust 的解决方案：显式的溢出处理\n\n为了让开发者能够精确控制溢出行为，Rust 提供了多种方法变体：\n\n### 1. `checked_*` 系列：安全检查，返回 Option\n\n```rust\nfn safe_division(a: i32, b: i32) -&gt; Option&lt;i32&gt; {\n    a.checked_div(b)\n}\n\nfn main() {\n    println!(\&quot;{:?}\&quot;, 10.checked_div(2));   // Some(5)\n    println!(\&quot;{:?}\&quot;, 10.checked_div(0));   // None - 零除返回 None 而不是 panic\n    println!(\&quot;{:?}\&quot;, i32::MIN.checked_div(-1)); // None - 溢出返回 None\n\n    // 其他 checked 方法\n    println!(\&quot;{:?}\&quot;, 255u8.checked_add(1));     // None\n    println!(\&quot;{:?}\&quot;, 0u8.checked_sub(1));       // None\n    println!(\&quot;{:?}\&quot;, 128i8.checked_mul(2));     // None\n    println!(\&quot;{:?}\&quot;, 10.checked_rem(0));        // None - 取模零也返回 None\n}\n```\n\n**适用场景：**\n- 用户输入处理\n- 外部数据验证\n- 需要优雅处理错误的场景\n\n### 2. `wrapping_*` 系列：显式环绕行为\n\n```rust\nfn main() {\n    // 无论 debug 还是 release 模式，都保证环绕行为\n    println!(\&quot;{}\&quot;, 255u8.wrapping_add(1));      // 0\n    println!(\&quot;{}\&quot;, 0u8.wrapping_sub(1));        // 255\n    println!(\&quot;{}\&quot;, 200u8.wrapping_mul(2));      // 144 (400 % 256)\n\n    // 环绕除法：零除仍然会 panic！\n    // println!(\&quot;{}\&quot;, 10.wrapping_div(0));  // 💥 仍然 panic\n\n    // 但 INT_MIN / -1 会环绕而不是 panic\n    println!(\&quot;{}\&quot;, i8::MIN.wrapping_div(-1));   // -128 (环绕到自身)\n}\n```\n\n**适用场景：**\n- 哈希计算\n- 密码学算法\n- 需要明确的模运算语义\n\n### 3. `saturating_*` 系列：饱和到边界值\n\n```rust\nfn main() {\n    // 溢出时返回类型的最大/最小值\n    println!(\&quot;{}\&quot;, 255u8.saturating_add(1));    // 255 (不超过最大值)\n    println!(\&quot;{}\&quot;, 0u8.saturating_sub(1));      // 0   (不低于最小值)\n    println!(\&quot;{}\&quot;, 200u8.saturating_mul(2));    // 255 (饱和到最大值)\n\n    // 有符号整数\n    println!(\&quot;{}\&quot;, 127i8.saturating_add(1));    // 127\n    println!(\&quot;{}\&quot;, (-128i8).saturating_sub(1)); // -128\n\n    // 除法仍然对零除 panic\n    // println!(\&quot;{}\&quot;, 10.saturating_div(0));  // 💥 panic\n}\n```\n\n**适用场景：**\n- 音频/视频处理（音量、亮度限制）\n- 游戏开发（生命值、伤害计算）\n- UI 组件（滚动位置、进度条）\n\n### 4. `overflowing_*` 系列：返回结果和溢出标志\n\n```rust\nfn main() {\n    let (result, overflowed) = 255u8.overflowing_add(1);\n    println!(\&quot;Result: {}, Overflowed: {}\&quot;, result, overflowed);\n    // Result: 0, Overflowed: true\n\n    let (result, overflowed) = 100u8.overflowing_add(50);\n    println!(\&quot;Result: {}, Overflowed: {}\&quot;, result, overflowed);\n    // Result: 150, Overflowed: false\n\n    // 可以用来实现自定义的溢出处理逻辑\n    let (div, overflow) = i8::MIN.overflowing_div(-1);\n    println!(\&quot;Division: {}, Overflow: {}\&quot;, div, overflow);\n    // Division: -128, Overflow: true\n}\n```\n\n**适用场景：**\n- 需要记录溢出事件\n- 实现自定义的错误报告\n- 性能敏感但需要溢出信息的代码\n\n### 5. `strict_*` 系列：总是 Panic（Rust 1.80+）\n\n```rust\nfn main() {\n    // 无论 debug 还是 release，溢出总是 panic\n    // let result = 255u8.strict_add(1);  // 💥 panic in both debug and release\n\n    // 这对于需要严格保证数学正确性的场景很有用\n}\n```\n\n**适用场景：**\n- 金融计算\n- 科学计算\n- 任何不能容忍静默溢出的场景\n\n## 完整的除零安全处理示例\n\n结合上面的知识，我们可以写一个安全的计算器函数：\n\n```rust\n#[derive(Debug, PartialEq)]\nenum CalcError {\n    DivisionByZero,\n    Overflow,\n}\n\nfn safe_calculator(a: i32, b: i32, op: char) -&gt; Result&lt;i32, CalcError&gt; {\n    match op {\n        &#39;+&#39; =&gt; a.checked_add(b).ok_or(CalcError::Overflow),\n        &#39;-&#39; =&gt; a.checked_sub(b).ok_or(CalcError::Overflow),\n        &#39;*&#39; =&gt; a.checked_mul(b).ok_or(CalcError::Overflow),\n        &#39;/&#39; =&gt; {\n            if b == 0 {\n                Err(CalcError::DivisionByZero)\n            } else {\n                a.checked_div(b).ok_or(CalcError::Overflow)\n            }\n        }\n        &#39;%&#39; =&gt; {\n            if b == 0 {\n                Err(CalcError::DivisionByZero)\n            } else {\n                a.checked_rem(b).ok_or(CalcError::Overflow)\n            }\n        }\n        _ =&gt; panic!(\&quot;Unsupported operation\&quot;),\n    }\n}\n\nfn main() {\n    println!(\&quot;{:?}\&quot;, safe_calculator(10, 2, &#39;/&#39;));   // Ok(5)\n    println!(\&quot;{:?}\&quot;, safe_calculator(10, 0, &#39;/&#39;));   // Err(DivisionByZero)\n    println!(\&quot;{:?}\&quot;, safe_calculator(10, 0, &#39;%&#39;));   // Err(DivisionByZero)\n    println!(\&quot;{:?}\&quot;, safe_calculator(i32::MAX, 1, &#39;+&#39;)); // Err(Overflow)\n    println!(\&quot;{:?}\&quot;, safe_calculator(i32::MIN, -1, &#39;/&#39;)); // Err(Overflow)\n}\n```\n\n## Rust vs 其他语言\n\n让我们对比一下不同语言对除零的处理：\n\n| 语言 | `10 / 0` 行为 | `10 % 0` 行为 | 可捕获？ |\n|------|---------------|---------------|----------|\n| **Rust** | Panic（程序崩溃） | Panic（程序崩溃） | ❌ 不可用 try-catch 捕获 |\n| **Python** | 抛出 `ZeroDivisionError` | 抛出 `ZeroDivisionError` | ✅ 可用 try-except 捕获 |\n| **JavaScript** | `Infinity` | `NaN` | ✅ 不抛出异常，返回特殊值 |\n| **Java** | 抛出 `ArithmeticException` | 抛出 `ArithmeticException` | ✅ 可用 try-catch 捕获 |\n| **C/C++** | 未定义行为（UB） | 未定义行为（UB） | ❌ 无标准异常机制 |\n| **Go** | Panic | Panic | ⚠️ 可用 recover 捕获（不推荐） |\n\n**Rust 的设计权衡：**\n\n1. **不使用异常机制**：Rust 没有 try-catch 异常系统，这避免了隐藏的控制流和性能开销\n2. **强制显式处理**：通过 `checked_*` 等方法，强制开发者在可能出错的地方显式处理\n3. **Panic 是最后手段**：Panic 用于\&quot;不可恢复的错误\&quot;，而零除被认为是编程错误而非业务逻辑错误\n\n## 实战建议\n\n### 1. 算法题中的处理\n\n在刷算法题时，可以这样处理：\n\n```rust\n// ❌ 危险：可能 panic\nfn solve_naive(n: i32, m: i32) -&gt; i32 {\n    (n * n) % m  // 如果 m 为 0，直接崩溃\n}\n\n// ✅ 安全：添加前置检查\nfn solve_safe(n: i32, m: i32) -&gt; Option&lt;i32&gt; {\n    if m == 0 {\n        return None;\n    }\n    Some((n * n) % m)\n}\n\n// ✅ 更好：使用 checked 方法\nfn solve_better(n: i32, m: i32) -&gt; Option&lt;i32&gt; {\n    n.checked_mul(n)?.checked_rem(m)\n}\n```\n\n### 2. 生产代码的建议\n\n```rust\n// 对于用户输入，总是使用 checked_* 方法\nfn process_user_input(dividend: i32, divisor: i32) -&gt; Result&lt;i32, String&gt; {\n    dividend\n        .checked_div(divisor)\n        .ok_or_else(|| {\n            if divisor == 0 {\n                \&quot;除数不能为零\&quot;.to_string()\n            } else {\n                \&quot;计算溢出\&quot;.to_string()\n            }\n        })\n}\n\n// 对于性能敏感且确定不会溢出的代码，可以使用普通运算符\nfn fast_index_calculation(base: usize, offset: usize, size: usize) -&gt; usize {\n    // 假设已经在外层保证了不会溢出\n    (base + offset) % size\n}\n\n// 对于需要环绕语义的场景，明确使用 wrapping_*\nfn hash_combine(hash1: u64, hash2: u64) -&gt; u64 {\n    hash1.wrapping_add(hash2).wrapping_mul(0x9e3779b97f4a7c15)\n}\n```\n\n### 3. 测试建议\n\n```rust\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    #[should_panic(expected = \&quot;divide by zero\&quot;)]\n    fn test_division_by_zero_panics() {\n        let _ = 10 / 0;\n    }\n\n    #[test]\n    #[should_panic(expected = \&quot;remainder\&quot;)]\n    fn test_modulo_by_zero_panics() {\n        let _ = 10 % 0;\n    }\n\n    #[test]\n    fn test_safe_division() {\n        assert_eq!(10.checked_div(2), Some(5));\n        assert_eq!(10.checked_div(0), None);\n        assert_eq!(i32::MIN.checked_div(-1), None);\n    }\n}\n```\n\n## 总结\n\n### 关键要点\n\n1. **Rust 中会导致 panic 的算术运算：**\n   - `a / 0` 和 `a % 0`（整数）\n   - `INT_MIN / -1` 和 `INT_MIN % -1`\n   - Debug 模式下的整数溢出\n\n2. **浮点数例外：**\n   - `f32/f64` 的除零不会 panic，返回 `Infinity` 或 `NaN`\n\n3. **Debug vs Release 的差异：**\n   - Debug：溢出 panic，帮助调试\n   - Release：溢出环绕，优化性能\n   - 使用 `checked_*` 等方法可以统一行为\n\n4. **Rust 的解决方案：**\n   - `checked_*`：安全检查，返回 `Option&lt;T&gt;`\n   - `wrapping_*`：显式环绕\n   - `saturating_*`：饱和到边界\n   - `overflowing_*`：返回结果和溢出标志\n   - `strict_*`：总是 panic（Rust 1.80+）\n\n5. **设计哲学：**\n   - 避免未定义行为\n   - 强制显式处理\n   - Panic 用于不可恢复的编程错误\n\n### 实践建议\n\n- ✅ **用户输入和外部数据**：总是使用 `checked_*` 方法\n- ✅ **算法题**：添加边界检查或使用 `checked_*`\n- ✅ **性能关键路径**：如果确定安全，可以用普通运算符，但要有充分的注释说明\n- ✅ **需要环绕语义**：明确使用 `wrapping_*`\n- ✅ **测试**：为边界情况编写测试，包括 panic 测试\n\n### 延伸阅读\n\n- [Rust RFC 560 - Integer Overflow](https://rust-lang.github.io/rfcs/0560-integer-overflow.html)\n- [Myths and Legends about Integer Overflow in Rust](https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/)\n- [Rust Documentation - Div trait](https://doc.rust-lang.org/std/ops/trait.Div.html)\n- [Behavior not considered unsafe - Rust Reference](https://doc.rust-lang.org/reference/behavior-not-considered-unsafe.html)\n- [Exploring Rust&#39;s Overflow Behavior - Sling Academy](https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/)\n\n---\n\n**最后提醒：** 这些行为不是 bug，而是 Rust 为了安全性做出的有意设计。理解这些特性，才能写出既安全又高效的 Rust 代码。下次刷算法题时，记得留意除法和取模操作，不要让你的解答因为一个 `% 0` 而崩溃！\n\n写到这里，我想起了前一个月的 cloudflare的unwarp 造成的panic!。真的很好笑。\n\n一定要注意rust一切可能引起panic!的可能性，才不会像cloudflare的unwarp方法一样，搞出的几十亿美金的全球网站崩溃漏洞。\n\nSources:\n- [Rust RFC 560 - Integer Overflow](https://rust-lang.github.io/rfcs/0560-integer-overflow.html)\n- [Myths and Legends about Integer Overflow in Rust](https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/)\n- [What happens in Rust programming language when an integer arithmetic operation overflows? - Stack Overflow](https://stackoverflow.com/questions/68807024/what-happens-in-rust-programming-language-when-an-integer-arithmetic-operation-o)\n- [Exploring Rust&#39;s Overflow Behavior: Wrapping, Saturating, and Panicking - Sling Academy](https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/)\n- [Div in std::ops - Rust](https://doc.rust-lang.org/std/ops/trait.Div.html)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Rust算术运算的Panic陷阱-从取模零说起.md&quot;],&quot;digest&quot;:[0,&quot;a24451f5fe38d184&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h2 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;今天在刷 Rust 算法题时，遇到了一个让我印象深刻的情况：&lt;strong&gt;当我尝试对 0 取模时，程序直接 panic 了！&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; result &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y;  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 💥 thread &#39;main&#39; panicked at &#39;attempt to calculate the remainder with a divisor of zero&#39;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这个行为在其他语言中并不常见。比如在 JavaScript 中，&lt;code&gt;10 % 0&lt;/code&gt; 会返回 &lt;code&gt;NaN&lt;/code&gt;；在 Python 中会抛出 &lt;code&gt;ZeroDivisionError&lt;/code&gt; 异常（可以被捕获）。而 &lt;strong&gt;Rust 选择直接 panic，整个程序崩溃，无法通过普通的错误处理机制捕获&lt;/strong&gt;。&lt;/p&gt;\n&lt;p&gt;这引发了我的好奇：Rust 中还有哪些类似的”地雷”？让我们一探究竟。&lt;/p&gt;\n&lt;h2 id=\&quot;rust-中会导致-panic-的算术运算\&quot;&gt;Rust 中会导致 Panic 的算术运算&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#rust-中会导致-panic-的算术运算\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;1-除法和取模运算的零除错误\&quot;&gt;1. 除法和取模运算的零除错误&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-除法和取模运算的零除错误\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在 Rust 中，&lt;strong&gt;整数的除法和取模运算遇到零除数时会无条件 panic&lt;/strong&gt;：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; b &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 除法遇到零：panic!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let div = a / b;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 取模遇到零：panic!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let rem = a % b;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;这行代码永远不会执行\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;为什么会这样？&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Rust 的设计哲学是：&lt;strong&gt;宁可 panic 也不产生未定义行为（Undefined Behavior, UB）&lt;/strong&gt;。在很多底层语言（如 C/C++）中，除以零会导致 UB，这可能造成：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;程序段错误（Segmentation Fault）&lt;/li&gt;\n&lt;li&gt;返回垃圾值&lt;/li&gt;\n&lt;li&gt;安全漏洞&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Rust 通过显式 panic 来避免这些不可预测的行为，让错误在第一时间暴露出来。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;浮点数例外&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;有趣的是，&lt;strong&gt;浮点数的除零操作不会 panic&lt;/strong&gt;，而是遵循 IEEE 754 标准：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ inf (正无穷)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ -inf (负无穷)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, y &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ NaN (Not a Number)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 浮点数取模也不会 panic，但会返回 NaN&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ NaN&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;2-整数溢出的特殊边界情况\&quot;&gt;2. 整数溢出的特殊边界情况&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-整数溢出的特殊边界情况\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;还有一个更隐蔽的陷阱：&lt;strong&gt;&lt;code&gt;INT_MIN / -1&lt;/code&gt; 和 &lt;code&gt;INT_MIN % -1&lt;/code&gt; 也会 panic&lt;/strong&gt;！&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; min &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; divisor &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; -&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 这会 panic！&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let result = min / divisor;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 这也会 panic！&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let remainder = min % divisor;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;为什么？&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;对于 8 位有符号整数 &lt;code&gt;i8&lt;/code&gt;：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;最小值：&lt;code&gt;i8::MIN = -128&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;最大值：&lt;code&gt;i8::MAX = 127&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;当我们计算 &lt;code&gt;-128 / -1&lt;/code&gt; 时，数学结果应该是 &lt;code&gt;128&lt;/code&gt;，但这&lt;strong&gt;超出了 &lt;code&gt;i8&lt;/code&gt; 的表示范围&lt;/strong&gt;（最大只能到 127），导致溢出。Rust 选择 panic 而不是返回错误的结果。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; demonstrate_overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 对于不同的整数类型，都存在这个问题&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i8::MIN  / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128 / -1 = 128 (溢出!)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i16::MIN / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i16&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -32768 / -1 = 32768 (溢出!)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i32::MIN / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -2147483648 / -1 = 2147483648 (溢出!)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i64::MIN / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i64&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 同理&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;3-debug-模式下的整数溢出\&quot;&gt;3. Debug 模式下的整数溢出&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-debug-模式下的整数溢出\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;Rust 在 &lt;strong&gt;debug 模式和 release 模式下对整数溢出的处理不同&lt;/strong&gt;：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; max &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Debug 模式：💥 panic!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Release 模式：✅ 环绕到 0 (wrapping)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; result &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; max &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Result: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, result);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;行为差异：&lt;/strong&gt;&lt;/p&gt;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;模式&lt;/th&gt;&lt;th&gt;溢出行为&lt;/th&gt;&lt;th&gt;原因&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Debug&lt;/strong&gt; (&lt;code&gt;cargo build&lt;/code&gt;)&lt;/td&gt;&lt;td&gt;Panic&lt;/td&gt;&lt;td&gt;帮助开发者尽早发现 bug&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Release&lt;/strong&gt; (&lt;code&gt;cargo build --release&lt;/code&gt;)&lt;/td&gt;&lt;td&gt;二进制补码环绕&lt;/td&gt;&lt;td&gt;性能优化，避免运行时检查开销&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;\n&lt;p&gt;在 release 模式下：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; +&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;      // =&gt; 0   (255 + 1 环绕为 0)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; -&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;      // =&gt; 255 (0 - 1 环绕为 255)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; +&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;      // =&gt; -128 (127 + 1 环绕为 -128)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这意味着：&lt;strong&gt;同样的代码在不同编译模式下可能有完全不同的行为！&lt;/strong&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;rust-的解决方案显式的溢出处理\&quot;&gt;Rust 的解决方案：显式的溢出处理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#rust-的解决方案显式的溢出处理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;为了让开发者能够精确控制溢出行为，Rust 提供了多种方法变体：&lt;/p&gt;\n&lt;h3 id=\&quot;1-checked_-系列安全检查返回-option\&quot;&gt;1. &lt;code&gt;checked_*&lt;/code&gt; 系列：安全检查，返回 Option&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-checked_-系列安全检查返回-option\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; safe_division&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, b&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Some(5)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None - 零除返回 None 而不是 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None - 溢出返回 None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 其他 checked 方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));       &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;128&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_rem&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));        &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None - 取模零也返回 None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;用户输入处理&lt;/li&gt;\n&lt;li&gt;外部数据验证&lt;/li&gt;\n&lt;li&gt;需要优雅处理错误的场景&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;2-wrapping_-系列显式环绕行为\&quot;&gt;2. &lt;code&gt;wrapping_*&lt;/code&gt; 系列：显式环绕行为&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-wrapping_-系列显式环绕行为\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 无论 debug 还是 release 模式，都保证环绕行为&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 0&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));        &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;200&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 144 (400 % 256)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 环绕除法：零除仍然会 panic！&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // println!(\&quot;{}\&quot;, 10.wrapping_div(0));  // 💥 仍然 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 但 INT_MIN / -1 会环绕而不是 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128 (环绕到自身)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;哈希计算&lt;/li&gt;\n&lt;li&gt;密码学算法&lt;/li&gt;\n&lt;li&gt;需要明确的模运算语义&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;3-saturating_-系列饱和到边界值\&quot;&gt;3. &lt;code&gt;saturating_*&lt;/code&gt; 系列：饱和到边界值&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-saturating_-系列饱和到边界值\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 溢出时返回类型的最大/最小值&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));    &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255 (不超过最大值)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 0   (不低于最小值)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;200&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));    &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255 (饱和到最大值)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 有符号整数&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;127&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));    &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 127&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, (&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;128&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 除法仍然对零除 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // println!(\&quot;{}\&quot;, 10.saturating_div(0));  // 💥 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;音频/视频处理（音量、亮度限制）&lt;/li&gt;\n&lt;li&gt;游戏开发（生命值、伤害计算）&lt;/li&gt;\n&lt;li&gt;UI 组件（滚动位置、进度条）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;4-overflowing_-系列返回结果和溢出标志\&quot;&gt;4. &lt;code&gt;overflowing_*&lt;/code&gt; 系列：返回结果和溢出标志&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#4-overflowing_-系列返回结果和溢出标志\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (result, overflowed) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;overflowing_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Result: {}, Overflowed: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, result, overflowed);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Result: 0, Overflowed: true&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (result, overflowed) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 100&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;overflowing_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;50&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Result: {}, Overflowed: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, result, overflowed);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Result: 150, Overflowed: false&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 可以用来实现自定义的溢出处理逻辑&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (div, overflow) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;overflowing_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Division: {}, Overflow: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, div, overflow);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Division: -128, Overflow: true&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;需要记录溢出事件&lt;/li&gt;\n&lt;li&gt;实现自定义的错误报告&lt;/li&gt;\n&lt;li&gt;性能敏感但需要溢出信息的代码&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;5-strict_-系列总是-panicrust-180\&quot;&gt;5. &lt;code&gt;strict_*&lt;/code&gt; 系列：总是 Panic（Rust 1.80+）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#5-strict_-系列总是-panicrust-180\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 无论 debug 还是 release，溢出总是 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let result = 255u8.strict_add(1);  // 💥 panic in both debug and release&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 这对于需要严格保证数学正确性的场景很有用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;金融计算&lt;/li&gt;\n&lt;li&gt;科学计算&lt;/li&gt;\n&lt;li&gt;任何不能容忍静默溢出的场景&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;完整的除零安全处理示例\&quot;&gt;完整的除零安全处理示例&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#完整的除零安全处理示例\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;结合上面的知识，我们可以写一个安全的计算器函数：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;#[derive(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Debug&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;PartialEq&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;enum&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; CalcError&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    DivisionByZero&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, b&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, op&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; char&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Result&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    match&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; op {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;+&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;-&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;*&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; b &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;                Err&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;DivisionByZero&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;                a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;%&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; b &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;                Err&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;DivisionByZero&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;                a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_rem&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        _ &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; panic!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Unsupported operation\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Ok(5)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(DivisionByZero)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;%&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(DivisionByZero)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;+&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(Overflow)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(Overflow)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;rust-vs-其他语言\&quot;&gt;Rust vs 其他语言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#rust-vs-其他语言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;让我们对比一下不同语言对除零的处理：&lt;/p&gt;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;语言&lt;/th&gt;&lt;th&gt;&lt;code&gt;10 / 0&lt;/code&gt; 行为&lt;/th&gt;&lt;th&gt;&lt;code&gt;10 % 0&lt;/code&gt; 行为&lt;/th&gt;&lt;th&gt;可捕获？&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Rust&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;Panic（程序崩溃）&lt;/td&gt;&lt;td&gt;Panic（程序崩溃）&lt;/td&gt;&lt;td&gt;❌ 不可用 try-catch 捕获&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Python&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ZeroDivisionError&lt;/code&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ZeroDivisionError&lt;/code&gt;&lt;/td&gt;&lt;td&gt;✅ 可用 try-except 捕获&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;JavaScript&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;Infinity&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;NaN&lt;/code&gt;&lt;/td&gt;&lt;td&gt;✅ 不抛出异常，返回特殊值&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Java&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ArithmeticException&lt;/code&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ArithmeticException&lt;/code&gt;&lt;/td&gt;&lt;td&gt;✅ 可用 try-catch 捕获&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;C/C++&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;未定义行为（UB）&lt;/td&gt;&lt;td&gt;未定义行为（UB）&lt;/td&gt;&lt;td&gt;❌ 无标准异常机制&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Go&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;Panic&lt;/td&gt;&lt;td&gt;Panic&lt;/td&gt;&lt;td&gt;⚠️ 可用 recover 捕获（不推荐）&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;\n&lt;p&gt;&lt;strong&gt;Rust 的设计权衡：&lt;/strong&gt;&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;不使用异常机制&lt;/strong&gt;：Rust 没有 try-catch 异常系统，这避免了隐藏的控制流和性能开销&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;强制显式处理&lt;/strong&gt;：通过 &lt;code&gt;checked_*&lt;/code&gt; 等方法，强制开发者在可能出错的地方显式处理&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Panic 是最后手段&lt;/strong&gt;：Panic 用于”不可恢复的错误”，而零除被认为是编程错误而非业务逻辑错误&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&quot;实战建议\&quot;&gt;实战建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实战建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;1-算法题中的处理\&quot;&gt;1. 算法题中的处理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-算法题中的处理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在刷算法题时，可以这样处理：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ❌ 危险：可能 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; solve_naive&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, m&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    (n &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; n) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; m  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 如果 m 为 0，直接崩溃&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 安全：添加前置检查&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; solve_safe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, m&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; m &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; None&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    Some&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;((n &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; n) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; m)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 更好：使用 checked 方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; solve_better&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, m&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;?.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_rem&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(m)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;2-生产代码的建议\&quot;&gt;2. 生产代码的建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-生产代码的建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 对于用户输入，总是使用 checked_* 方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process_user_input&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(dividend&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, divisor&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Result&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    dividend&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(divisor)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or_else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;||&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; divisor &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;                \&quot;除数不能为零\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;                \&quot;计算溢出\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        })&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 对于性能敏感且确定不会溢出的代码，可以使用普通运算符&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; fast_index_calculation&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(base&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, offset&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, size&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 假设已经在外层保证了不会溢出&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    (base &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; offset) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; size&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 对于需要环绕语义的场景，明确使用 wrapping_*&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; hash_combine&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(hash1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, hash2&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    hash1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(hash2)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0x9e3779b97f4a7c15&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;3-测试建议\&quot;&gt;3. 测试建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-测试建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;#[cfg(test)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;mod&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; tests&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    use&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; super&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[test]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[should_panic(expected &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;divide by zero\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; test_division_by_zero_panics&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; _ &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; /&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[test]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[should_panic(expected &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;remainder\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; test_modulo_by_zero_panics&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; _ &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; %&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[test]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; test_safe_division&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        assert_eq!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Some&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        assert_eq!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;None&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        assert_eq!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;None&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;总结\&quot;&gt;总结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#总结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;关键要点\&quot;&gt;关键要点&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#关键要点\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Rust 中会导致 panic 的算术运算：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;a / 0&lt;/code&gt; 和 &lt;code&gt;a % 0&lt;/code&gt;（整数）&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;INT_MIN / -1&lt;/code&gt; 和 &lt;code&gt;INT_MIN % -1&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Debug 模式下的整数溢出&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;浮点数例外：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;f32/f64&lt;/code&gt; 的除零不会 panic，返回 &lt;code&gt;Infinity&lt;/code&gt; 或 &lt;code&gt;NaN&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Debug vs Release 的差异：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Debug：溢出 panic，帮助调试&lt;/li&gt;\n&lt;li&gt;Release：溢出环绕，优化性能&lt;/li&gt;\n&lt;li&gt;使用 &lt;code&gt;checked_*&lt;/code&gt; 等方法可以统一行为&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Rust 的解决方案：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;checked_*&lt;/code&gt;：安全检查，返回 &lt;code&gt;Option&amp;#x3C;T&gt;&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;wrapping_*&lt;/code&gt;：显式环绕&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;saturating_*&lt;/code&gt;：饱和到边界&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;overflowing_*&lt;/code&gt;：返回结果和溢出标志&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;strict_*&lt;/code&gt;：总是 panic（Rust 1.80+）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;设计哲学：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;避免未定义行为&lt;/li&gt;\n&lt;li&gt;强制显式处理&lt;/li&gt;\n&lt;li&gt;Panic 用于不可恢复的编程错误&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;实践建议\&quot;&gt;实践建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实践建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;✅ &lt;strong&gt;用户输入和外部数据&lt;/strong&gt;：总是使用 &lt;code&gt;checked_*&lt;/code&gt; 方法&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;算法题&lt;/strong&gt;：添加边界检查或使用 &lt;code&gt;checked_*&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;性能关键路径&lt;/strong&gt;：如果确定安全，可以用普通运算符，但要有充分的注释说明&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;需要环绕语义&lt;/strong&gt;：明确使用 &lt;code&gt;wrapping_*&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;测试&lt;/strong&gt;：为边界情况编写测试，包括 panic 测试&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;延伸阅读\&quot;&gt;延伸阅读&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#延伸阅读\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;https://rust-lang.github.io/rfcs/0560-integer-overflow.html\&quot;&gt;Rust RFC 560 - Integer Overflow&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/\&quot;&gt;Myths and Legends about Integer Overflow in Rust&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/std/ops/trait.Div.html\&quot;&gt;Rust Documentation - Div trait&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/reference/behavior-not-considered-unsafe.html\&quot;&gt;Behavior not considered unsafe - Rust Reference&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/\&quot;&gt;Exploring Rust’s Overflow Behavior - Sling Academy&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;最后提醒：&lt;/strong&gt; 这些行为不是 bug，而是 Rust 为了安全性做出的有意设计。理解这些特性，才能写出既安全又高效的 Rust 代码。下次刷算法题时，记得留意除法和取模操作，不要让你的解答因为一个 &lt;code&gt;% 0&lt;/code&gt; 而崩溃！&lt;/p&gt;\n&lt;p&gt;写到这里，我想起了前一个月的 cloudflare的unwarp 造成的panic!。真的很好笑。&lt;/p&gt;\n&lt;p&gt;一定要注意rust一切可能引起panic!的可能性，才不会像cloudflare的unwarp方法一样，搞出的几十亿美金的全球网站崩溃漏洞。&lt;/p&gt;\n&lt;p&gt;Sources:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;https://rust-lang.github.io/rfcs/0560-integer-overflow.html\&quot;&gt;Rust RFC 560 - Integer Overflow&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/\&quot;&gt;Myths and Legends about Integer Overflow in Rust&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://stackoverflow.com/questions/68807024/what-happens-in-rust-programming-language-when-an-integer-arithmetic-operation-o\&quot;&gt;What happens in Rust programming language when an integer arithmetic operation overflows? - Stack Overflow&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/\&quot;&gt;Exploring Rust’s Overflow Behavior: Wrapping, Saturating, and Panicking - Sling Academy&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/std/ops/trait.Div.html\&quot;&gt;Div in std::ops - Rust&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;rust-中会导致-panic-的算术运算&quot;],&quot;text&quot;:[0,&quot;Rust 中会导致 Panic 的算术运算&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-除法和取模运算的零除错误&quot;],&quot;text&quot;:[0,&quot;1. 除法和取模运算的零除错误&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-整数溢出的特殊边界情况&quot;],&quot;text&quot;:[0,&quot;2. 整数溢出的特殊边界情况&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-debug-模式下的整数溢出&quot;],&quot;text&quot;:[0,&quot;3. Debug 模式下的整数溢出&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;rust-的解决方案显式的溢出处理&quot;],&quot;text&quot;:[0,&quot;Rust 的解决方案：显式的溢出处理&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-checked_-系列安全检查返回-option&quot;],&quot;text&quot;:[0,&quot;1. checked_* 系列：安全检查，返回 Option&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-wrapping_-系列显式环绕行为&quot;],&quot;text&quot;:[0,&quot;2. wrapping_* 系列：显式环绕行为&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-saturating_-系列饱和到边界值&quot;],&quot;text&quot;:[0,&quot;3. saturating_* 系列：饱和到边界值&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;4-overflowing_-系列返回结果和溢出标志&quot;],&quot;text&quot;:[0,&quot;4. overflowing_* 系列：返回结果和溢出标志&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;5-strict_-系列总是-panicrust-180&quot;],&quot;text&quot;:[0,&quot;5. strict_* 系列：总是 Panic（Rust 1.80+）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;完整的除零安全处理示例&quot;],&quot;text&quot;:[0,&quot;完整的除零安全处理示例&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;rust-vs-其他语言&quot;],&quot;text&quot;:[0,&quot;Rust vs 其他语言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;实战建议&quot;],&quot;text&quot;:[0,&quot;实战建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-算法题中的处理&quot;],&quot;text&quot;:[0,&quot;1. 算法题中的处理&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-生产代码的建议&quot;],&quot;text&quot;:[0,&quot;2. 生产代码的建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-测试建议&quot;],&quot;text&quot;:[0,&quot;3. 测试建议&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;总结&quot;],&quot;text&quot;:[0,&quot;总结&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;关键要点&quot;],&quot;text&quot;:[0,&quot;关键要点&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;实践建议&quot;],&quot;text&quot;:[0,&quot;实践建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;延伸阅读&quot;],&quot;text&quot;:[0,&quot;延伸阅读&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Rust 算术运算的 Panic 陷阱：从取模零说起&quot;],&quot;date&quot;:[3,&quot;2025-12-02T10:00:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;算法&quot;],[0,&quot;安全&quot;],[0,&quot;Panic&quot;],[0,&quot;算术运算&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;],&quot;description&quot;:[0,&quot;在刷 Rust 算法题时发现了一个独特现象：对零取模会直接导致程序 panic！这与其他语言的行为截然不同。本文深入探讨 Rust 中会导致 panic 的算术运算场景，包括除零、整数溢出、INT_MIN/-1 等特殊情况，以及 Rust 提供的 checked_、wrapping_、saturating_ 等安全替代方案。理解这些行为对于编写健壮的 Rust 程序至关重要。&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/20&quot;]}],&quot;nextPost&quot;:[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;rust-trait-为泛型类型的具体实例实现特征&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Rust Trait：为泛型类型的具体实例实现特征&quot;],&quot;description&quot;:[0,&quot;深入理解 Rust 中 trait 实现的灵活性：为什么可以为 Vec&lt;String&gt; 这样的泛型类型具体实例实现 trait？探讨 Rust 类型系统中的类型特化（Type Specialization）、trait 实现的作用范围，以及如何利用这一特性编写更灵活的代码。&quot;],&quot;date&quot;:[3,&quot;2025-11-25T10:30:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;Trait&quot;],[0,&quot;泛型&quot;],[0,&quot;类型系统&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;]}],&quot;body&quot;:[0,&quot;## 前言\n\n在学习 Rust 的 trait 系统时，我遇到了一个有趣的问题：**为什么可以为 `Vec&lt;String&gt;` 这样的泛型类型的具体实例实现 trait？** 这似乎与我们通常理解的\&quot;只能为结构体实现 trait\&quot;的观念不太一致。本文将深入探讨这个问题，帮助你更好地理解 Rust 的类型系统。\n\n## 问题的由来\n\n假设我们定义了一个简单的 trait：\n\n```rust\ntrait AppendBar {\n    fn append_bar(&amp;mut self);\n}\n```\n\n然后，我们可以这样为 `Vec&lt;String&gt;` 实现这个 trait：\n\n```rust\nimpl AppendBar for Vec&lt;String&gt; {\n    fn append_bar(&amp;mut self) {\n        self.push(String::from(\&quot;Bar\&quot;));\n    }\n}\n```\n\n这段代码完全合法且能正常工作：\n\n```rust\nfn main() {\n    let mut my_vec: Vec&lt;String&gt; = vec![\n        String::from(\&quot;Foo\&quot;),\n        String::from(\&quot;Baz\&quot;),\n    ];\n\n    my_vec.append_bar();\n\n    println!(\&quot;{:?}\&quot;, my_vec); // 输出: [\&quot;Foo\&quot;, \&quot;Baz\&quot;, \&quot;Bar\&quot;]\n}\n```\n\n但问题来了：**`Vec&lt;String&gt;` 不是一个结构体，而是泛型类型 `Vec&lt;T&gt;` 的一个具体实例，为什么可以为它实现 trait？**\n\n## 核心概念：类型特化（Type Specialization）\n\n### 什么是类型特化？\n\n在 Rust 中，`Vec&lt;T&gt;` 是一个**泛型类型**，其中 `T` 是类型参数。当我们指定 `T = String` 时，`Vec&lt;String&gt;` 就成为了一个**具体类型**（Concrete Type），这个过程被称为**类型特化**。\n\n从 Rust 编译器的角度来看：\n\n- `Vec&lt;T&gt;` 是一个**类型构造器**（Type Constructor），需要一个类型参数才能成为完整的类型\n- `Vec&lt;String&gt;` 是一个**完整的具体类型**，和 `i32`、`String` 等具有同等地位\n\n### 类型特化的实例\n\n```rust\n// 这些都是不同的具体类型\nlet v1: Vec&lt;i32&gt; = vec![1, 2, 3];\nlet v2: Vec&lt;String&gt; = vec![\&quot;hello\&quot;.to_string()];\nlet v3: Vec&lt;Vec&lt;u8&gt;&gt; = vec![vec![1, 2], vec![3, 4]];\n```\n\n在 Rust 的类型系统中，`Vec&lt;i32&gt;`、`Vec&lt;String&gt;` 和 `Vec&lt;Vec&lt;u8&gt;&gt;` 是**三个完全不同的类型**，就像 `Dog` 和 `Cat` 是两个不同的结构体一样。\n\n## Trait 实现的灵活性\n\nRust 的 trait 系统允许你为**任何具体类型**实现 trait，不仅仅是结构体。这包括：\n\n1. **自定义结构体**\n2. **枚举类型**\n3. **泛型类型的具体实例**（如 `Vec&lt;String&gt;`）\n4. **基本类型**（如 `i32`，但需要遵循孤儿规则）\n5. **元组类型**（如 `(i32, String)`）\n\n### 示例 1：为不同的 Vec 实例实现不同的 trait\n\n```rust\ntrait AppendBar {\n    fn append_bar(&amp;mut self);\n}\n\ntrait AppendBaz {\n    fn append_baz(&amp;mut self);\n}\n\n// 为 Vec&lt;String&gt; 实现 AppendBar\nimpl AppendBar for Vec&lt;String&gt; {\n    fn append_bar(&amp;mut self) {\n        self.push(String::from(\&quot;Bar\&quot;));\n    }\n}\n\n// 为 Vec&lt;i32&gt; 实现 AppendBaz\nimpl AppendBaz for Vec&lt;i32&gt; {\n    fn append_baz(&amp;mut self) {\n        self.push(42);\n    }\n}\n\nfn main() {\n    let mut strings = vec![String::from(\&quot;Foo\&quot;)];\n    strings.append_bar(); // ✅ 可以调用\n    // strings.append_baz(); // ❌ 编译错误：Vec&lt;String&gt; 没有实现 AppendBaz\n\n    let mut numbers = vec![1, 2, 3];\n    numbers.append_baz(); // ✅ 可以调用\n    // numbers.append_bar(); // ❌ 编译错误：Vec&lt;i32&gt; 没有实现 AppendBar\n}\n```\n\n### 示例 2：为元组类型实现 trait\n\n```rust\ntrait Describable {\n    fn describe(&amp;self) -&gt; String;\n}\n\n// 为 (i32, String) 元组实现 trait\nimpl Describable for (i32, String) {\n    fn describe(&amp;self) -&gt; String {\n        format!(\&quot;Number: {}, Text: {}\&quot;, self.0, self.1)\n    }\n}\n\nfn main() {\n    let tuple = (42, String::from(\&quot;Hello\&quot;));\n    println!(\&quot;{}\&quot;, tuple.describe()); // 输出: Number: 42, Text: Hello\n}\n```\n\n## 泛型实现 vs 具体实现\n\nRust 允许你选择不同的实现策略：\n\n### 策略 1：为所有 `Vec&lt;T&gt;` 实现（泛型实现）\n\n```rust\ntrait Printable {\n    fn print_all(&amp;self);\n}\n\n// 为所有 Vec&lt;T&gt; 实现，其中 T 必须实现 Debug trait\nimpl&lt;T: std::fmt::Debug&gt; Printable for Vec&lt;T&gt; {\n    fn print_all(&amp;self) {\n        for item in self {\n            println!(\&quot;{:?}\&quot;, item);\n        }\n    }\n}\n\nfn main() {\n    let strings = vec![String::from(\&quot;Foo\&quot;), String::from(\&quot;Bar\&quot;)];\n    strings.print_all(); // ✅ 可以使用\n\n    let numbers = vec![1, 2, 3];\n    numbers.print_all(); // ✅ 也可以使用\n}\n```\n\n**特点：**\n- 为所有满足约束的 `Vec&lt;T&gt;` 实现 trait\n- trait 方法必须对所有可能的 `T` 都有效\n- 实现代码只写一次，适用于多种类型\n\n### 策略 2：为特定的 `Vec&lt;T&gt;` 实现（具体实现）\n\n```rust\ntrait StringOperations {\n    fn to_uppercase_all(&amp;mut self);\n    fn concat_all(&amp;self) -&gt; String;\n}\n\n// 仅为 Vec&lt;String&gt; 实现\nimpl StringOperations for Vec&lt;String&gt; {\n    fn to_uppercase_all(&amp;mut self) {\n        for s in self.iter_mut() {\n            *s = s.to_uppercase();\n        }\n    }\n\n    fn concat_all(&amp;self) -&gt; String {\n        self.join(\&quot;, \&quot;)\n    }\n}\n\nfn main() {\n    let mut strings = vec![String::from(\&quot;hello\&quot;), String::from(\&quot;world\&quot;)];\n    strings.to_uppercase_all();\n    println!(\&quot;{}\&quot;, strings.concat_all()); // 输出: HELLO, WORLD\n\n    // let mut numbers = vec![1, 2, 3];\n    // numbers.to_uppercase_all(); // ❌ 编译错误：Vec&lt;i32&gt; 没有实现 StringOperations\n}\n```\n\n**特点：**\n- 只为特定的 `Vec&lt;String&gt;` 实现\n- 可以使用 `String` 特有的方法（如 `to_uppercase()`）\n- 实现更有针对性，类型更安全\n\n## 实际应用场景\n\n### 场景 1：为标准库类型添加自定义功能\n\n```rust\ntrait Statistics {\n    fn mean(&amp;self) -&gt; f64;\n    fn median(&amp;self) -&gt; f64;\n}\n\nimpl Statistics for Vec&lt;f64&gt; {\n    fn mean(&amp;self) -&gt; f64 {\n        if self.is_empty() {\n            return 0.0;\n        }\n        self.iter().sum::&lt;f64&gt;() / self.len() as f64\n    }\n\n    fn median(&amp;self) -&gt; f64 {\n        if self.is_empty() {\n            return 0.0;\n        }\n        let mut sorted = self.clone();\n        sorted.sort_by(|a, b| a.partial_cmp(b).unwrap());\n        let mid = sorted.len() / 2;\n        if sorted.len() % 2 == 0 {\n            (sorted[mid - 1] + sorted[mid]) / 2.0\n        } else {\n            sorted[mid]\n        }\n    }\n}\n\nfn main() {\n    let data = vec![1.0, 2.0, 3.0, 4.0, 5.0];\n    println!(\&quot;Mean: {}\&quot;, data.mean());     // 输出: Mean: 3\n    println!(\&quot;Median: {}\&quot;, data.median()); // 输出: Median: 3\n}\n```\n\n### 场景 2：实现特定领域的类型约束\n\n```rust\ntrait JsonSerializable {\n    fn to_json(&amp;self) -&gt; String;\n}\n\n// 为字符串数组实现 JSON 序列化\nimpl JsonSerializable for Vec&lt;String&gt; {\n    fn to_json(&amp;self) -&gt; String {\n        let items: Vec&lt;String&gt; = self\n            .iter()\n            .map(|s| format!(\&quot;\\\&quot;{}\\\&quot;\&quot;, s))\n            .collect();\n        format!(\&quot;[{}]\&quot;, items.join(\&quot;, \&quot;))\n    }\n}\n\n// 为数字数组实现 JSON 序列化\nimpl JsonSerializable for Vec&lt;i32&gt; {\n    fn to_json(&amp;self) -&gt; String {\n        let items: Vec&lt;String&gt; = self\n            .iter()\n            .map(|n| n.to_string())\n            .collect();\n        format!(\&quot;[{}]\&quot;, items.join(\&quot;, \&quot;))\n    }\n}\n\nfn main() {\n    let strings = vec![String::from(\&quot;hello\&quot;), String::from(\&quot;world\&quot;)];\n    println!(\&quot;{}\&quot;, strings.to_json()); // 输出: [\&quot;hello\&quot;, \&quot;world\&quot;]\n\n    let numbers = vec![1, 2, 3];\n    println!(\&quot;{}\&quot;, numbers.to_json()); // 输出: [1, 2, 3]\n}\n```\n\n## 孤儿规则（Orphan Rule）\n\n虽然可以为泛型类型的具体实例实现 trait，但必须遵守 Rust 的**孤儿规则**：\n\n&gt; **至少 trait 或类型其中之一必须在当前 crate 中定义。**\n\n### 合法的实现\n\n```rust\n// ✅ 情况 1：trait 在本 crate 中定义\ntrait MyTrait {\n    fn do_something(&amp;self);\n}\n\n// Vec 虽然是标准库的，但 MyTrait 是我们定义的\nimpl MyTrait for Vec&lt;String&gt; {\n    fn do_something(&amp;self) {\n        println!(\&quot;Doing something with {} strings\&quot;, self.len());\n    }\n}\n\n// ✅ 情况 2：类型在本 crate 中定义\nstruct MyType {\n    data: Vec&lt;i32&gt;,\n}\n\n// Display 虽然是标准库的，但 MyType 是我们定义的\nimpl std::fmt::Display for MyType {\n    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#39;_&gt;) -&gt; std::fmt::Result {\n        write!(f, \&quot;MyType with {} elements\&quot;, self.data.len())\n    }\n}\n```\n\n### 非法的实现\n\n```rust\n// ❌ 错误：trait 和类型都不在本 crate 中\n// impl std::fmt::Display for Vec&lt;String&gt; {\n//     fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#39;_&gt;) -&gt; std::fmt::Result {\n//         write!(f, \&quot;Custom Vec Display\&quot;)\n//     }\n// }\n// 编译错误：只有在本地 crate 定义的 trait 才能为外部类型实现\n```\n\n## 特化（Specialization）的未来\n\nRust 正在开发一个更强大的特性：**trait 特化（Trait Specialization）**，它允许你先为泛型类型实现 trait，然后为特定实例提供更优化的实现。\n\n```rust\n#![feature(specialization)] // 需要 nightly Rust\n\ntrait Process {\n    fn process(&amp;self);\n}\n\n// 默认实现：适用于所有 Vec&lt;T&gt;\nimpl&lt;T&gt; Process for Vec&lt;T&gt; {\n    default fn process(&amp;self) {\n        println!(\&quot;Processing {} items (generic)\&quot;, self.len());\n    }\n}\n\n// 特化实现：针对 Vec&lt;String&gt; 的优化版本\nimpl Process for Vec&lt;String&gt; {\n    fn process(&amp;self) {\n        println!(\&quot;Processing {} strings (specialized)\&quot;, self.len());\n        for s in self {\n            println!(\&quot;  - {}\&quot;, s);\n        }\n    }\n}\n```\n\n注意：这个特性目前还在实验阶段，仅在 nightly Rust 中可用。\n\n## 总结\n\n### 关键要点\n\n1. **`Vec&lt;String&gt;` 是一个完整的具体类型**，不是泛型类型\n   - `Vec&lt;T&gt;` 是泛型类型（类型构造器）\n   - `Vec&lt;String&gt;` 是具体类型（`T` 被特化为 `String`）\n\n2. **Rust 允许为任何具体类型实现 trait**\n   - 结构体、枚举\n   - 泛型类型的具体实例（如 `Vec&lt;String&gt;`）\n   - 基本类型、元组等\n\n3. **实现策略的选择**\n   - **泛型实现**：`impl&lt;T&gt; Trait for Vec&lt;T&gt;` - 适用于所有 `T`\n   - **具体实现**：`impl Trait for Vec&lt;String&gt;` - 只适用于特定类型\n\n4. **孤儿规则必须遵守**\n   - trait 或类型至少有一个在本 crate 中定义\n   - 防止不同 crate 之间的实现冲突\n\n5. **类型安全的保证**\n   - 为 `Vec&lt;String&gt;` 实现的 trait 不会影响 `Vec&lt;i32&gt;`\n   - 每个具体类型都是独立的，编译器会严格检查\n\n### 实践建议\n\n- **优先使用泛型实现**：如果 trait 方法适用于所有 `T`，使用 `impl&lt;T&gt; Trait for Vec&lt;T&gt;`\n- **针对性优化时使用具体实现**：当需要使用特定类型的方法时，为具体类型实现 trait\n- **遵守孤儿规则**：确保 trait 或类型至少有一个在本 crate 中定义\n- **类型约束清晰**：使用具体实现可以获得更好的类型安全和代码可读性\n\n### 延伸阅读\n\n- [The Rust Programming Language - Traits](https://doc.rust-lang.org/book/ch10-02-traits.html)\n- [Rust Reference - Trait Implementation](https://doc.rust-lang.org/reference/items/implementations.html)\n- [RFC 1210 - Specialization](https://rust-lang.github.io/rfcs/1210-impl-specialization.html)\n\n希望这篇文章能帮助你更好地理解 Rust 的 trait 系统。记住：**类型特化让 Rust 的类型系统既灵活又安全**，善用这一特性可以写出更优雅的代码！\n\n---\n\n**最后提醒：** 这篇笔记记录了一个初学时容易混淆的概念。如果你也在学习 Rust，建议动手实践这些示例代码，加深理解。类型系统是 Rust 最强大的特性之一，值得深入学习！&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Rust-Trait-为泛型类型的具体实例实现特征.md&quot;],&quot;digest&quot;:[0,&quot;cf3e3092d3e4c992&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h2 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;在学习 Rust 的 trait 系统时，我遇到了一个有趣的问题：&lt;strong&gt;为什么可以为 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 这样的泛型类型的具体实例实现 trait？&lt;/strong&gt; 这似乎与我们通常理解的”只能为结构体实现 trait”的观念不太一致。本文将深入探讨这个问题，帮助你更好地理解 Rust 的类型系统。&lt;/p&gt;\n&lt;h2 id=\&quot;问题的由来\&quot;&gt;问题的由来&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#问题的由来\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;假设我们定义了一个简单的 trait：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;然后，我们可以这样为 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 实现这个 trait：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;push&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Bar\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这段代码完全合法且能正常工作：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; my_vec&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Foo\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Baz\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    ];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    my_vec&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, my_vec); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: [\&quot;Foo\&quot;, \&quot;Baz\&quot;, \&quot;Bar\&quot;]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;但问题来了：&lt;strong&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 不是一个结构体，而是泛型类型 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 的一个具体实例，为什么可以为它实现 trait？&lt;/strong&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;核心概念类型特化type-specialization\&quot;&gt;核心概念：类型特化（Type Specialization）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#核心概念类型特化type-specialization\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;什么是类型特化\&quot;&gt;什么是类型特化？&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#什么是类型特化\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在 Rust 中，&lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 是一个&lt;strong&gt;泛型类型&lt;/strong&gt;，其中 &lt;code&gt;T&lt;/code&gt; 是类型参数。当我们指定 &lt;code&gt;T = String&lt;/code&gt; 时，&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 就成为了一个&lt;strong&gt;具体类型&lt;/strong&gt;（Concrete Type），这个过程被称为&lt;strong&gt;类型特化&lt;/strong&gt;。&lt;/p&gt;\n&lt;p&gt;从 Rust 编译器的角度来看：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 是一个&lt;strong&gt;类型构造器&lt;/strong&gt;（Type Constructor），需要一个类型参数才能成为完整的类型&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 是一个&lt;strong&gt;完整的具体类型&lt;/strong&gt;，和 &lt;code&gt;i32&lt;/code&gt;、&lt;code&gt;String&lt;/code&gt; 等具有同等地位&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;类型特化的实例\&quot;&gt;类型特化的实例&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#类型特化的实例\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 这些都是不同的具体类型&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; v1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; v2&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; v3&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;], &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;4&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;]];&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;在 Rust 的类型系统中，&lt;code&gt;Vec&amp;#x3C;i32&gt;&lt;/code&gt;、&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 和 &lt;code&gt;Vec&amp;#x3C;Vec&amp;#x3C;u8&gt;&gt;&lt;/code&gt; 是&lt;strong&gt;三个完全不同的类型&lt;/strong&gt;，就像 &lt;code&gt;Dog&lt;/code&gt; 和 &lt;code&gt;Cat&lt;/code&gt; 是两个不同的结构体一样。&lt;/p&gt;\n&lt;h2 id=\&quot;trait-实现的灵活性\&quot;&gt;Trait 实现的灵活性&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#trait-实现的灵活性\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 的 trait 系统允许你为&lt;strong&gt;任何具体类型&lt;/strong&gt;实现 trait，不仅仅是结构体。这包括：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;自定义结构体&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;枚举类型&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;泛型类型的具体实例&lt;/strong&gt;（如 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt;）&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;基本类型&lt;/strong&gt;（如 &lt;code&gt;i32&lt;/code&gt;，但需要遵循孤儿规则）&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;元组类型&lt;/strong&gt;（如 &lt;code&gt;(i32, String)&lt;/code&gt;）&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;示例-1为不同的-vec-实例实现不同的-trait\&quot;&gt;示例 1：为不同的 Vec 实例实现不同的 trait&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#示例-1为不同的-vec-实例实现不同的-trait\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBaz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_baz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为 Vec&amp;#x3C;String&gt; 实现 AppendBar&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;push&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Bar\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为 Vec&amp;#x3C;i32&gt; 实现 AppendBaz&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBaz&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_baz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;push&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;42&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Foo\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 可以调用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // strings.append_baz(); // ❌ 编译错误：Vec&amp;#x3C;String&gt; 没有实现 AppendBaz&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    numbers&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;append_baz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 可以调用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // numbers.append_bar(); // ❌ 编译错误：Vec&amp;#x3C;i32&gt; 没有实现 AppendBar&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;示例-2为元组类型实现-trait\&quot;&gt;示例 2：为元组类型实现 trait&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#示例-2为元组类型实现-trait\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Describable&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; describe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为 (i32, String) 元组实现 trait&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Describable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; describe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Number: {}, Text: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; tuple &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;42&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, tuple&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;describe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: Number: 42, Text: Hello&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;泛型实现-vs-具体实现\&quot;&gt;泛型实现 vs 具体实现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#泛型实现-vs-具体实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 允许你选择不同的实现策略：&lt;/p&gt;\n&lt;h3 id=\&quot;策略-1为所有-vect-实现泛型实现\&quot;&gt;策略 1：为所有 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 实现（泛型实现）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#策略-1为所有-vect-实现泛型实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Printable&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为所有 Vec&amp;#x3C;T&gt; 实现，其中 T 必须实现 Debug trait&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Debug&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Printable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; item &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;            println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, item);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Foo\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Bar\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 可以使用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    numbers&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 也可以使用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;特点：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;为所有满足约束的 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 实现 trait&lt;/li&gt;\n&lt;li&gt;trait 方法必须对所有可能的 &lt;code&gt;T&lt;/code&gt; 都有效&lt;/li&gt;\n&lt;li&gt;实现代码只写一次，适用于多种类型&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;策略-2为特定的-vect-实现具体实现\&quot;&gt;策略 2：为特定的 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 实现（具体实现）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#策略-2为特定的-vect-实现具体实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; StringOperations&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_uppercase_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; concat_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 仅为 Vec&amp;#x3C;String&gt; 实现&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; StringOperations&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_uppercase_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter_mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            *&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_uppercase&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; concat_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;join&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;, \&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;world\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_uppercase_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;concat_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: HELLO, WORLD&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let mut numbers = vec![1, 2, 3];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // numbers.to_uppercase_all(); // ❌ 编译错误：Vec&amp;#x3C;i32&gt; 没有实现 StringOperations&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;特点：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;只为特定的 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 实现&lt;/li&gt;\n&lt;li&gt;可以使用 &lt;code&gt;String&lt;/code&gt; 特有的方法（如 &lt;code&gt;to_uppercase()&lt;/code&gt;）&lt;/li&gt;\n&lt;li&gt;实现更有针对性，类型更安全&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;实际应用场景\&quot;&gt;实际应用场景&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实际应用场景\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;场景-1为标准库类型添加自定义功能\&quot;&gt;场景 1：为标准库类型添加自定义功能&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-1为标准库类型添加自定义功能\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Statistics&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; mean&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; median&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Statistics&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; mean&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        if&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;is_empty&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            return&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;sum&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;as&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; median&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        if&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;is_empty&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            return&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;clone&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        sorted&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;sort_by&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;a, b&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;partial_cmp&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;unwrap&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; mid &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 2&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; ==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            (sorted[mid &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;] &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted[mid]) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 2.0&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            sorted[mid]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; data &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;4.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Mean: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;mean&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: Mean: 3&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Median: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;median&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: Median: 3&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;场景-2实现特定领域的类型约束\&quot;&gt;场景 2：实现特定领域的类型约束&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-2实现特定领域的类型约束\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; JsonSerializable&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为字符串数组实现 JSON 序列化&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; JsonSerializable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;map&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;\\\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;{}&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;\\\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, s))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;collect&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;[{}]\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;join&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;, \&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为数字数组实现 JSON 序列化&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; JsonSerializable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;map&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;collect&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;[{}]\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;join&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;, \&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;world\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: [\&quot;hello\&quot;, \&quot;world\&quot;]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, numbers&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: [1, 2, 3]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;孤儿规则orphan-rule\&quot;&gt;孤儿规则（Orphan Rule）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#孤儿规则orphan-rule\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;虽然可以为泛型类型的具体实例实现 trait，但必须遵守 Rust 的&lt;strong&gt;孤儿规则&lt;/strong&gt;：&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;&lt;strong&gt;至少 trait 或类型其中之一必须在当前 crate 中定义。&lt;/strong&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h3 id=\&quot;合法的实现\&quot;&gt;合法的实现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#合法的实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 情况 1：trait 在本 crate 中定义&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyTrait&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; do_something&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Vec 虽然是标准库的，但 MyTrait 是我们定义的&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyTrait&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; do_something&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Doing something with {} strings\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 情况 2：类型在本 crate 中定义&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;struct&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyType&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Display 虽然是标准库的，但 MyType 是我们定义的&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Display&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyType&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; fmt&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, f&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Formatter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;_&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Result&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        write!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(f, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;MyType with {} elements\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;非法的实现\&quot;&gt;非法的实现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#非法的实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ❌ 错误：trait 和类型都不在本 crate 中&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// impl std::fmt::Display for Vec&amp;#x3C;String&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;//     fn fmt(&amp;#x26;self, f: &amp;#x26;mut std::fmt::Formatter&amp;#x3C;&#39;_&gt;) -&gt; std::fmt::Result {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;//         write!(f, \&quot;Custom Vec Display\&quot;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;//     }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 编译错误：只有在本地 crate 定义的 trait 才能为外部类型实现&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;特化specialization的未来\&quot;&gt;特化（Specialization）的未来&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#特化specialization的未来\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 正在开发一个更强大的特性：&lt;strong&gt;trait 特化（Trait Specialization）&lt;/strong&gt;，它允许你先为泛型类型实现 trait，然后为特定实例提供更优化的实现。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;#![feature(specialization)] &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 需要 nightly Rust&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 默认实现：适用于所有 Vec&amp;#x3C;T&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Process&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    default &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Processing {} items (generic)\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 特化实现：针对 Vec&amp;#x3C;String&gt; 的优化版本&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Process&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Processing {} strings (specialized)\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;            println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;  - {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, s);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;注意：这个特性目前还在实验阶段，仅在 nightly Rust 中可用。&lt;/p&gt;\n&lt;h2 id=\&quot;总结\&quot;&gt;总结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#总结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;关键要点\&quot;&gt;关键要点&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#关键要点\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 是一个完整的具体类型&lt;/strong&gt;，不是泛型类型&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 是泛型类型（类型构造器）&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 是具体类型（&lt;code&gt;T&lt;/code&gt; 被特化为 &lt;code&gt;String&lt;/code&gt;）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Rust 允许为任何具体类型实现 trait&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;结构体、枚举&lt;/li&gt;\n&lt;li&gt;泛型类型的具体实例（如 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt;）&lt;/li&gt;\n&lt;li&gt;基本类型、元组等&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;实现策略的选择&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;泛型实现&lt;/strong&gt;：&lt;code&gt;impl&amp;#x3C;T&gt; Trait for Vec&amp;#x3C;T&gt;&lt;/code&gt; - 适用于所有 &lt;code&gt;T&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;具体实现&lt;/strong&gt;：&lt;code&gt;impl Trait for Vec&amp;#x3C;String&gt;&lt;/code&gt; - 只适用于特定类型&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;孤儿规则必须遵守&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;trait 或类型至少有一个在本 crate 中定义&lt;/li&gt;\n&lt;li&gt;防止不同 crate 之间的实现冲突&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;类型安全的保证&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;为 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 实现的 trait 不会影响 &lt;code&gt;Vec&amp;#x3C;i32&gt;&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;每个具体类型都是独立的，编译器会严格检查&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;实践建议\&quot;&gt;实践建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实践建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;优先使用泛型实现&lt;/strong&gt;：如果 trait 方法适用于所有 &lt;code&gt;T&lt;/code&gt;，使用 &lt;code&gt;impl&amp;#x3C;T&gt; Trait for Vec&amp;#x3C;T&gt;&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;针对性优化时使用具体实现&lt;/strong&gt;：当需要使用特定类型的方法时，为具体类型实现 trait&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;遵守孤儿规则&lt;/strong&gt;：确保 trait 或类型至少有一个在本 crate 中定义&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;类型约束清晰&lt;/strong&gt;：使用具体实现可以获得更好的类型安全和代码可读性&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;延伸阅读\&quot;&gt;延伸阅读&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#延伸阅读\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/book/ch10-02-traits.html\&quot;&gt;The Rust Programming Language - Traits&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/reference/items/implementations.html\&quot;&gt;Rust Reference - Trait Implementation&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://rust-lang.github.io/rfcs/1210-impl-specialization.html\&quot;&gt;RFC 1210 - Specialization&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;希望这篇文章能帮助你更好地理解 Rust 的 trait 系统。记住：&lt;strong&gt;类型特化让 Rust 的类型系统既灵活又安全&lt;/strong&gt;，善用这一特性可以写出更优雅的代码！&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;最后提醒：&lt;/strong&gt; 这篇笔记记录了一个初学时容易混淆的概念。如果你也在学习 Rust，建议动手实践这些示例代码，加深理解。类型系统是 Rust 最强大的特性之一，值得深入学习！&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;问题的由来&quot;],&quot;text&quot;:[0,&quot;问题的由来&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;核心概念类型特化type-specialization&quot;],&quot;text&quot;:[0,&quot;核心概念：类型特化（Type Specialization）&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;什么是类型特化&quot;],&quot;text&quot;:[0,&quot;什么是类型特化？&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;类型特化的实例&quot;],&quot;text&quot;:[0,&quot;类型特化的实例&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;trait-实现的灵活性&quot;],&quot;text&quot;:[0,&quot;Trait 实现的灵活性&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;示例-1为不同的-vec-实例实现不同的-trait&quot;],&quot;text&quot;:[0,&quot;示例 1：为不同的 Vec 实例实现不同的 trait&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;示例-2为元组类型实现-trait&quot;],&quot;text&quot;:[0,&quot;示例 2：为元组类型实现 trait&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;泛型实现-vs-具体实现&quot;],&quot;text&quot;:[0,&quot;泛型实现 vs 具体实现&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;策略-1为所有-vect-实现泛型实现&quot;],&quot;text&quot;:[0,&quot;策略 1：为所有 Vec&lt;T&gt; 实现（泛型实现）&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;策略-2为特定的-vect-实现具体实现&quot;],&quot;text&quot;:[0,&quot;策略 2：为特定的 Vec&lt;T&gt; 实现（具体实现）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;实际应用场景&quot;],&quot;text&quot;:[0,&quot;实际应用场景&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-1为标准库类型添加自定义功能&quot;],&quot;text&quot;:[0,&quot;场景 1：为标准库类型添加自定义功能&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-2实现特定领域的类型约束&quot;],&quot;text&quot;:[0,&quot;场景 2：实现特定领域的类型约束&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;孤儿规则orphan-rule&quot;],&quot;text&quot;:[0,&quot;孤儿规则（Orphan Rule）&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;合法的实现&quot;],&quot;text&quot;:[0,&quot;合法的实现&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;非法的实现&quot;],&quot;text&quot;:[0,&quot;非法的实现&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;特化specialization的未来&quot;],&quot;text&quot;:[0,&quot;特化（Specialization）的未来&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;总结&quot;],&quot;text&quot;:[0,&quot;总结&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;关键要点&quot;],&quot;text&quot;:[0,&quot;关键要点&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;实践建议&quot;],&quot;text&quot;:[0,&quot;实践建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;延伸阅读&quot;],&quot;text&quot;:[0,&quot;延伸阅读&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Rust Trait：为泛型类型的具体实例实现特征&quot;],&quot;date&quot;:[3,&quot;2025-11-25T10:30:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;Trait&quot;],[0,&quot;泛型&quot;],[0,&quot;类型系统&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;],&quot;description&quot;:[0,&quot;深入理解 Rust 中 trait 实现的灵活性：为什么可以为 Vec&lt;String&gt; 这样的泛型类型具体实例实现 trait？探讨 Rust 类型系统中的类型特化（Type Specialization）、trait 实现的作用范围，以及如何利用这一特性编写更灵活的代码。&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/18&quot;]}],&quot;className&quot;:[0,&quot;w-full px-2&quot;],&quot;data-astro-cid-nxumbhks&quot;:[0,true]}" ssr client="load" opts="{&quot;name&quot;:&quot;SeriesNavigation&quot;,&quot;value&quot;:true}" await-children><div class="border-border mt-4 flex flex-col gap-3 border-t pt-4 md:mt-0 md:pt-2 w-full px-2"><div class="flex items-center justify-between gap-2"><a href="/blog/post/20" class="group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary max-w-[45%] min-w-0 flex-1" title="Rust 算术运算的 Panic 陷阱：从取模零说起"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 shrink-0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10.8284 12.0007L15.7782 16.9504L14.364 18.3646L8 12.0007L14.364 5.63672L15.7782 7.05093L10.8284 12.0007Z"></path></svg><span class="truncate text-xs">Rust 算术运算的 Panic 陷阱：从取模零说起</span></a><a href="/blog/post/18" class="group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary max-w-[45%] min-w-0 flex-1 justify-end text-right" title="Rust Trait：为泛型类型的具体实例实现特征"><span class="truncate text-xs">Rust Trait：为泛型类型的具体实例实现特征</span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 shrink-0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M13.1717 12.0007L8.22192 7.05093L9.63614 5.63672L16.0001 12.0007L9.63614 18.3646L8.22192 16.9504L13.1717 12.0007Z"></path></svg></a></div><div class="flex justify-center gap-2"><button class="flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary text-xs" title="回到顶部" aria-label="回到顶部"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.9999 10.8284L7.0502 15.7782L5.63599 14.364L11.9999 8L18.3639 14.364L16.9497 15.7782L11.9999 10.8284Z"></path></svg>回到顶部</button><button class="flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary text-xs" title="滚到底部" aria-label="滚到底部"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.9999 13.1714L16.9497 8.22168L18.3639 9.63589L11.9999 15.9999L5.63599 9.63589L7.0502 8.22168L11.9999 13.1714Z"></path></svg>滚到底部</button></div></div><!--astro:end--></astro-island> <astro-island uid="ZhqBkt" prefix="r14" component-url="/_astro/ScrollProgress.BRACH8UE.js" component-export="ScrollProgress" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;className&quot;:[0,&quot;mt-auto w-full rounded-full pt-4&quot;],&quot;data-astro-cid-nxumbhks&quot;:[0,true]}" ssr client="load" opts="{&quot;name&quot;:&quot;ScrollProgress&quot;,&quot;value&quot;:true}" await-children><div class="mt-auto w-full rounded-full pt-4"><div class="bg-primary h-1 origin-left rounded-full" style="transform:scaleX(0)"></div></div><!--astro:end--></astro-island> </div> <script type="module" src="/_astro/HomeSider.astro_astro_type_script_index_0_lang.Bv6ALP6W.js"></script>  </div> <div class="flex min-w-0 grow flex-col gap-8 md:w-full">    <div class="shadow-box bg-gradient-start flex flex-col gap-2 px-10 py-8 tablet:px-6 tablet:pt-6 tablet:pb-2"> <!-- Breadcrumb Navigation --> <nav class="text-muted-foreground flex items-center gap-2 text-sm"> <div class="flex items-center gap-1"> <!-- Home Icon and Link --> <i class="fa-solid fa-house-chimney text-sm" aria-hidden="true"></i> <a href="/blog" aria-label="返回首页"> <span class="hover:text-blue transition-colors duration-300">首页</span> </a> </div> <!-- Category Breadcrumbs -->  <i class="fa-solid fa-angle-right text-muted-foreground/60 text-sm" aria-hidden="true"></i> <a href="/blog/categories/Rust%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0" class="hover:text-blue transition-colors duration-300 text-primary bg-primary/10 hover:text-primary hover:bg-primary/20 rounded-full px-2.5 py-1" aria-label="前往Rust 学习笔记分类"> Rust 学习笔记 </a>  </nav> <script>(()=>{var a=(s,i,o)=>{let r=async()=>{await(await s())()},t=typeof i.value=="object"?i.value:void 0,c={rootMargin:t==null?void 0:t.rootMargin},n=new IntersectionObserver(e=>{for(let l of e)if(l.isIntersecting){n.disconnect(),r();break}},c);for(let e of o.children)n.observe(e)};(self.Astro||(self.Astro={})).visible=a;window.dispatchEvent(new Event("astro:visible"));})();</script><astro-island uid="VGQRw" prefix="r2" component-url="/_astro/SummaryPanel.DlJX8K8D.js" component-export="SummaryPanel" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;summary&quot;:[0,&quot;探讨 Rust 中引用生命周期的普遍规律，揭示所有引用类型（切片、结构体字段、数组元素等）都遵循\&quot;可短不可长\&quot;的生命周期原则。&quot;],&quot;source&quot;:[0,&quot;description&quot;],&quot;className&quot;:[0,&quot;mt-2&quot;]}" ssr client="visible" opts="{&quot;name&quot;:&quot;SummaryPanel&quot;,&quot;value&quot;:true}" await-children><div class="overflow-hidden rounded-lg mt-2"><button class="bg-foreground/5 flex w-full cursor-pointer items-center justify-between px-4 py-3 transition-all duration-250 hover:bg-foreground/10 rounded-lg" aria-expanded="false" aria-controls="summary-panel-content"><div class="text-muted-foreground flex items-center gap-1.5 text-sm font-medium"><span class="transition-transform duration-300"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="text-primary size-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M21 18H6C5.44772 18 5 18.4477 5 19C5 19.5523 5.44772 20 6 20H21V22H6C4.34315 22 3 20.6569 3 19V4C3 2.89543 3.89543 2 5 2H21V18ZM16 9V7H8V9H16Z"></path></svg></span>人工摘要</div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="text-muted-foreground size-4 transition-transform duration-300" aria-hidden="true"><path d="M12 16L6 10H18L12 16Z"></path></svg></button><div id="summary-panel-content" class="grid transition-[grid-template-rows] duration-300 ease-out" style="grid-template-rows:0fr"><div class="overflow-hidden"><div class="bg-foreground/5 text-muted-foreground rounded-b-lg px-4 py-4 text-sm leading-relaxed"><span class="sr-only">探讨 Rust 中引用生命周期的普遍规律，揭示所有引用类型（切片、结构体字段、数组元素等）都遵循&quot;可短不可长&quot;的生命周期原则。</span><p aria-hidden="true"><span></span></p></div></div></div></div><!--astro:end--></astro-island> <article class="prose md:prose-sm dark:prose-invert"> <div class="custom-content" data-config="{&#34;addBlankTarget&#34;:true,&#34;smoothScroll&#34;:true,&#34;addHeadingLevel&#34;:true,&#34;enhanceCodeBlock&#34;:true,&#34;enableCodeCopy&#34;:true,&#34;enableCodeFullscreen&#34;:true,&#34;enableLinkEmbed&#34;:true,&#34;enableTweetEmbed&#34;:true,&#34;enableOGPreview&#34;:true,&#34;previewCacheTime&#34;:3600,&#34;lazyLoadEmbeds&#34;:true}"> <h2 id="前言">前言<a class="anchor-link" href="#前言"><span class="icon icon-link"></span></a></h2>
<p>在学习 Rust 的生命周期时，我们经常会看到切片（slice）作为典型例子：切片的生命周期可以比原始数据短，但不能比原始数据长。但这只是切片的特性吗？实际上，<strong>所有引用类型</strong>都遵循这一规律。</p>
<h2 id="核心原则">核心原则<a class="anchor-link" href="#核心原则"><span class="icon icon-link"></span></a></h2>
<p>Rust 中的引用生命周期遵循一个简单而强大的原则：</p>
<blockquote>
<p><strong>任何”借用”原始数据一部分的引用，生命周期都可以比原始数据短，但绝不能比原始数据长。</strong></p>
</blockquote>
<p>这不仅适用于切片，还适用于所有引用场景。</p>
<h2 id="典型案例">典型案例<a class="anchor-link" href="#典型案例"><span class="icon icon-link"></span></a></h2>
<h3 id="1-切片引用">1. 切片引用<a class="anchor-link" href="#1-切片引用"><span class="icon icon-link"></span></a></h3>
<p>这是最常见的例子：</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> main</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> s </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> String</span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#6F42C1;--shiki-dark:#B392F0">from</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"hello world"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> slice </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">s[</span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#D73A49;--shiki-dark:#F97583">..</span><span style="color:#005CC5;--shiki-dark:#79B8FF">5</span><span style="color:#24292E;--shiki-dark:#E1E4E8">]; </span><span style="color:#6A737D;--shiki-dark:#6A737D">// slice 的生命周期在这个作用域内</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">        println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"{}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, slice); </span><span style="color:#6A737D;--shiki-dark:#6A737D">// 输出: hello</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    } </span><span style="color:#6A737D;--shiki-dark:#6A737D">// slice 在这里结束，但 s 还活着</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"{}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, s); </span><span style="color:#6A737D;--shiki-dark:#6A737D">// s 仍然有效</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
<p><strong>关键点：</strong> <code>slice</code> 的生命周期比 <code>s</code> 短，只要 <code>s</code> 有效，<code>slice</code> 就有效。</p>
<h3 id="2-结构体字段引用">2. 结构体字段引用<a class="anchor-link" href="#2-结构体字段引用"><span class="icon icon-link"></span></a></h3>
<p>如果结构体的某个字段是引用，这个引用的生命周期可以比整个结构体短：</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">struct</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Person</span><span style="color:#24292E;--shiki-dark:#E1E4E8">&#x3C;'</span><span style="color:#6F42C1;--shiki-dark:#B392F0">a</span><span style="color:#24292E;--shiki-dark:#E1E4E8">> {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    name</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">'</span><span style="color:#6F42C1;--shiki-dark:#B392F0">a</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    age</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> u32</span><span style="color:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> main</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> name </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> String</span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#6F42C1;--shiki-dark:#B392F0">from</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Alice"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> person </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Person</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            name</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">name,</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">            age</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 30</span><span style="color:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">        // person.name 的生命周期在这个作用域内</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">        println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"{} is {} years old"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, person</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">name, person</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">age);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    } </span><span style="color:#6A737D;--shiki-dark:#6A737D">// person 和它的引用在这里结束</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Original name: {}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, name); </span><span style="color:#6A737D;--shiki-dark:#6A737D">// name 仍然有效</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
<p><strong>关键点：</strong> <code>person.name</code> 是对 <code>name</code> 的引用，它的生命周期受限于 <code>person</code> 所在的作用域，但 <code>name</code> 本身可以活得更久。</p>
<h3 id="3-数组元素引用">3. 数组元素引用<a class="anchor-link" href="#3-数组元素引用"><span class="icon icon-link"></span></a></h3>
<p>取数组某个元素的引用，其生命周期可以比整个数组短：</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> main</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> arr </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> [</span><span style="color:#005CC5;--shiki-dark:#79B8FF">1</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">2</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">3</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">4</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">5</span><span style="color:#24292E;--shiki-dark:#E1E4E8">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> first </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">arr[</span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">]; </span><span style="color:#6A737D;--shiki-dark:#6A737D">// first 的生命周期在这个作用域内</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">        println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"First element: {}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, first); </span><span style="color:#6A737D;--shiki-dark:#6A737D">// 输出: 1</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    } </span><span style="color:#6A737D;--shiki-dark:#6A737D">// first 在这里结束</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Array: {:?}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, arr); </span><span style="color:#6A737D;--shiki-dark:#6A737D">// arr 仍然有效</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
<p><strong>关键点：</strong> <code>&#x26;arr[0]</code> 只在内层作用域有效，但 <code>arr</code> 可以在外层作用域继续使用。</p>
<h3 id="4-函数参数的局部引用">4. 函数参数的局部引用<a class="anchor-link" href="#4-函数参数的局部引用"><span class="icon icon-link"></span></a></h3>
<p>函数内部可以创建对参数的局部引用，这些引用的生命周期比参数本身短：</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> process_data</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(data</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#6F42C1;--shiki-dark:#B392F0">Vec</span><span style="color:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#6F42C1;--shiki-dark:#B392F0">i32</span><span style="color:#24292E;--shiki-dark:#E1E4E8">>) {</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    // 取 data 的一部分</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> slice </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">data[</span><span style="color:#005CC5;--shiki-dark:#79B8FF">1</span><span style="color:#D73A49;--shiki-dark:#F97583">..</span><span style="color:#005CC5;--shiki-dark:#79B8FF">3</span><span style="color:#24292E;--shiki-dark:#E1E4E8">];</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Slice: {:?}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, slice);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    // slice 的生命周期在这里结束</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    // 但 data 引用仍然有效，可以继续使用</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Full data: {:?}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, data);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> main</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> numbers </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> vec!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">[</span><span style="color:#005CC5;--shiki-dark:#79B8FF">1</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">2</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">3</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">4</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, </span><span style="color:#005CC5;--shiki-dark:#79B8FF">5</span><span style="color:#24292E;--shiki-dark:#E1E4E8">];</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    process_data</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">numbers);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
<p><strong>关键点：</strong> <code>slice</code> 是对 <code>data</code> 的进一步借用，它的生命周期更短，但只要 <code>data</code> 有效，<code>slice</code> 就可以创建和使用。</p>
<h3 id="5-嵌套引用">5. 嵌套引用<a class="anchor-link" href="#5-嵌套引用"><span class="icon icon-link"></span></a></h3>
<p>引用的引用也遵循相同的规律：</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> main</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> x </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 42</span><span style="color:#24292E;--shiki-dark:#E1E4E8">;</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> r1 </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">x;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> r2 </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">r1; </span><span style="color:#6A737D;--shiki-dark:#6A737D">// r2 是对 r1 的引用</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">        println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"r2: {}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, r2); </span><span style="color:#6A737D;--shiki-dark:#6A737D">// 输出: 42</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    } </span><span style="color:#6A737D;--shiki-dark:#6A737D">// r2 在这里结束</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"r1: {}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, r1); </span><span style="color:#6A737D;--shiki-dark:#6A737D">// r1 仍然有效</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"x: {}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, x);   </span><span style="color:#6A737D;--shiki-dark:#6A737D">// x 仍然有效</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
<p><strong>关键点：</strong> 每一层引用的生命周期都可以比它所引用的数据短。</p>
<h2 id="为什么可以更短">为什么可以更短？<a class="anchor-link" href="#为什么可以更短"><span class="icon icon-link"></span></a></h2>
<p>Rust 的借用检查器（borrow checker）会确保：</p>
<ol>
<li><strong>引用有效期内，原始数据不会被释放</strong></li>
<li><strong>引用的生命周期可以比原始数据短</strong>，因为提前结束引用不会影响原始数据</li>
<li><strong>原始数据的生命周期可以延续</strong>，即使引用已经失效</li>
</ol>
<p>这就像租房：</p>
<ul>
<li>房东（原始数据）可以在租约（引用）到期后继续拥有房子</li>
<li>租客（引用）可以提前退租（生命周期更短）</li>
<li>但租客不能在房子被拆除后继续住（引用不能比原始数据长）</li>
</ul>
<h2 id="为什么不能更长">为什么不能更长？<a class="anchor-link" href="#为什么不能更长"><span class="icon icon-link"></span></a></h2>
<p>这是 Rust 所有权系统的核心保证：</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> dangling_reference</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#6F42C1;--shiki-dark:#B392F0">String</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> s </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> String</span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#6F42C1;--shiki-dark:#B392F0">from</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"hello"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    &#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">s </span><span style="color:#6A737D;--shiki-dark:#6A737D">// ❌ 编译错误：s 在函数结束时被释放</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}      </span><span style="color:#6A737D;--shiki-dark:#6A737D">// 但我们试图返回对它的引用</span></span></code></pre>
<p>如果允许引用的生命周期比原始数据长，就会出现<strong>悬垂引用</strong>（dangling reference），指向已经被释放的内存，这是内存安全问题的根源。</p>
<h2 id="实际应用场景">实际应用场景<a class="anchor-link" href="#实际应用场景"><span class="icon icon-link"></span></a></h2>
<h3 id="场景-1临时处理数据片段">场景 1：临时处理数据片段<a class="anchor-link" href="#场景-1临时处理数据片段"><span class="icon icon-link"></span></a></h3>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> analyze_header</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(data</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">[</span><span style="color:#6F42C1;--shiki-dark:#B392F0">u8</span><span style="color:#24292E;--shiki-dark:#E1E4E8">]) {</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    // 只处理前 10 个字节</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    if</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> data</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">len</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() </span><span style="color:#D73A49;--shiki-dark:#F97583">>=</span><span style="color:#005CC5;--shiki-dark:#79B8FF"> 10</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> header </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">data[</span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#D73A49;--shiki-dark:#F97583">..</span><span style="color:#005CC5;--shiki-dark:#79B8FF">10</span><span style="color:#24292E;--shiki-dark:#E1E4E8">];</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">        println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Header: {:?}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, header);</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">        // header 在这里结束，但 data 仍然可用</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    // 继续处理完整数据</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Total length: {}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, data</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">len</span><span style="color:#24292E;--shiki-dark:#E1E4E8">());</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
<h3 id="场景-2链式引用">场景 2：链式引用<a class="anchor-link" href="#场景-2链式引用"><span class="icon icon-link"></span></a></h3>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">struct</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Config</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    settings</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Vec</span><span style="color:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#6F42C1;--shiki-dark:#B392F0">String</span><span style="color:#24292E;--shiki-dark:#E1E4E8">>,</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">impl</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Config</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> get_setting</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="color:#005CC5;--shiki-dark:#79B8FF">self</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, index</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> usize</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Option</span><span style="color:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="color:#6F42C1;--shiki-dark:#B392F0">str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">> {</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#79B8FF">        self</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">settings</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">get</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(index)</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">map</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#D73A49;--shiki-dark:#F97583">|</span><span style="color:#24292E;--shiki-dark:#E1E4E8">s</span><span style="color:#D73A49;--shiki-dark:#F97583">|</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> s</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">as_str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">())</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> main</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> config </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Config</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        settings</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> vec!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">[</span><span style="color:#6F42C1;--shiki-dark:#B392F0">String</span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#6F42C1;--shiki-dark:#B392F0">from</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"debug=true"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">), </span><span style="color:#6F42C1;--shiki-dark:#B392F0">String</span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#6F42C1;--shiki-dark:#B392F0">from</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"port=8080"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)],</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    if</span><span style="color:#D73A49;--shiki-dark:#F97583"> let</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Some</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(setting) </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> config</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">get_setting</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">        println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Setting: {}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, setting);</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">        // setting 引用在这里有效</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    } </span><span style="color:#6A737D;--shiki-dark:#6A737D">// setting 在这里结束</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    // config 仍然有效</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Total settings: {}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, config</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#24292E;--shiki-dark:#E1E4E8">settings</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">len</span><span style="color:#24292E;--shiki-dark:#E1E4E8">());</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
<h3 id="场景-3迭代器中的引用">场景 3：迭代器中的引用<a class="anchor-link" href="#场景-3迭代器中的引用"><span class="icon icon-link"></span></a></h3>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> main</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> words </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> vec!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">[</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">        String</span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#6F42C1;--shiki-dark:#B392F0">from</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"hello"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">        String</span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#6F42C1;--shiki-dark:#B392F0">from</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"world"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">        String</span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#6F42C1;--shiki-dark:#B392F0">from</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"rust"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    ];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    // 迭代器产生的引用生命周期在循环内</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    for</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> word </span><span style="color:#D73A49;--shiki-dark:#F97583">in</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> words</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">iter</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">        // word 是 &#x26;String，只在这次循环迭代中有效</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">        println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"{}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, word);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    // words 仍然有效，可以继续使用</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#B392F0">    println!</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"Total words: {}"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">, words</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">len</span><span style="color:#24292E;--shiki-dark:#E1E4E8">());</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
<h2 id="常见陷阱">常见陷阱<a class="anchor-link" href="#常见陷阱"><span class="icon icon-link"></span></a></h2>
<h3 id="陷阱-1试图返回局部变量的引用">陷阱 1：试图返回局部变量的引用<a class="anchor-link" href="#陷阱-1试图返回局部变量的引用"><span class="icon icon-link"></span></a></h3>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> get_first_word</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(s</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#6F42C1;--shiki-dark:#B392F0">str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#6F42C1;--shiki-dark:#B392F0">str</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> words</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Vec</span><span style="color:#24292E;--shiki-dark:#E1E4E8">&#x3C;</span><span style="color:#D73A49;--shiki-dark:#F97583">&#x26;</span><span style="color:#6F42C1;--shiki-dark:#B392F0">str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">> </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> s</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">split_whitespace</span><span style="color:#24292E;--shiki-dark:#E1E4E8">()</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">collect</span><span style="color:#24292E;--shiki-dark:#E1E4E8">();</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    words[</span><span style="color:#005CC5;--shiki-dark:#79B8FF">0</span><span style="color:#24292E;--shiki-dark:#E1E4E8">] </span><span style="color:#6A737D;--shiki-dark:#6A737D">// ❌ 可能有问题：words 在函数结束时被释放</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
<p>正确做法：</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> get_first_word</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(s</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#6F42C1;--shiki-dark:#B392F0">str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">) </span><span style="color:#D73A49;--shiki-dark:#F97583">-></span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#6F42C1;--shiki-dark:#B392F0">str</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    s</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">split_whitespace</span><span style="color:#24292E;--shiki-dark:#E1E4E8">()</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">next</span><span style="color:#24292E;--shiki-dark:#E1E4E8">()</span><span style="color:#D73A49;--shiki-dark:#F97583">.</span><span style="color:#6F42C1;--shiki-dark:#B392F0">unwrap_or</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">""</span><span style="color:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    // 直接返回原始 s 的切片，生命周期与 s 相同</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
<h3 id="陷阱-2在结构体中存储临时引用">陷阱 2：在结构体中存储临时引用<a class="anchor-link" href="#陷阱-2在结构体中存储临时引用"><span class="icon icon-link"></span></a></h3>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="rust"><code><span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">struct</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Cache</span><span style="color:#24292E;--shiki-dark:#E1E4E8">&#x3C;'</span><span style="color:#6F42C1;--shiki-dark:#B392F0">a</span><span style="color:#24292E;--shiki-dark:#E1E4E8">> {</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    data</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">'</span><span style="color:#6F42C1;--shiki-dark:#B392F0">a</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> str</span><span style="color:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">fn</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> main</span><span style="color:#24292E;--shiki-dark:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">    let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> cache;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#F97583">        let</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> temp </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> String</span><span style="color:#D73A49;--shiki-dark:#F97583">::</span><span style="color:#6F42C1;--shiki-dark:#B392F0">from</span><span style="color:#24292E;--shiki-dark:#E1E4E8">(</span><span style="color:#032F62;--shiki-dark:#9ECBFF">"temporary"</span><span style="color:#24292E;--shiki-dark:#E1E4E8">);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">        cache </span><span style="color:#D73A49;--shiki-dark:#F97583">=</span><span style="color:#6F42C1;--shiki-dark:#B392F0"> Cache</span><span style="color:#24292E;--shiki-dark:#E1E4E8"> { data</span><span style="color:#D73A49;--shiki-dark:#F97583">:</span><span style="color:#D73A49;--shiki-dark:#F97583"> &#x26;</span><span style="color:#24292E;--shiki-dark:#E1E4E8">temp };</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">        // ❌ 编译错误：temp 在这里被释放</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6A737D">    // println!("{}", cache.data); // cache.data 会成为悬垂引用</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
<h2 id="总结">总结<a class="anchor-link" href="#总结"><span class="icon icon-link"></span></a></h2>
<h3 id="核心要点">核心要点<a class="anchor-link" href="#核心要点"><span class="icon icon-link"></span></a></h3>
<ol>
<li>
<p><strong>普遍规律</strong>：所有引用类型都遵循”可短不可长”的生命周期原则</p>
<ul>
<li>切片引用</li>
<li>结构体字段引用</li>
<li>数组元素引用</li>
<li>函数参数的局部引用</li>
<li>嵌套引用</li>
</ul>
</li>
<li>
<p><strong>可以更短的原因</strong>：</p>
<ul>
<li>引用提前结束不影响原始数据</li>
<li>原始数据可以在引用失效后继续存在</li>
<li>符合 Rust 的内存安全保证</li>
</ul>
</li>
<li>
<p><strong>不能更长的原因</strong>：</p>
<ul>
<li>防止悬垂引用</li>
<li>确保引用始终指向有效内存</li>
<li>Rust 所有权系统的核心保证</li>
</ul>
</li>
<li>
<p><strong>实践建议</strong>：</p>
<ul>
<li>理解引用的生命周期本质</li>
<li>避免创建比原始数据更长的引用</li>
<li>利用作用域控制引用的生命周期</li>
<li>使用借用检查器的错误提示定位问题</li>
</ul>
</li>
</ol>
<h3 id="记忆口诀">记忆口诀<a class="anchor-link" href="#记忆口诀"><span class="icon icon-link"></span></a></h3>
<p><strong>借用可短不可长，原数据寿命是底线。</strong></p>
<h3 id="延伸思考">延伸思考<a class="anchor-link" href="#延伸思考"><span class="icon icon-link"></span></a></h3>
<ul>
<li>生命周期标注（<code>'a</code>）是如何帮助编译器检查的？</li>
<li>静态生命周期（<code>'static</code>）为什么可以”永久存在”？</li>
<li>如何在复杂数据结构中管理多个引用的生命周期？</li>
</ul>
<p>希望这篇文章能帮助你全面理解 Rust 中引用生命周期的普遍规律，而不只是局限于切片这一个例子！</p>
<hr>
<p><strong>提示：</strong> 生命周期是 Rust 最具特色的概念之一，建议结合实际代码练习，多尝试编译器的错误提示，你会逐渐形成直觉。</p> </div>  <astro-island uid="Z1v8zuY" prefix="r33" component-url="/_astro/EmbedHydrator.D40_hYkC.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{}" ssr client="load" opts="{&quot;name&quot;:&quot;EmbedHydrator&quot;,&quot;value&quot;:true}"></astro-island> <script type="module" src="/_astro/CustomContent.astro_astro_type_script_index_0_lang.BK5nV6XY.js"></script> </article> <astro-island uid="wBKw9" prefix="r3" component-url="/_astro/GiscusComments.BNQOQ1R1.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{}" ssr client="load" opts="{&quot;name&quot;:&quot;GiscusComments&quot;,&quot;value&quot;:true}" await-children><div class="w-full pb-12"></div><!--astro:end--></astro-island> </div>  <div class="tablet:grid-cols-1 grid grid-cols-2 gap-4 px-10 md:px-6"> <div class="flex flex-col gap-4"> <h2 class="text-foreground/80 text-2xl font-semibold">随机文章</h2> <div class="flex flex-col gap-2"> <a href="/blog/post/21" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"> <span class="text-foreground/30 shrink-0 font-mono">1</span> <div class="flex min-w-0 flex-col gap-0.5"> <div class="text-foreground/50 truncate text-xs">技术教程</div> <div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">Rust Cow（Clone-On-Write）学习笔记：理解 Borrowed 状态</div> </div> </a><a href="/blog/post/6" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"> <span class="text-foreground/30 shrink-0 font-mono">2</span> <div class="flex min-w-0 flex-col gap-0.5"> <div class="text-foreground/50 truncate text-xs">技术教程</div> <div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">表格拖拽方法手写</div> </div> </a><a href="/blog/post/2" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"> <span class="text-foreground/30 shrink-0 font-mono">3</span> <div class="flex min-w-0 flex-col gap-0.5"> <div class="text-foreground/50 truncate text-xs">技术教程</div> <div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">不到半个月就要变猫了</div> </div> </a><a href="/blog/post/3" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"> <span class="text-foreground/30 shrink-0 font-mono">4</span> <div class="flex min-w-0 flex-col gap-0.5"> <div class="text-foreground/50 truncate text-xs">技术教程</div> <div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">CenOS-7.6搭建pptp服务</div> </div> </a><a href="/blog/post/8" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"> <span class="text-foreground/30 shrink-0 font-mono">5</span> <div class="flex min-w-0 flex-col gap-0.5"> <div class="text-foreground/50 truncate text-xs">技术教程</div> <div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">前端链表运用场景</div> </div> </a> </div> </div> <div class="flex flex-col gap-4"> <h2 class="text-foreground/80 text-2xl font-semibold"></h2> <div class="flex flex-col gap-2 -mt-4 pt-12 md:-mt-5 md:pt-0"> <a href="/blog/post/1" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"> <span class="text-foreground/30 shrink-0 font-mono">6</span> <div class="flex min-w-0 flex-col gap-0.5"> <div class="text-foreground/50 truncate text-xs">技术教程</div> <div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">不知道怎么过年</div> </div> </a><a href="/blog/post/5" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"> <span class="text-foreground/30 shrink-0 font-mono">7</span> <div class="flex min-w-0 flex-col gap-0.5"> <div class="text-foreground/50 truncate text-xs">技术教程</div> <div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">js循环依赖对象深拷贝</div> </div> </a><a href="/blog/post/10" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"> <span class="text-foreground/30 shrink-0 font-mono">8</span> <div class="flex min-w-0 flex-col gap-0.5"> <div class="text-foreground/50 truncate text-xs">技术教程</div> <div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">关于Vue3如何判断父组件给子组件传了插槽</div> </div> </a><a href="/blog/post/13" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"> <span class="text-foreground/30 shrink-0 font-mono">9</span> <div class="flex min-w-0 flex-col gap-0.5"> <div class="text-foreground/50 truncate text-xs">生活日常</div> <div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">发烧了呜呜呜</div> </div> </a><a href="/blog/post/14" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"> <span class="text-foreground/30 shrink-0 font-mono">10</span> <div class="flex min-w-0 flex-col gap-0.5"> <div class="text-foreground/50 truncate text-xs">技术教程</div> <div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">React Effect 依赖优化最佳实践</div> </div> </a> </div> </div> </div> <footer class="mt-auto pb-6 md:pb-4" data-astro-cid-35ed7um5> <div class="mx-auto flex flex-col items-center gap-3 px-6 md:px-3 max-w-7xl" data-astro-cid-35ed7um5> <!-- Site Stats --> <div class="text-muted-foreground flex flex-wrap items-center justify-center gap-6 text-sm md:gap-4" data-astro-cid-35ed7um5> <button class="flex items-center gap-2 opacity-75 transition-opacity duration-300 hover:opacity-100" title="站点总字数" data-astro-cid-35ed7um5> <i class="fa-regular fa-file-lines text-sm" aria-hidden="true" data-astro-cid-35ed7um5></i> <span class="font-medium" data-astro-cid-35ed7um5>19k</span> <span class="text-xs" data-astro-cid-35ed7um5>字</span> </button> <div class="bg-muted-foreground/30 h-4 w-px" data-astro-cid-35ed7um5></div> <button class="flex items-center gap-2 opacity-75 transition-opacity duration-300 hover:opacity-100" title="站点阅读时长" data-astro-cid-35ed7um5> <i class="fa-regular fa-clock text-sm" aria-hidden="true" data-astro-cid-35ed7um5></i> <span class="font-medium" data-astro-cid-35ed7um5>1:49</span> </button> <div class="bg-muted-foreground/30 h-4 w-px" data-astro-cid-35ed7um5></div> <button class="flex items-center gap-2 opacity-75 transition-opacity duration-300 hover:opacity-100" title="文章总数" data-astro-cid-35ed7um5> <i class="fa-regular fa-newspaper text-sm" aria-hidden="true" data-astro-cid-35ed7um5></i> <span class="font-medium" data-astro-cid-35ed7um5>23</span> <span class="text-xs" data-astro-cid-35ed7um5>篇</span> </button> </div> <!-- Copyright --> <div class="text-muted-foreground flex items-center gap-0.5 text-sm" data-astro-cid-35ed7um5> <span class="opacity-75" data-astro-cid-35ed7um5>©</span> <span class="font-medium opacity-75" data-astro-cid-35ed7um5>2022</span>  <span class="opacity-50" data-astro-cid-35ed7um5>-</span> <span class="font-medium opacity-75" itemprop="copyrightYear" data-astro-cid-35ed7um5> 2025 </span>  <svg class="mx-1 size-5 animate-spin text-[#FFC0CB] duration-10000" viewBox="0 0 512 512" fill="currentColor"><g><path fill="currentColor" d="M330.555,101.873c0-34.164-13.767-65.108-36.047-87.622c-2.432-2.465-9.63-4.349-14.212,3.466
		c-4.589,7.808-17.205,27.431-17.205,27.431c-1.534,2.438-4.219,3.918-7.089,3.918c-2.883,0-5.555-1.48-7.089-3.918
		c0,0-12.623-19.623-17.205-27.431c-4.582-7.815-11.781-5.931-14.219-3.466c-22.274,22.514-36.04,53.458-36.04,87.622
		c0,51.02,30.663,94.847,74.553,114.142C299.892,196.72,330.555,152.892,330.555,101.873z"></path><path fill="currentColor" d="M204.51,253.425c-4.78-47.705-36.998-90.409-85.518-106.176c-32.492-10.554-66.177-7.027-94.47,7.205
		c-3.096,1.555-7.117,7.822-1.096,14.589c6.007,6.774,20.766,24.842,20.766,24.842c1.849,2.212,2.432,5.22,1.542,7.952
		c-0.891,2.74-3.13,4.829-5.918,5.528c0,0-22.562,5.945-31.404,7.89c-8.849,1.945-9.281,9.37-7.692,12.445
		c14.527,28.144,39.698,50.801,72.197,61.362C121.436,304.828,172.6,289.212,204.51,253.425z"></path><path fill="currentColor" d="M96.772,362.484c-20.082,27.643-27.136,60.766-22.342,92.074c0.527,3.424,5.233,9.178,13.527,5.554
		c8.308-3.63,30.054-12.088,30.054-12.088c2.672-1.062,5.698-0.692,8.041,1c2.329,1.692,3.623,4.466,3.418,7.335
		c0,0-1.308,23.294-2.199,32.315c-0.883,9.006,6.048,11.712,9.466,11.15c31.252-5.116,60.581-22.054,80.662-49.704
		c29.993-41.266,30.944-94.758,6.781-136.155C177.332,303.773,126.758,321.204,96.772,362.484z"></path><path fill="currentColor" d="M287.824,313.964c-24.165,41.397-23.212,94.888,6.78,136.155c20.082,27.65,49.41,44.588,80.663,49.704
		c3.418,0.562,10.349-2.144,9.466-11.15c-0.89-9.021-2.205-32.315-2.205-32.315c-0.198-2.869,1.102-5.643,3.431-7.335
		c2.322-1.692,5.363-2.062,8.034-1c0,0,21.746,8.458,30.047,12.088c8.294,3.623,13.007-2.13,13.534-5.554
		c4.787-31.308-2.254-64.43-22.342-92.074C385.246,321.204,334.672,303.766,287.824,313.964z"></path><path fill="currentColor" d="M503.6,215.254c-8.849-1.945-31.41-7.89-31.41-7.89c-2.795-0.706-5.027-2.788-5.918-5.528
		c-0.89-2.732-0.308-5.74,1.534-7.952c0,0,14.76-18.068,20.78-24.842c6.014-6.766,1.993-13.034-1.096-14.589
		c-28.301-14.232-61.978-17.76-94.485-7.205c-48.519,15.767-80.731,58.472-85.512,106.176
		c31.91,35.787,83.067,51.403,131.593,35.636c32.492-10.561,57.67-33.218,72.191-61.362
		C512.867,224.624,512.449,217.199,503.6,215.254z"></path></g></svg> <span class="author font-medium opacity-75" itemprop="copyrightHolder" data-astro-cid-35ed7um5> snow @snow </span> </div> <!-- Powered By --> <div class="text-muted-foreground/80 flex items-center gap-2 text-xs" data-astro-cid-35ed7um5> <span class="opacity-75" data-astro-cid-35ed7um5>Powered by theme</span> <a href="https://github.com/cosZone/astro-koharu" target="_blank" class="footer-link font-medium transition-all duration-300" data-astro-cid-35ed7um5>
astro-koharu
</a> <span class="opacity-50" data-astro-cid-35ed7um5>·</span> <span class="opacity-75" data-astro-cid-35ed7um5>Inspired by</span> <a href="https://github.com/amehime/hexo-theme-shoka" target="_blank" class="footer-link font-medium transition-all duration-300" data-astro-cid-35ed7um5>
Shoka
</a> </div> </div> </footer>  </div> </div> </div>  </main> <div id="floating-nav" class="text-primary fixed right-4 bottom-4 z-50 flex flex-col gap-2" data-expanded="true" data-astro-cid-uwaxo4qb> <div id="nav-content" class="flex scale-y-100 flex-col gap-2 opacity-100" data-astro-cid-uwaxo4qb> <button id="scroll-to-top" class="bg-background/80 hover:bg-background rounded-full p-2 shadow-lg backdrop-blur-sm transition-colors duration-200" aria-label="回到顶部" title="回到顶部" data-tooltip-interactive="false" data-tooltip-placement="left" data-astro-cid-uwaxo4qb> <i class="fa-solid fa-angle-up text-lg" aria-hidden="true" data-astro-cid-uwaxo4qb></i> </button> <button id="scroll-to-bottom" class="bg-background/80 hover:bg-background rounded-full p-2 shadow-lg backdrop-blur-sm transition-colors duration-200" aria-label="滚到底部" title="滚到底部" data-tooltip-interactive="false" data-tooltip-placement="left" data-astro-cid-uwaxo4qb> <i class="fa-solid fa-angle-down text-lg" aria-hidden="true" data-astro-cid-uwaxo4qb></i> </button> </div> <button id="toggle-nav" class="flex-center bg-background/80 hover:bg-background size-9 rounded-full shadow-lg backdrop-blur-sm transition-colors duration-200" aria-label="展开/收起工具栏" title="展开/收起工具栏" data-tooltip-interactive="false" data-tooltip-placement="left" data-astro-cid-uwaxo4qb> <i class="fa-solid fa-wand-magic-sparkles menu-nav-icon hidden text-sm transition-transform duration-300" aria-hidden="true" data-astro-cid-uwaxo4qb></i> <i class="fa-solid fa-xmark close-nav-icon text-sm transition-transform duration-300" aria-hidden="true" data-astro-cid-uwaxo4qb></i> </button> </div> <script type="module" src="/_astro/FloatingGroup.astro_astro_type_script_index_0_lang.Cau6IhNU.js"></script>  <!-- 遮罩层 --><div id="drawer-overlay" class="fixed inset-0 z-40 hidden bg-black/50" role="presentation" aria-hidden="true"></div> <!-- 移动端抽屉导航 --> <div id="mobile-drawer" class="bg-gradient-start tablet:flex fixed inset-y-0 left-0 z-50 hidden h-screen w-[70vw] min-w-64 -translate-x-full transform px-4 pt-6 shadow-lg backdrop-blur-sm transition-transform duration-300 md:px-0" role="dialog" aria-label="导航菜单" aria-modal="true"> <div class="flex h-full w-full flex-col overflow-auto"> <button id="close-drawer" aria-label="关闭菜单" class="invisible"> <i class="fa-solid fa-xmark text-xl" aria-hidden="true"></i> </button> <div class="page-home-sider shadow-home-sider sticky top-0 self-start max-w-64 flex-col overflow-auto h-screen items-center tablet:flex mt-4 hidden w-full min-w-full p-0" data-astro-cid-nxumbhks> <astro-island uid="ZITM8i" prefix="r25" component-url="/_astro/HomeSiderSegmented.Ci8JRtoo.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;className&quot;:[0,&quot;my-4 flex w-full justify-between text-sm/6&quot;],&quot;itemClass&quot;:[0,&quot;grow&quot;],&quot;defaultValue&quot;:[0,&quot;directory&quot;],&quot;id&quot;:[0,&quot;inner-home-sider&quot;],&quot;data-astro-cid-nxumbhks&quot;:[0,true]}" ssr client="load" opts="{&quot;name&quot;:&quot;HomeSiderSegmented&quot;,&quot;value&quot;:true}" await-children><div class="cursor-pointer rounded-sm bg-black/8 p-1 font-semibold backdrop-blur-lg select-none my-4 flex w-full justify-between text-sm/6"><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs opacity-50 grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM15.8329 7.33748C16.0697 7.17128 16.3916 7.19926 16.5962 7.40381C16.8002 7.60784 16.8267 7.92955 16.6587 8.16418C14.479 11.2095 13.2796 12.8417 13.0607 13.0607C12.4749 13.6464 11.5251 13.6464 10.9393 13.0607C10.3536 12.4749 10.3536 11.5251 10.9393 10.9393C11.3126 10.5661 12.9438 9.36549 15.8329 7.33748ZM17.5 11C18.0523 11 18.5 11.4477 18.5 12C18.5 12.5523 18.0523 13 17.5 13C16.9477 13 16.5 12.5523 16.5 12C16.5 11.4477 16.9477 11 17.5 11ZM6.5 11C7.05228 11 7.5 11.4477 7.5 12C7.5 12.5523 7.05228 13 6.5 13C5.94772 13 5.5 12.5523 5.5 12C5.5 11.4477 5.94772 11 6.5 11ZM8.81802 7.40381C9.20854 7.79433 9.20854 8.4275 8.81802 8.81802C8.4275 9.20854 7.79433 9.20854 7.40381 8.81802C7.01328 8.4275 7.01328 7.79433 7.40381 7.40381C7.79433 7.01328 8.4275 7.01328 8.81802 7.40381ZM12 5.5C12.5523 5.5 13 5.94772 13 6.5C13 7.05228 12.5523 7.5 12 7.5C11.4477 7.5 11 7.05228 11 6.5C11 5.94772 11.4477 5.5 12 5.5Z"></path></svg></span></div><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs text-primary-foreground grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M5.75024 3.5H4.71733L3.25 3.89317V5.44582L4.25002 5.17782L4.25018 8.5H3V10H7V8.5H5.75024V3.5ZM10 4H21V6H10V4ZM10 11H21V13H10V11ZM10 18H21V20H10V18ZM2.875 15.625C2.875 14.4514 3.82639 13.5 5 13.5C6.17361 13.5 7.125 14.4514 7.125 15.625C7.125 16.1106 6.96183 16.5587 6.68747 16.9167L6.68271 16.9229L5.31587 18.5H7V20H3.00012L2.99959 18.8786L5.4717 16.035C5.5673 15.9252 5.625 15.7821 5.625 15.625C5.625 15.2798 5.34518 15 5 15C4.67378 15 4.40573 15.2501 4.37747 15.5688L4.3651 15.875H2.875V15.625Z"></path></svg></span><span class="overflow-hidden whitespace-nowrap" style="width:auto;opacity:1">文章目录</span><div class="bg-gradient-shoka-button absolute inset-0 -z-10 rounded-sm" style="will-change:transform"></div></div><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs opacity-50 grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM7 6H11V10H7V6ZM7 12H17V14H7V12ZM7 16H17V18H7V16ZM13 7H17V9H13V7Z"></path></svg></span></div></div><!--astro:end--></astro-island> <sider-content class="vertical-scrollbar scroll-gutter-stable block w-full flex-1 overflow-x-hidden overflow-y-auto md:pt-4 md:pl-3" data-type="post" data-default-type="directory" data-astro-cid-nxumbhks="true"> <div slot="info" class="sider-slot" data-slot-type="info" data-astro-cid-nxumbhks> <div class="flex flex-col items-center" data-home-info-container="home-info-baci25hqu" data-astro-cid-dafxfumg> <div class="h-40 w-40 rounded-full" data-astro-cid-dafxfumg> <img class="shadow-card-darker hover:animate-shake h-full w-full rounded-full transition" src="/img/724d7fb480c8ac0db472ca5c7e36d239.jpg" alt="snow avatar" loading="eager" fetchpriority="high" data-astro-cid-dafxfumg> </div> <p class="mt-2" data-astro-cid-dafxfumg>snow</p> <p class="text-muted-foreground mt-3 text-center" data-astro-cid-dafxfumg>ACG / 养猫人 / 菜逼 / 前端什锦</p> <!-- TODO: use CSS squircle corner-shape replace the rounded-xl border-radius with a squircle corner-shape (https://www.squircle.style/) --><div class="mt-2 grid grid-cols-3 gap-2" data-astro-cid-xsmk7zsr> <div data-astro-cid-xsmk7zsr> <a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color: #191717" data-platform="github" href="https://github.com/XueHua-s" title="GitHub" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="GitHub" data-astro-cid-xsmk7zsr> <i class="fa-brands fa-github social-icon" aria-hidden="true" data-astro-cid-xsmk7zsr></i> <span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0" data-astro-cid-xsmk7zsr></span> </a> </div><div data-astro-cid-xsmk7zsr> <a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color: #4b9ae4" data-platform="x" href="https://x.com/xiaoxueljx?s=21" title="X (推特)" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="X (推特)" data-astro-cid-xsmk7zsr> <i class="fa-brands fa-x-twitter social-icon" aria-hidden="true" data-astro-cid-xsmk7zsr></i> <span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0" data-astro-cid-xsmk7zsr></span> </a> </div><div data-astro-cid-xsmk7zsr> <a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color: #55acd5" data-platform="email" href="mailto:xuehualjx@gmail.com" title="Email" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="Email" data-astro-cid-xsmk7zsr> <i class="fa-regular fa-envelope social-icon" aria-hidden="true" data-astro-cid-xsmk7zsr></i> <span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0" data-astro-cid-xsmk7zsr></span> </a> </div> </div>  <div class="text-muted-foreground mt-3 flex justify-center text-center text-sm/4 whitespace-nowrap select-none dark:text-white/80" data-astro-cid-dafxfumg> <a href="/blog" class="hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition" data-astro-cid-dafxfumg> <span class="text-lg/5 font-bold" data-astro-cid-dafxfumg>23</span>
文章
</a> <div class="bg-muted-foreground mx-3 w-px" data-astro-cid-dafxfumg></div> <a href="/blog/categories" aria-label="分类" class="hover:text-blue" data-astro-cid-dafxfumg> <p class="flex cursor-pointer flex-col gap-2 p-1 transition" data-astro-cid-dafxfumg> <span class="text-lg/5 font-bold" data-astro-cid-dafxfumg>5</span>
分类
</p> </a> <div class="bg-muted-foreground mx-3 w-px" data-astro-cid-dafxfumg></div> <a href="/blog/tags" class="hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition" data-astro-cid-dafxfumg> <span class="text-lg/5 font-bold" data-astro-cid-dafxfumg>38</span>
标签
</a> </div> <div class="mt-6 flex w-full flex-col items-center gap-2.5" data-astro-cid-dafxfumg> <a href="/blog" aria-label="首页" data-astro-cid-dafxfumg="true" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"> <i class="mr-1.5 fa-solid fa-house-chimney" aria-hidden="true" data-astro-cid-dafxfumg></i>首页 </a><div class="bg-foreground/10 flex w-40 flex-col rounded-xl opacity-75 transition-all duration-300 hover:opacity-100" data-collapsible data-astro-cid-dafxfumg> <button class="flex-center hover:bg-foreground/5 h-12 w-full cursor-pointer rounded-xl transition-colors" data-collapse-trigger="home-info-baci25hqu-collapse-1" aria-expanded="false" aria-label="文章菜单" type="button" data-astro-cid-dafxfumg> <i class="mr-1.5 fa-solid fa-pen-nib" aria-hidden="true" data-astro-cid-dafxfumg></i> 文章 <i class="fa-solid fa-caret-down ml-2 text-base transition-transform duration-300" data-collapse-icon="home-info-baci25hqu-collapse-1" aria-hidden="true" data-astro-cid-dafxfumg></i> </button> <div class="collapse-hidden" data-collapse-content="home-info-baci25hqu-collapse-1" data-astro-cid-dafxfumg> <div class="flex flex-col items-center" data-astro-cid-dafxfumg> <a href="/blog/categories" aria-label="分类" data-astro-cid-dafxfumg="true" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"> <i class="mr-1.5 fa-solid fa-layer-group" aria-hidden="true" data-astro-cid-dafxfumg></i>分类 </a><a href="/blog/tags" aria-label="标签" data-astro-cid-dafxfumg="true" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"> <i class="mr-1.5 fa-solid fa-tags" aria-hidden="true" data-astro-cid-dafxfumg></i>标签 </a> </div> </div> </div><a href="/blog/friends" aria-label="友链" data-astro-cid-dafxfumg="true" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"> <i class="mr-1.5 fa-solid fa-link" aria-hidden="true" data-astro-cid-dafxfumg></i>友链 </a><a href="/blog/about" aria-label="关于" data-astro-cid-dafxfumg="true" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"> <i class="mr-1.5 fa-regular fa-circle-user" aria-hidden="true" data-astro-cid-dafxfumg></i>关于 </a> </div> </div>   </div> <div slot="directory" class="sider-slot" data-slot-type="directory" data-astro-cid-nxumbhks> <astro-island uid="iWeBV" prefix="r26" component-url="/_astro/index.177fiMIz.js" component-export="TableOfContents" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;enableNumbering&quot;:[0,true],&quot;sourceHeadings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;核心原则&quot;],&quot;text&quot;:[0,&quot;核心原则&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;典型案例&quot;],&quot;text&quot;:[0,&quot;典型案例&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-切片引用&quot;],&quot;text&quot;:[0,&quot;1. 切片引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-结构体字段引用&quot;],&quot;text&quot;:[0,&quot;2. 结构体字段引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-数组元素引用&quot;],&quot;text&quot;:[0,&quot;3. 数组元素引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;4-函数参数的局部引用&quot;],&quot;text&quot;:[0,&quot;4. 函数参数的局部引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;5-嵌套引用&quot;],&quot;text&quot;:[0,&quot;5. 嵌套引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;为什么可以更短&quot;],&quot;text&quot;:[0,&quot;为什么可以更短？&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;为什么不能更长&quot;],&quot;text&quot;:[0,&quot;为什么不能更长？&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;实际应用场景&quot;],&quot;text&quot;:[0,&quot;实际应用场景&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-1临时处理数据片段&quot;],&quot;text&quot;:[0,&quot;场景 1：临时处理数据片段&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-2链式引用&quot;],&quot;text&quot;:[0,&quot;场景 2：链式引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-3迭代器中的引用&quot;],&quot;text&quot;:[0,&quot;场景 3：迭代器中的引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;常见陷阱&quot;],&quot;text&quot;:[0,&quot;常见陷阱&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;陷阱-1试图返回局部变量的引用&quot;],&quot;text&quot;:[0,&quot;陷阱 1：试图返回局部变量的引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;陷阱-2在结构体中存储临时引用&quot;],&quot;text&quot;:[0,&quot;陷阱 2：在结构体中存储临时引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;总结&quot;],&quot;text&quot;:[0,&quot;总结&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;核心要点&quot;],&quot;text&quot;:[0,&quot;核心要点&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;记忆口诀&quot;],&quot;text&quot;:[0,&quot;记忆口诀&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;延伸思考&quot;],&quot;text&quot;:[0,&quot;延伸思考&quot;]}]]],&quot;data-astro-cid-nxumbhks&quot;:[0,true]}" ssr client="idle" opts="{&quot;name&quot;:&quot;TableOfContents&quot;,&quot;value&quot;:true}" await-children><nav class="toc-container max-h-[90dvh] overflow-auto " aria-label="文章目录"><div class="space-y-1 pr-2"><div class="heading-tree-item relative"><a href="#%E5%89%8D%E8%A8%80" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="2" aria-label="前言"><span class="heading-text block flex-1 truncate leading-relaxed">前言</span></a></div><div class="heading-tree-item relative"><a href="#%E6%A0%B8%E5%BF%83%E5%8E%9F%E5%88%99" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="2" aria-label="核心原则"><span class="heading-text block flex-1 truncate leading-relaxed">核心原则</span></a></div><div class="heading-tree-item relative"><a href="#%E5%85%B8%E5%9E%8B%E6%A1%88%E4%BE%8B" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.5rem" data-level="2" aria-label="典型案例"><span class="heading-text block flex-1 truncate leading-relaxed">典型案例</span></a></div><div class="heading-tree-item relative"><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%8F%AF%E4%BB%A5%E6%9B%B4%E7%9F%AD" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="2" aria-label="为什么可以更短？"><span class="heading-text block flex-1 truncate leading-relaxed">为什么可以更短？</span></a></div><div class="heading-tree-item relative"><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E6%9B%B4%E9%95%BF" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="2" aria-label="为什么不能更长？"><span class="heading-text block flex-1 truncate leading-relaxed">为什么不能更长？</span></a></div><div class="heading-tree-item relative"><a href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.5rem" data-level="2" aria-label="实际应用场景"><span class="heading-text block flex-1 truncate leading-relaxed">实际应用场景</span></a></div><div class="heading-tree-item relative"><a href="#%E5%B8%B8%E8%A7%81%E9%99%B7%E9%98%B1" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.5rem" data-level="2" aria-label="常见陷阱"><span class="heading-text block flex-1 truncate leading-relaxed">常见陷阱</span></a></div><div class="heading-tree-item relative"><a href="#%E6%80%BB%E7%BB%93" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.5rem" data-level="2" aria-label="总结"><span class="heading-text block flex-1 truncate leading-relaxed">总结</span></a></div></div></nav><!--astro:end--></astro-island> </div> <div slot="series" class="sider-slot" data-slot-type="series" data-astro-cid-nxumbhks> <astro-island uid="Z1vm6mB" prefix="r27" component-url="/_astro/SeriesPostList.pzWr_qfk.js" component-export="SeriesPostList" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;posts&quot;:[1,[[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;rust算术运算的panic陷阱-从取模零说起&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Rust 算术运算的 Panic 陷阱：从取模零说起&quot;],&quot;description&quot;:[0,&quot;在刷 Rust 算法题时发现了一个独特现象：对零取模会直接导致程序 panic！这与其他语言的行为截然不同。本文深入探讨 Rust 中会导致 panic 的算术运算场景，包括除零、整数溢出、INT_MIN/-1 等特殊情况，以及 Rust 提供的 checked_、wrapping_、saturating_ 等安全替代方案。理解这些行为对于编写健壮的 Rust 程序至关重要。&quot;],&quot;date&quot;:[3,&quot;2025-12-02T10:00:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;算法&quot;],[0,&quot;安全&quot;],[0,&quot;Panic&quot;],[0,&quot;算术运算&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;]}],&quot;body&quot;:[0,&quot;## 前言\n\n今天在刷 Rust 算法题时，遇到了一个让我印象深刻的情况：**当我尝试对 0 取模时，程序直接 panic 了！**\n\n```rust\nfn main() {\n    let x = 10;\n    let y = 0;\n    let result = x % y;  // 💥 thread &#39;main&#39; panicked at &#39;attempt to calculate the remainder with a divisor of zero&#39;\n}\n```\n\n这个行为在其他语言中并不常见。比如在 JavaScript 中，`10 % 0` 会返回 `NaN`；在 Python 中会抛出 `ZeroDivisionError` 异常（可以被捕获）。而 **Rust 选择直接 panic，整个程序崩溃，无法通过普通的错误处理机制捕获**。\n\n这引发了我的好奇：Rust 中还有哪些类似的\&quot;地雷\&quot;？让我们一探究竟。\n\n## Rust 中会导致 Panic 的算术运算\n\n### 1. 除法和取模运算的零除错误\n\n在 Rust 中，**整数的除法和取模运算遇到零除数时会无条件 panic**：\n\n```rust\nfn main() {\n    let a = 10;\n    let b = 0;\n\n    // 💥 除法遇到零：panic!\n    // let div = a / b;\n\n    // 💥 取模遇到零：panic!\n    // let rem = a % b;\n\n    println!(\&quot;这行代码永远不会执行\&quot;);\n}\n```\n\n**为什么会这样？**\n\nRust 的设计哲学是：**宁可 panic 也不产生未定义行为（Undefined Behavior, UB）**。在很多底层语言（如 C/C++）中，除以零会导致 UB，这可能造成：\n- 程序段错误（Segmentation Fault）\n- 返回垃圾值\n- 安全漏洞\n\nRust 通过显式 panic 来避免这些不可预测的行为，让错误在第一时间暴露出来。\n\n**浮点数例外**\n\n有趣的是，**浮点数的除零操作不会 panic**，而是遵循 IEEE 754 标准：\n\n```rust\nfn main() {\n    let x = 10.0;\n    let y = 0.0;\n\n    println!(\&quot;{}\&quot;, x / y);      // ✅ inf (正无穷)\n    println!(\&quot;{}\&quot;, -x / y);     // ✅ -inf (负无穷)\n    println!(\&quot;{}\&quot;, y / y);      // ✅ NaN (Not a Number)\n\n    // 浮点数取模也不会 panic，但会返回 NaN\n    println!(\&quot;{}\&quot;, x % y);      // ✅ NaN\n}\n```\n\n### 2. 整数溢出的特殊边界情况\n\n还有一个更隐蔽的陷阱：**`INT_MIN / -1` 和 `INT_MIN % -1` 也会 panic**！\n\n```rust\nfn main() {\n    let min = i8::MIN;  // -128\n    let divisor = -1;\n\n    // 💥 这会 panic！\n    // let result = min / divisor;\n\n    // 💥 这也会 panic！\n    // let remainder = min % divisor;\n}\n```\n\n**为什么？**\n\n对于 8 位有符号整数 `i8`：\n- 最小值：`i8::MIN = -128`\n- 最大值：`i8::MAX = 127`\n\n当我们计算 `-128 / -1` 时，数学结果应该是 `128`，但这**超出了 `i8` 的表示范围**（最大只能到 127），导致溢出。Rust 选择 panic 而不是返回错误的结果。\n\n```rust\nfn demonstrate_overflow() {\n    // 对于不同的整数类型，都存在这个问题\n    println!(\&quot;i8::MIN  / -1 会 panic: {}\&quot;, i8::MIN);   // -128 / -1 = 128 (溢出!)\n    println!(\&quot;i16::MIN / -1 会 panic: {}\&quot;, i16::MIN);  // -32768 / -1 = 32768 (溢出!)\n    println!(\&quot;i32::MIN / -1 会 panic: {}\&quot;, i32::MIN);  // -2147483648 / -1 = 2147483648 (溢出!)\n    println!(\&quot;i64::MIN / -1 会 panic: {}\&quot;, i64::MIN);  // 同理\n}\n```\n\n### 3. Debug 模式下的整数溢出\n\nRust 在 **debug 模式和 release 模式下对整数溢出的处理不同**：\n\n```rust\nfn main() {\n    let max = u8::MAX;  // 255\n\n    // Debug 模式：💥 panic!\n    // Release 模式：✅ 环绕到 0 (wrapping)\n    let result = max + 1;\n\n    println!(\&quot;Result: {}\&quot;, result);\n}\n```\n\n**行为差异：**\n\n| 模式 | 溢出行为 | 原因 |\n|------|----------|------|\n| **Debug** (`cargo build`) | Panic | 帮助开发者尽早发现 bug |\n| **Release** (`cargo build --release`) | 二进制补码环绕 | 性能优化，避免运行时检查开销 |\n\n在 release 模式下：\n```rust\nu8::MAX + 1      // =&gt; 0   (255 + 1 环绕为 0)\nu8::MIN - 1      // =&gt; 255 (0 - 1 环绕为 255)\ni8::MAX + 1      // =&gt; -128 (127 + 1 环绕为 -128)\n```\n\n这意味着：**同样的代码在不同编译模式下可能有完全不同的行为！**\n\n## Rust 的解决方案：显式的溢出处理\n\n为了让开发者能够精确控制溢出行为，Rust 提供了多种方法变体：\n\n### 1. `checked_*` 系列：安全检查，返回 Option\n\n```rust\nfn safe_division(a: i32, b: i32) -&gt; Option&lt;i32&gt; {\n    a.checked_div(b)\n}\n\nfn main() {\n    println!(\&quot;{:?}\&quot;, 10.checked_div(2));   // Some(5)\n    println!(\&quot;{:?}\&quot;, 10.checked_div(0));   // None - 零除返回 None 而不是 panic\n    println!(\&quot;{:?}\&quot;, i32::MIN.checked_div(-1)); // None - 溢出返回 None\n\n    // 其他 checked 方法\n    println!(\&quot;{:?}\&quot;, 255u8.checked_add(1));     // None\n    println!(\&quot;{:?}\&quot;, 0u8.checked_sub(1));       // None\n    println!(\&quot;{:?}\&quot;, 128i8.checked_mul(2));     // None\n    println!(\&quot;{:?}\&quot;, 10.checked_rem(0));        // None - 取模零也返回 None\n}\n```\n\n**适用场景：**\n- 用户输入处理\n- 外部数据验证\n- 需要优雅处理错误的场景\n\n### 2. `wrapping_*` 系列：显式环绕行为\n\n```rust\nfn main() {\n    // 无论 debug 还是 release 模式，都保证环绕行为\n    println!(\&quot;{}\&quot;, 255u8.wrapping_add(1));      // 0\n    println!(\&quot;{}\&quot;, 0u8.wrapping_sub(1));        // 255\n    println!(\&quot;{}\&quot;, 200u8.wrapping_mul(2));      // 144 (400 % 256)\n\n    // 环绕除法：零除仍然会 panic！\n    // println!(\&quot;{}\&quot;, 10.wrapping_div(0));  // 💥 仍然 panic\n\n    // 但 INT_MIN / -1 会环绕而不是 panic\n    println!(\&quot;{}\&quot;, i8::MIN.wrapping_div(-1));   // -128 (环绕到自身)\n}\n```\n\n**适用场景：**\n- 哈希计算\n- 密码学算法\n- 需要明确的模运算语义\n\n### 3. `saturating_*` 系列：饱和到边界值\n\n```rust\nfn main() {\n    // 溢出时返回类型的最大/最小值\n    println!(\&quot;{}\&quot;, 255u8.saturating_add(1));    // 255 (不超过最大值)\n    println!(\&quot;{}\&quot;, 0u8.saturating_sub(1));      // 0   (不低于最小值)\n    println!(\&quot;{}\&quot;, 200u8.saturating_mul(2));    // 255 (饱和到最大值)\n\n    // 有符号整数\n    println!(\&quot;{}\&quot;, 127i8.saturating_add(1));    // 127\n    println!(\&quot;{}\&quot;, (-128i8).saturating_sub(1)); // -128\n\n    // 除法仍然对零除 panic\n    // println!(\&quot;{}\&quot;, 10.saturating_div(0));  // 💥 panic\n}\n```\n\n**适用场景：**\n- 音频/视频处理（音量、亮度限制）\n- 游戏开发（生命值、伤害计算）\n- UI 组件（滚动位置、进度条）\n\n### 4. `overflowing_*` 系列：返回结果和溢出标志\n\n```rust\nfn main() {\n    let (result, overflowed) = 255u8.overflowing_add(1);\n    println!(\&quot;Result: {}, Overflowed: {}\&quot;, result, overflowed);\n    // Result: 0, Overflowed: true\n\n    let (result, overflowed) = 100u8.overflowing_add(50);\n    println!(\&quot;Result: {}, Overflowed: {}\&quot;, result, overflowed);\n    // Result: 150, Overflowed: false\n\n    // 可以用来实现自定义的溢出处理逻辑\n    let (div, overflow) = i8::MIN.overflowing_div(-1);\n    println!(\&quot;Division: {}, Overflow: {}\&quot;, div, overflow);\n    // Division: -128, Overflow: true\n}\n```\n\n**适用场景：**\n- 需要记录溢出事件\n- 实现自定义的错误报告\n- 性能敏感但需要溢出信息的代码\n\n### 5. `strict_*` 系列：总是 Panic（Rust 1.80+）\n\n```rust\nfn main() {\n    // 无论 debug 还是 release，溢出总是 panic\n    // let result = 255u8.strict_add(1);  // 💥 panic in both debug and release\n\n    // 这对于需要严格保证数学正确性的场景很有用\n}\n```\n\n**适用场景：**\n- 金融计算\n- 科学计算\n- 任何不能容忍静默溢出的场景\n\n## 完整的除零安全处理示例\n\n结合上面的知识，我们可以写一个安全的计算器函数：\n\n```rust\n#[derive(Debug, PartialEq)]\nenum CalcError {\n    DivisionByZero,\n    Overflow,\n}\n\nfn safe_calculator(a: i32, b: i32, op: char) -&gt; Result&lt;i32, CalcError&gt; {\n    match op {\n        &#39;+&#39; =&gt; a.checked_add(b).ok_or(CalcError::Overflow),\n        &#39;-&#39; =&gt; a.checked_sub(b).ok_or(CalcError::Overflow),\n        &#39;*&#39; =&gt; a.checked_mul(b).ok_or(CalcError::Overflow),\n        &#39;/&#39; =&gt; {\n            if b == 0 {\n                Err(CalcError::DivisionByZero)\n            } else {\n                a.checked_div(b).ok_or(CalcError::Overflow)\n            }\n        }\n        &#39;%&#39; =&gt; {\n            if b == 0 {\n                Err(CalcError::DivisionByZero)\n            } else {\n                a.checked_rem(b).ok_or(CalcError::Overflow)\n            }\n        }\n        _ =&gt; panic!(\&quot;Unsupported operation\&quot;),\n    }\n}\n\nfn main() {\n    println!(\&quot;{:?}\&quot;, safe_calculator(10, 2, &#39;/&#39;));   // Ok(5)\n    println!(\&quot;{:?}\&quot;, safe_calculator(10, 0, &#39;/&#39;));   // Err(DivisionByZero)\n    println!(\&quot;{:?}\&quot;, safe_calculator(10, 0, &#39;%&#39;));   // Err(DivisionByZero)\n    println!(\&quot;{:?}\&quot;, safe_calculator(i32::MAX, 1, &#39;+&#39;)); // Err(Overflow)\n    println!(\&quot;{:?}\&quot;, safe_calculator(i32::MIN, -1, &#39;/&#39;)); // Err(Overflow)\n}\n```\n\n## Rust vs 其他语言\n\n让我们对比一下不同语言对除零的处理：\n\n| 语言 | `10 / 0` 行为 | `10 % 0` 行为 | 可捕获？ |\n|------|---------------|---------------|----------|\n| **Rust** | Panic（程序崩溃） | Panic（程序崩溃） | ❌ 不可用 try-catch 捕获 |\n| **Python** | 抛出 `ZeroDivisionError` | 抛出 `ZeroDivisionError` | ✅ 可用 try-except 捕获 |\n| **JavaScript** | `Infinity` | `NaN` | ✅ 不抛出异常，返回特殊值 |\n| **Java** | 抛出 `ArithmeticException` | 抛出 `ArithmeticException` | ✅ 可用 try-catch 捕获 |\n| **C/C++** | 未定义行为（UB） | 未定义行为（UB） | ❌ 无标准异常机制 |\n| **Go** | Panic | Panic | ⚠️ 可用 recover 捕获（不推荐） |\n\n**Rust 的设计权衡：**\n\n1. **不使用异常机制**：Rust 没有 try-catch 异常系统，这避免了隐藏的控制流和性能开销\n2. **强制显式处理**：通过 `checked_*` 等方法，强制开发者在可能出错的地方显式处理\n3. **Panic 是最后手段**：Panic 用于\&quot;不可恢复的错误\&quot;，而零除被认为是编程错误而非业务逻辑错误\n\n## 实战建议\n\n### 1. 算法题中的处理\n\n在刷算法题时，可以这样处理：\n\n```rust\n// ❌ 危险：可能 panic\nfn solve_naive(n: i32, m: i32) -&gt; i32 {\n    (n * n) % m  // 如果 m 为 0，直接崩溃\n}\n\n// ✅ 安全：添加前置检查\nfn solve_safe(n: i32, m: i32) -&gt; Option&lt;i32&gt; {\n    if m == 0 {\n        return None;\n    }\n    Some((n * n) % m)\n}\n\n// ✅ 更好：使用 checked 方法\nfn solve_better(n: i32, m: i32) -&gt; Option&lt;i32&gt; {\n    n.checked_mul(n)?.checked_rem(m)\n}\n```\n\n### 2. 生产代码的建议\n\n```rust\n// 对于用户输入，总是使用 checked_* 方法\nfn process_user_input(dividend: i32, divisor: i32) -&gt; Result&lt;i32, String&gt; {\n    dividend\n        .checked_div(divisor)\n        .ok_or_else(|| {\n            if divisor == 0 {\n                \&quot;除数不能为零\&quot;.to_string()\n            } else {\n                \&quot;计算溢出\&quot;.to_string()\n            }\n        })\n}\n\n// 对于性能敏感且确定不会溢出的代码，可以使用普通运算符\nfn fast_index_calculation(base: usize, offset: usize, size: usize) -&gt; usize {\n    // 假设已经在外层保证了不会溢出\n    (base + offset) % size\n}\n\n// 对于需要环绕语义的场景，明确使用 wrapping_*\nfn hash_combine(hash1: u64, hash2: u64) -&gt; u64 {\n    hash1.wrapping_add(hash2).wrapping_mul(0x9e3779b97f4a7c15)\n}\n```\n\n### 3. 测试建议\n\n```rust\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    #[should_panic(expected = \&quot;divide by zero\&quot;)]\n    fn test_division_by_zero_panics() {\n        let _ = 10 / 0;\n    }\n\n    #[test]\n    #[should_panic(expected = \&quot;remainder\&quot;)]\n    fn test_modulo_by_zero_panics() {\n        let _ = 10 % 0;\n    }\n\n    #[test]\n    fn test_safe_division() {\n        assert_eq!(10.checked_div(2), Some(5));\n        assert_eq!(10.checked_div(0), None);\n        assert_eq!(i32::MIN.checked_div(-1), None);\n    }\n}\n```\n\n## 总结\n\n### 关键要点\n\n1. **Rust 中会导致 panic 的算术运算：**\n   - `a / 0` 和 `a % 0`（整数）\n   - `INT_MIN / -1` 和 `INT_MIN % -1`\n   - Debug 模式下的整数溢出\n\n2. **浮点数例外：**\n   - `f32/f64` 的除零不会 panic，返回 `Infinity` 或 `NaN`\n\n3. **Debug vs Release 的差异：**\n   - Debug：溢出 panic，帮助调试\n   - Release：溢出环绕，优化性能\n   - 使用 `checked_*` 等方法可以统一行为\n\n4. **Rust 的解决方案：**\n   - `checked_*`：安全检查，返回 `Option&lt;T&gt;`\n   - `wrapping_*`：显式环绕\n   - `saturating_*`：饱和到边界\n   - `overflowing_*`：返回结果和溢出标志\n   - `strict_*`：总是 panic（Rust 1.80+）\n\n5. **设计哲学：**\n   - 避免未定义行为\n   - 强制显式处理\n   - Panic 用于不可恢复的编程错误\n\n### 实践建议\n\n- ✅ **用户输入和外部数据**：总是使用 `checked_*` 方法\n- ✅ **算法题**：添加边界检查或使用 `checked_*`\n- ✅ **性能关键路径**：如果确定安全，可以用普通运算符，但要有充分的注释说明\n- ✅ **需要环绕语义**：明确使用 `wrapping_*`\n- ✅ **测试**：为边界情况编写测试，包括 panic 测试\n\n### 延伸阅读\n\n- [Rust RFC 560 - Integer Overflow](https://rust-lang.github.io/rfcs/0560-integer-overflow.html)\n- [Myths and Legends about Integer Overflow in Rust](https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/)\n- [Rust Documentation - Div trait](https://doc.rust-lang.org/std/ops/trait.Div.html)\n- [Behavior not considered unsafe - Rust Reference](https://doc.rust-lang.org/reference/behavior-not-considered-unsafe.html)\n- [Exploring Rust&#39;s Overflow Behavior - Sling Academy](https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/)\n\n---\n\n**最后提醒：** 这些行为不是 bug，而是 Rust 为了安全性做出的有意设计。理解这些特性，才能写出既安全又高效的 Rust 代码。下次刷算法题时，记得留意除法和取模操作，不要让你的解答因为一个 `% 0` 而崩溃！\n\n写到这里，我想起了前一个月的 cloudflare的unwarp 造成的panic!。真的很好笑。\n\n一定要注意rust一切可能引起panic!的可能性，才不会像cloudflare的unwarp方法一样，搞出的几十亿美金的全球网站崩溃漏洞。\n\nSources:\n- [Rust RFC 560 - Integer Overflow](https://rust-lang.github.io/rfcs/0560-integer-overflow.html)\n- [Myths and Legends about Integer Overflow in Rust](https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/)\n- [What happens in Rust programming language when an integer arithmetic operation overflows? - Stack Overflow](https://stackoverflow.com/questions/68807024/what-happens-in-rust-programming-language-when-an-integer-arithmetic-operation-o)\n- [Exploring Rust&#39;s Overflow Behavior: Wrapping, Saturating, and Panicking - Sling Academy](https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/)\n- [Div in std::ops - Rust](https://doc.rust-lang.org/std/ops/trait.Div.html)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Rust算术运算的Panic陷阱-从取模零说起.md&quot;],&quot;digest&quot;:[0,&quot;a24451f5fe38d184&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h2 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;今天在刷 Rust 算法题时，遇到了一个让我印象深刻的情况：&lt;strong&gt;当我尝试对 0 取模时，程序直接 panic 了！&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; result &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y;  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 💥 thread &#39;main&#39; panicked at &#39;attempt to calculate the remainder with a divisor of zero&#39;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这个行为在其他语言中并不常见。比如在 JavaScript 中，&lt;code&gt;10 % 0&lt;/code&gt; 会返回 &lt;code&gt;NaN&lt;/code&gt;；在 Python 中会抛出 &lt;code&gt;ZeroDivisionError&lt;/code&gt; 异常（可以被捕获）。而 &lt;strong&gt;Rust 选择直接 panic，整个程序崩溃，无法通过普通的错误处理机制捕获&lt;/strong&gt;。&lt;/p&gt;\n&lt;p&gt;这引发了我的好奇：Rust 中还有哪些类似的”地雷”？让我们一探究竟。&lt;/p&gt;\n&lt;h2 id=\&quot;rust-中会导致-panic-的算术运算\&quot;&gt;Rust 中会导致 Panic 的算术运算&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#rust-中会导致-panic-的算术运算\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;1-除法和取模运算的零除错误\&quot;&gt;1. 除法和取模运算的零除错误&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-除法和取模运算的零除错误\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在 Rust 中，&lt;strong&gt;整数的除法和取模运算遇到零除数时会无条件 panic&lt;/strong&gt;：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; b &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 除法遇到零：panic!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let div = a / b;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 取模遇到零：panic!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let rem = a % b;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;这行代码永远不会执行\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;为什么会这样？&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Rust 的设计哲学是：&lt;strong&gt;宁可 panic 也不产生未定义行为（Undefined Behavior, UB）&lt;/strong&gt;。在很多底层语言（如 C/C++）中，除以零会导致 UB，这可能造成：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;程序段错误（Segmentation Fault）&lt;/li&gt;\n&lt;li&gt;返回垃圾值&lt;/li&gt;\n&lt;li&gt;安全漏洞&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Rust 通过显式 panic 来避免这些不可预测的行为，让错误在第一时间暴露出来。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;浮点数例外&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;有趣的是，&lt;strong&gt;浮点数的除零操作不会 panic&lt;/strong&gt;，而是遵循 IEEE 754 标准：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ inf (正无穷)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ -inf (负无穷)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, y &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ NaN (Not a Number)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 浮点数取模也不会 panic，但会返回 NaN&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ NaN&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;2-整数溢出的特殊边界情况\&quot;&gt;2. 整数溢出的特殊边界情况&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-整数溢出的特殊边界情况\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;还有一个更隐蔽的陷阱：&lt;strong&gt;&lt;code&gt;INT_MIN / -1&lt;/code&gt; 和 &lt;code&gt;INT_MIN % -1&lt;/code&gt; 也会 panic&lt;/strong&gt;！&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; min &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; divisor &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; -&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 这会 panic！&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let result = min / divisor;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 这也会 panic！&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let remainder = min % divisor;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;为什么？&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;对于 8 位有符号整数 &lt;code&gt;i8&lt;/code&gt;：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;最小值：&lt;code&gt;i8::MIN = -128&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;最大值：&lt;code&gt;i8::MAX = 127&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;当我们计算 &lt;code&gt;-128 / -1&lt;/code&gt; 时，数学结果应该是 &lt;code&gt;128&lt;/code&gt;，但这&lt;strong&gt;超出了 &lt;code&gt;i8&lt;/code&gt; 的表示范围&lt;/strong&gt;（最大只能到 127），导致溢出。Rust 选择 panic 而不是返回错误的结果。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; demonstrate_overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 对于不同的整数类型，都存在这个问题&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i8::MIN  / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128 / -1 = 128 (溢出!)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i16::MIN / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i16&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -32768 / -1 = 32768 (溢出!)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i32::MIN / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -2147483648 / -1 = 2147483648 (溢出!)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i64::MIN / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i64&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 同理&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;3-debug-模式下的整数溢出\&quot;&gt;3. Debug 模式下的整数溢出&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-debug-模式下的整数溢出\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;Rust 在 &lt;strong&gt;debug 模式和 release 模式下对整数溢出的处理不同&lt;/strong&gt;：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; max &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Debug 模式：💥 panic!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Release 模式：✅ 环绕到 0 (wrapping)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; result &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; max &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Result: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, result);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;行为差异：&lt;/strong&gt;&lt;/p&gt;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;模式&lt;/th&gt;&lt;th&gt;溢出行为&lt;/th&gt;&lt;th&gt;原因&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Debug&lt;/strong&gt; (&lt;code&gt;cargo build&lt;/code&gt;)&lt;/td&gt;&lt;td&gt;Panic&lt;/td&gt;&lt;td&gt;帮助开发者尽早发现 bug&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Release&lt;/strong&gt; (&lt;code&gt;cargo build --release&lt;/code&gt;)&lt;/td&gt;&lt;td&gt;二进制补码环绕&lt;/td&gt;&lt;td&gt;性能优化，避免运行时检查开销&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;\n&lt;p&gt;在 release 模式下：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; +&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;      // =&gt; 0   (255 + 1 环绕为 0)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; -&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;      // =&gt; 255 (0 - 1 环绕为 255)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; +&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;      // =&gt; -128 (127 + 1 环绕为 -128)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这意味着：&lt;strong&gt;同样的代码在不同编译模式下可能有完全不同的行为！&lt;/strong&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;rust-的解决方案显式的溢出处理\&quot;&gt;Rust 的解决方案：显式的溢出处理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#rust-的解决方案显式的溢出处理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;为了让开发者能够精确控制溢出行为，Rust 提供了多种方法变体：&lt;/p&gt;\n&lt;h3 id=\&quot;1-checked_-系列安全检查返回-option\&quot;&gt;1. &lt;code&gt;checked_*&lt;/code&gt; 系列：安全检查，返回 Option&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-checked_-系列安全检查返回-option\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; safe_division&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, b&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Some(5)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None - 零除返回 None 而不是 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None - 溢出返回 None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 其他 checked 方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));       &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;128&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_rem&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));        &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None - 取模零也返回 None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;用户输入处理&lt;/li&gt;\n&lt;li&gt;外部数据验证&lt;/li&gt;\n&lt;li&gt;需要优雅处理错误的场景&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;2-wrapping_-系列显式环绕行为\&quot;&gt;2. &lt;code&gt;wrapping_*&lt;/code&gt; 系列：显式环绕行为&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-wrapping_-系列显式环绕行为\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 无论 debug 还是 release 模式，都保证环绕行为&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 0&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));        &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;200&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 144 (400 % 256)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 环绕除法：零除仍然会 panic！&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // println!(\&quot;{}\&quot;, 10.wrapping_div(0));  // 💥 仍然 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 但 INT_MIN / -1 会环绕而不是 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128 (环绕到自身)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;哈希计算&lt;/li&gt;\n&lt;li&gt;密码学算法&lt;/li&gt;\n&lt;li&gt;需要明确的模运算语义&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;3-saturating_-系列饱和到边界值\&quot;&gt;3. &lt;code&gt;saturating_*&lt;/code&gt; 系列：饱和到边界值&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-saturating_-系列饱和到边界值\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 溢出时返回类型的最大/最小值&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));    &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255 (不超过最大值)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 0   (不低于最小值)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;200&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));    &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255 (饱和到最大值)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 有符号整数&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;127&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));    &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 127&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, (&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;128&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 除法仍然对零除 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // println!(\&quot;{}\&quot;, 10.saturating_div(0));  // 💥 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;音频/视频处理（音量、亮度限制）&lt;/li&gt;\n&lt;li&gt;游戏开发（生命值、伤害计算）&lt;/li&gt;\n&lt;li&gt;UI 组件（滚动位置、进度条）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;4-overflowing_-系列返回结果和溢出标志\&quot;&gt;4. &lt;code&gt;overflowing_*&lt;/code&gt; 系列：返回结果和溢出标志&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#4-overflowing_-系列返回结果和溢出标志\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (result, overflowed) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;overflowing_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Result: {}, Overflowed: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, result, overflowed);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Result: 0, Overflowed: true&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (result, overflowed) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 100&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;overflowing_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;50&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Result: {}, Overflowed: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, result, overflowed);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Result: 150, Overflowed: false&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 可以用来实现自定义的溢出处理逻辑&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (div, overflow) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;overflowing_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Division: {}, Overflow: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, div, overflow);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Division: -128, Overflow: true&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;需要记录溢出事件&lt;/li&gt;\n&lt;li&gt;实现自定义的错误报告&lt;/li&gt;\n&lt;li&gt;性能敏感但需要溢出信息的代码&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;5-strict_-系列总是-panicrust-180\&quot;&gt;5. &lt;code&gt;strict_*&lt;/code&gt; 系列：总是 Panic（Rust 1.80+）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#5-strict_-系列总是-panicrust-180\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 无论 debug 还是 release，溢出总是 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let result = 255u8.strict_add(1);  // 💥 panic in both debug and release&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 这对于需要严格保证数学正确性的场景很有用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;金融计算&lt;/li&gt;\n&lt;li&gt;科学计算&lt;/li&gt;\n&lt;li&gt;任何不能容忍静默溢出的场景&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;完整的除零安全处理示例\&quot;&gt;完整的除零安全处理示例&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#完整的除零安全处理示例\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;结合上面的知识，我们可以写一个安全的计算器函数：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;#[derive(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Debug&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;PartialEq&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;enum&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; CalcError&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    DivisionByZero&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, b&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, op&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; char&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Result&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    match&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; op {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;+&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;-&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;*&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; b &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;                Err&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;DivisionByZero&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;                a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;%&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; b &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;                Err&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;DivisionByZero&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;                a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_rem&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        _ &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; panic!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Unsupported operation\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Ok(5)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(DivisionByZero)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;%&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(DivisionByZero)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;+&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(Overflow)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(Overflow)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;rust-vs-其他语言\&quot;&gt;Rust vs 其他语言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#rust-vs-其他语言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;让我们对比一下不同语言对除零的处理：&lt;/p&gt;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;语言&lt;/th&gt;&lt;th&gt;&lt;code&gt;10 / 0&lt;/code&gt; 行为&lt;/th&gt;&lt;th&gt;&lt;code&gt;10 % 0&lt;/code&gt; 行为&lt;/th&gt;&lt;th&gt;可捕获？&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Rust&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;Panic（程序崩溃）&lt;/td&gt;&lt;td&gt;Panic（程序崩溃）&lt;/td&gt;&lt;td&gt;❌ 不可用 try-catch 捕获&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Python&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ZeroDivisionError&lt;/code&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ZeroDivisionError&lt;/code&gt;&lt;/td&gt;&lt;td&gt;✅ 可用 try-except 捕获&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;JavaScript&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;Infinity&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;NaN&lt;/code&gt;&lt;/td&gt;&lt;td&gt;✅ 不抛出异常，返回特殊值&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Java&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ArithmeticException&lt;/code&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ArithmeticException&lt;/code&gt;&lt;/td&gt;&lt;td&gt;✅ 可用 try-catch 捕获&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;C/C++&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;未定义行为（UB）&lt;/td&gt;&lt;td&gt;未定义行为（UB）&lt;/td&gt;&lt;td&gt;❌ 无标准异常机制&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Go&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;Panic&lt;/td&gt;&lt;td&gt;Panic&lt;/td&gt;&lt;td&gt;⚠️ 可用 recover 捕获（不推荐）&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;\n&lt;p&gt;&lt;strong&gt;Rust 的设计权衡：&lt;/strong&gt;&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;不使用异常机制&lt;/strong&gt;：Rust 没有 try-catch 异常系统，这避免了隐藏的控制流和性能开销&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;强制显式处理&lt;/strong&gt;：通过 &lt;code&gt;checked_*&lt;/code&gt; 等方法，强制开发者在可能出错的地方显式处理&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Panic 是最后手段&lt;/strong&gt;：Panic 用于”不可恢复的错误”，而零除被认为是编程错误而非业务逻辑错误&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&quot;实战建议\&quot;&gt;实战建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实战建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;1-算法题中的处理\&quot;&gt;1. 算法题中的处理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-算法题中的处理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在刷算法题时，可以这样处理：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ❌ 危险：可能 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; solve_naive&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, m&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    (n &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; n) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; m  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 如果 m 为 0，直接崩溃&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 安全：添加前置检查&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; solve_safe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, m&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; m &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; None&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    Some&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;((n &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; n) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; m)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 更好：使用 checked 方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; solve_better&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, m&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;?.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_rem&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(m)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;2-生产代码的建议\&quot;&gt;2. 生产代码的建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-生产代码的建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 对于用户输入，总是使用 checked_* 方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process_user_input&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(dividend&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, divisor&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Result&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    dividend&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(divisor)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or_else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;||&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; divisor &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;                \&quot;除数不能为零\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;                \&quot;计算溢出\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        })&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 对于性能敏感且确定不会溢出的代码，可以使用普通运算符&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; fast_index_calculation&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(base&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, offset&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, size&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 假设已经在外层保证了不会溢出&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    (base &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; offset) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; size&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 对于需要环绕语义的场景，明确使用 wrapping_*&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; hash_combine&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(hash1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, hash2&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    hash1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(hash2)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0x9e3779b97f4a7c15&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;3-测试建议\&quot;&gt;3. 测试建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-测试建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;#[cfg(test)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;mod&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; tests&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    use&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; super&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[test]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[should_panic(expected &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;divide by zero\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; test_division_by_zero_panics&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; _ &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; /&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[test]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[should_panic(expected &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;remainder\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; test_modulo_by_zero_panics&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; _ &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; %&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[test]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; test_safe_division&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        assert_eq!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Some&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        assert_eq!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;None&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        assert_eq!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;None&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;总结\&quot;&gt;总结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#总结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;关键要点\&quot;&gt;关键要点&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#关键要点\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Rust 中会导致 panic 的算术运算：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;a / 0&lt;/code&gt; 和 &lt;code&gt;a % 0&lt;/code&gt;（整数）&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;INT_MIN / -1&lt;/code&gt; 和 &lt;code&gt;INT_MIN % -1&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Debug 模式下的整数溢出&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;浮点数例外：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;f32/f64&lt;/code&gt; 的除零不会 panic，返回 &lt;code&gt;Infinity&lt;/code&gt; 或 &lt;code&gt;NaN&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Debug vs Release 的差异：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Debug：溢出 panic，帮助调试&lt;/li&gt;\n&lt;li&gt;Release：溢出环绕，优化性能&lt;/li&gt;\n&lt;li&gt;使用 &lt;code&gt;checked_*&lt;/code&gt; 等方法可以统一行为&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Rust 的解决方案：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;checked_*&lt;/code&gt;：安全检查，返回 &lt;code&gt;Option&amp;#x3C;T&gt;&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;wrapping_*&lt;/code&gt;：显式环绕&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;saturating_*&lt;/code&gt;：饱和到边界&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;overflowing_*&lt;/code&gt;：返回结果和溢出标志&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;strict_*&lt;/code&gt;：总是 panic（Rust 1.80+）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;设计哲学：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;避免未定义行为&lt;/li&gt;\n&lt;li&gt;强制显式处理&lt;/li&gt;\n&lt;li&gt;Panic 用于不可恢复的编程错误&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;实践建议\&quot;&gt;实践建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实践建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;✅ &lt;strong&gt;用户输入和外部数据&lt;/strong&gt;：总是使用 &lt;code&gt;checked_*&lt;/code&gt; 方法&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;算法题&lt;/strong&gt;：添加边界检查或使用 &lt;code&gt;checked_*&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;性能关键路径&lt;/strong&gt;：如果确定安全，可以用普通运算符，但要有充分的注释说明&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;需要环绕语义&lt;/strong&gt;：明确使用 &lt;code&gt;wrapping_*&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;测试&lt;/strong&gt;：为边界情况编写测试，包括 panic 测试&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;延伸阅读\&quot;&gt;延伸阅读&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#延伸阅读\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;https://rust-lang.github.io/rfcs/0560-integer-overflow.html\&quot;&gt;Rust RFC 560 - Integer Overflow&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/\&quot;&gt;Myths and Legends about Integer Overflow in Rust&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/std/ops/trait.Div.html\&quot;&gt;Rust Documentation - Div trait&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/reference/behavior-not-considered-unsafe.html\&quot;&gt;Behavior not considered unsafe - Rust Reference&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/\&quot;&gt;Exploring Rust’s Overflow Behavior - Sling Academy&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;最后提醒：&lt;/strong&gt; 这些行为不是 bug，而是 Rust 为了安全性做出的有意设计。理解这些特性，才能写出既安全又高效的 Rust 代码。下次刷算法题时，记得留意除法和取模操作，不要让你的解答因为一个 &lt;code&gt;% 0&lt;/code&gt; 而崩溃！&lt;/p&gt;\n&lt;p&gt;写到这里，我想起了前一个月的 cloudflare的unwarp 造成的panic!。真的很好笑。&lt;/p&gt;\n&lt;p&gt;一定要注意rust一切可能引起panic!的可能性，才不会像cloudflare的unwarp方法一样，搞出的几十亿美金的全球网站崩溃漏洞。&lt;/p&gt;\n&lt;p&gt;Sources:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;https://rust-lang.github.io/rfcs/0560-integer-overflow.html\&quot;&gt;Rust RFC 560 - Integer Overflow&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/\&quot;&gt;Myths and Legends about Integer Overflow in Rust&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://stackoverflow.com/questions/68807024/what-happens-in-rust-programming-language-when-an-integer-arithmetic-operation-o\&quot;&gt;What happens in Rust programming language when an integer arithmetic operation overflows? - Stack Overflow&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/\&quot;&gt;Exploring Rust’s Overflow Behavior: Wrapping, Saturating, and Panicking - Sling Academy&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/std/ops/trait.Div.html\&quot;&gt;Div in std::ops - Rust&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;rust-中会导致-panic-的算术运算&quot;],&quot;text&quot;:[0,&quot;Rust 中会导致 Panic 的算术运算&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-除法和取模运算的零除错误&quot;],&quot;text&quot;:[0,&quot;1. 除法和取模运算的零除错误&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-整数溢出的特殊边界情况&quot;],&quot;text&quot;:[0,&quot;2. 整数溢出的特殊边界情况&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-debug-模式下的整数溢出&quot;],&quot;text&quot;:[0,&quot;3. Debug 模式下的整数溢出&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;rust-的解决方案显式的溢出处理&quot;],&quot;text&quot;:[0,&quot;Rust 的解决方案：显式的溢出处理&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-checked_-系列安全检查返回-option&quot;],&quot;text&quot;:[0,&quot;1. checked_* 系列：安全检查，返回 Option&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-wrapping_-系列显式环绕行为&quot;],&quot;text&quot;:[0,&quot;2. wrapping_* 系列：显式环绕行为&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-saturating_-系列饱和到边界值&quot;],&quot;text&quot;:[0,&quot;3. saturating_* 系列：饱和到边界值&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;4-overflowing_-系列返回结果和溢出标志&quot;],&quot;text&quot;:[0,&quot;4. overflowing_* 系列：返回结果和溢出标志&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;5-strict_-系列总是-panicrust-180&quot;],&quot;text&quot;:[0,&quot;5. strict_* 系列：总是 Panic（Rust 1.80+）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;完整的除零安全处理示例&quot;],&quot;text&quot;:[0,&quot;完整的除零安全处理示例&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;rust-vs-其他语言&quot;],&quot;text&quot;:[0,&quot;Rust vs 其他语言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;实战建议&quot;],&quot;text&quot;:[0,&quot;实战建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-算法题中的处理&quot;],&quot;text&quot;:[0,&quot;1. 算法题中的处理&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-生产代码的建议&quot;],&quot;text&quot;:[0,&quot;2. 生产代码的建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-测试建议&quot;],&quot;text&quot;:[0,&quot;3. 测试建议&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;总结&quot;],&quot;text&quot;:[0,&quot;总结&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;关键要点&quot;],&quot;text&quot;:[0,&quot;关键要点&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;实践建议&quot;],&quot;text&quot;:[0,&quot;实践建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;延伸阅读&quot;],&quot;text&quot;:[0,&quot;延伸阅读&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Rust 算术运算的 Panic 陷阱：从取模零说起&quot;],&quot;date&quot;:[3,&quot;2025-12-02T10:00:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;算法&quot;],[0,&quot;安全&quot;],[0,&quot;Panic&quot;],[0,&quot;算术运算&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;],&quot;description&quot;:[0,&quot;在刷 Rust 算法题时发现了一个独特现象：对零取模会直接导致程序 panic！这与其他语言的行为截然不同。本文深入探讨 Rust 中会导致 panic 的算术运算场景，包括除零、整数溢出、INT_MIN/-1 等特殊情况，以及 Rust 提供的 checked_、wrapping_、saturating_ 等安全替代方案。理解这些行为对于编写健壮的 Rust 程序至关重要。&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/20&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;rust引用生命周期-不只是切片&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Rust 引用生命周期：不只是切片&quot;],&quot;description&quot;:[0,&quot;探讨 Rust 中引用生命周期的普遍规律，揭示所有引用类型（切片、结构体字段、数组元素等）都遵循\&quot;可短不可长\&quot;的生命周期原则。&quot;],&quot;date&quot;:[3,&quot;2025-11-27T14:30:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;生命周期&quot;],[0,&quot;引用&quot;],[0,&quot;所有权&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;]}],&quot;body&quot;:[0,&quot;## 前言\n\n在学习 Rust 的生命周期时，我们经常会看到切片（slice）作为典型例子：切片的生命周期可以比原始数据短，但不能比原始数据长。但这只是切片的特性吗？实际上，**所有引用类型**都遵循这一规律。\n\n## 核心原则\n\nRust 中的引用生命周期遵循一个简单而强大的原则：\n\n&gt; **任何\&quot;借用\&quot;原始数据一部分的引用，生命周期都可以比原始数据短，但绝不能比原始数据长。**\n\n这不仅适用于切片，还适用于所有引用场景。\n\n## 典型案例\n\n### 1. 切片引用\n\n这是最常见的例子：\n\n```rust\nfn main() {\n    let s = String::from(\&quot;hello world\&quot;);\n\n    {\n        let slice = &amp;s[0..5]; // slice 的生命周期在这个作用域内\n        println!(\&quot;{}\&quot;, slice); // 输出: hello\n    } // slice 在这里结束，但 s 还活着\n\n    println!(\&quot;{}\&quot;, s); // s 仍然有效\n}\n```\n\n**关键点：** `slice` 的生命周期比 `s` 短，只要 `s` 有效，`slice` 就有效。\n\n### 2. 结构体字段引用\n\n如果结构体的某个字段是引用，这个引用的生命周期可以比整个结构体短：\n\n```rust\nstruct Person&lt;&#39;a&gt; {\n    name: &amp;&#39;a str,\n    age: u32,\n}\n\nfn main() {\n    let name = String::from(\&quot;Alice\&quot;);\n\n    {\n        let person = Person {\n            name: &amp;name,\n            age: 30,\n        };\n\n        // person.name 的生命周期在这个作用域内\n        println!(\&quot;{} is {} years old\&quot;, person.name, person.age);\n    } // person 和它的引用在这里结束\n\n    println!(\&quot;Original name: {}\&quot;, name); // name 仍然有效\n}\n```\n\n**关键点：** `person.name` 是对 `name` 的引用，它的生命周期受限于 `person` 所在的作用域，但 `name` 本身可以活得更久。\n\n### 3. 数组元素引用\n\n取数组某个元素的引用，其生命周期可以比整个数组短：\n\n```rust\nfn main() {\n    let arr = [1, 2, 3, 4, 5];\n\n    {\n        let first = &amp;arr[0]; // first 的生命周期在这个作用域内\n        println!(\&quot;First element: {}\&quot;, first); // 输出: 1\n    } // first 在这里结束\n\n    println!(\&quot;Array: {:?}\&quot;, arr); // arr 仍然有效\n}\n```\n\n**关键点：** `&amp;arr[0]` 只在内层作用域有效，但 `arr` 可以在外层作用域继续使用。\n\n### 4. 函数参数的局部引用\n\n函数内部可以创建对参数的局部引用，这些引用的生命周期比参数本身短：\n\n```rust\nfn process_data(data: &amp;Vec&lt;i32&gt;) {\n    // 取 data 的一部分\n    let slice = &amp;data[1..3];\n    println!(\&quot;Slice: {:?}\&quot;, slice);\n\n    // slice 的生命周期在这里结束\n    // 但 data 引用仍然有效，可以继续使用\n    println!(\&quot;Full data: {:?}\&quot;, data);\n}\n\nfn main() {\n    let numbers = vec![1, 2, 3, 4, 5];\n    process_data(&amp;numbers);\n}\n```\n\n**关键点：** `slice` 是对 `data` 的进一步借用，它的生命周期更短，但只要 `data` 有效，`slice` 就可以创建和使用。\n\n### 5. 嵌套引用\n\n引用的引用也遵循相同的规律：\n\n```rust\nfn main() {\n    let x = 42;\n    let r1 = &amp;x;\n\n    {\n        let r2 = &amp;r1; // r2 是对 r1 的引用\n        println!(\&quot;r2: {}\&quot;, r2); // 输出: 42\n    } // r2 在这里结束\n\n    println!(\&quot;r1: {}\&quot;, r1); // r1 仍然有效\n    println!(\&quot;x: {}\&quot;, x);   // x 仍然有效\n}\n```\n\n**关键点：** 每一层引用的生命周期都可以比它所引用的数据短。\n\n## 为什么可以更短？\n\nRust 的借用检查器（borrow checker）会确保：\n\n1. **引用有效期内，原始数据不会被释放**\n2. **引用的生命周期可以比原始数据短**，因为提前结束引用不会影响原始数据\n3. **原始数据的生命周期可以延续**，即使引用已经失效\n\n这就像租房：\n- 房东（原始数据）可以在租约（引用）到期后继续拥有房子\n- 租客（引用）可以提前退租（生命周期更短）\n- 但租客不能在房子被拆除后继续住（引用不能比原始数据长）\n\n## 为什么不能更长？\n\n这是 Rust 所有权系统的核心保证：\n\n```rust\nfn dangling_reference() -&gt; &amp;String {\n    let s = String::from(\&quot;hello\&quot;);\n    &amp;s // ❌ 编译错误：s 在函数结束时被释放\n}      // 但我们试图返回对它的引用\n```\n\n如果允许引用的生命周期比原始数据长，就会出现**悬垂引用**（dangling reference），指向已经被释放的内存，这是内存安全问题的根源。\n\n## 实际应用场景\n\n### 场景 1：临时处理数据片段\n\n```rust\nfn analyze_header(data: &amp;[u8]) {\n    // 只处理前 10 个字节\n    if data.len() &gt;= 10 {\n        let header = &amp;data[0..10];\n        println!(\&quot;Header: {:?}\&quot;, header);\n        // header 在这里结束，但 data 仍然可用\n    }\n\n    // 继续处理完整数据\n    println!(\&quot;Total length: {}\&quot;, data.len());\n}\n```\n\n### 场景 2：链式引用\n\n```rust\nstruct Config {\n    settings: Vec&lt;String&gt;,\n}\n\nimpl Config {\n    fn get_setting(&amp;self, index: usize) -&gt; Option&lt;&amp;str&gt; {\n        self.settings.get(index).map(|s| s.as_str())\n    }\n}\n\nfn main() {\n    let config = Config {\n        settings: vec![String::from(\&quot;debug=true\&quot;), String::from(\&quot;port=8080\&quot;)],\n    };\n\n    if let Some(setting) = config.get_setting(0) {\n        println!(\&quot;Setting: {}\&quot;, setting);\n        // setting 引用在这里有效\n    } // setting 在这里结束\n\n    // config 仍然有效\n    println!(\&quot;Total settings: {}\&quot;, config.settings.len());\n}\n```\n\n### 场景 3：迭代器中的引用\n\n```rust\nfn main() {\n    let words = vec![\n        String::from(\&quot;hello\&quot;),\n        String::from(\&quot;world\&quot;),\n        String::from(\&quot;rust\&quot;),\n    ];\n\n    // 迭代器产生的引用生命周期在循环内\n    for word in words.iter() {\n        // word 是 &amp;String，只在这次循环迭代中有效\n        println!(\&quot;{}\&quot;, word);\n    }\n\n    // words 仍然有效，可以继续使用\n    println!(\&quot;Total words: {}\&quot;, words.len());\n}\n```\n\n## 常见陷阱\n\n### 陷阱 1：试图返回局部变量的引用\n\n```rust\nfn get_first_word(s: &amp;str) -&gt; &amp;str {\n    let words: Vec&lt;&amp;str&gt; = s.split_whitespace().collect();\n    words[0] // ❌ 可能有问题：words 在函数结束时被释放\n}\n```\n\n正确做法：\n\n```rust\nfn get_first_word(s: &amp;str) -&gt; &amp;str {\n    s.split_whitespace().next().unwrap_or(\&quot;\&quot;)\n    // 直接返回原始 s 的切片，生命周期与 s 相同\n}\n```\n\n### 陷阱 2：在结构体中存储临时引用\n\n```rust\nstruct Cache&lt;&#39;a&gt; {\n    data: &amp;&#39;a str,\n}\n\nfn main() {\n    let cache;\n    {\n        let temp = String::from(\&quot;temporary\&quot;);\n        cache = Cache { data: &amp;temp };\n        // ❌ 编译错误：temp 在这里被释放\n    }\n    // println!(\&quot;{}\&quot;, cache.data); // cache.data 会成为悬垂引用\n}\n```\n\n## 总结\n\n### 核心要点\n\n1. **普遍规律**：所有引用类型都遵循\&quot;可短不可长\&quot;的生命周期原则\n   - 切片引用\n   - 结构体字段引用\n   - 数组元素引用\n   - 函数参数的局部引用\n   - 嵌套引用\n\n2. **可以更短的原因**：\n   - 引用提前结束不影响原始数据\n   - 原始数据可以在引用失效后继续存在\n   - 符合 Rust 的内存安全保证\n\n3. **不能更长的原因**：\n   - 防止悬垂引用\n   - 确保引用始终指向有效内存\n   - Rust 所有权系统的核心保证\n\n4. **实践建议**：\n   - 理解引用的生命周期本质\n   - 避免创建比原始数据更长的引用\n   - 利用作用域控制引用的生命周期\n   - 使用借用检查器的错误提示定位问题\n\n### 记忆口诀\n\n**借用可短不可长，原数据寿命是底线。**\n\n### 延伸思考\n\n- 生命周期标注（`&#39;a`）是如何帮助编译器检查的？\n- 静态生命周期（`&#39;static`）为什么可以\&quot;永久存在\&quot;？\n- 如何在复杂数据结构中管理多个引用的生命周期？\n\n希望这篇文章能帮助你全面理解 Rust 中引用生命周期的普遍规律，而不只是局限于切片这一个例子！\n\n---\n\n**提示：** 生命周期是 Rust 最具特色的概念之一，建议结合实际代码练习，多尝试编译器的错误提示，你会逐渐形成直觉。&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Rust引用生命周期-不只是切片.md&quot;],&quot;digest&quot;:[0,&quot;aa17305627bf5bbe&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h2 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;在学习 Rust 的生命周期时，我们经常会看到切片（slice）作为典型例子：切片的生命周期可以比原始数据短，但不能比原始数据长。但这只是切片的特性吗？实际上，&lt;strong&gt;所有引用类型&lt;/strong&gt;都遵循这一规律。&lt;/p&gt;\n&lt;h2 id=\&quot;核心原则\&quot;&gt;核心原则&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#核心原则\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 中的引用生命周期遵循一个简单而强大的原则：&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;&lt;strong&gt;任何”借用”原始数据一部分的引用，生命周期都可以比原始数据短，但绝不能比原始数据长。&lt;/strong&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;这不仅适用于切片，还适用于所有引用场景。&lt;/p&gt;\n&lt;h2 id=\&quot;典型案例\&quot;&gt;典型案例&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#典型案例\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;1-切片引用\&quot;&gt;1. 切片引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-切片引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;这是最常见的例子：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello world\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; slice &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;..&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;]; &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// slice 的生命周期在这个作用域内&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, slice); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: hello&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    } &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// slice 在这里结束，但 s 还活着&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, s); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// s 仍然有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;关键点：&lt;/strong&gt; &lt;code&gt;slice&lt;/code&gt; 的生命周期比 &lt;code&gt;s&lt;/code&gt; 短，只要 &lt;code&gt;s&lt;/code&gt; 有效，&lt;code&gt;slice&lt;/code&gt; 就有效。&lt;/p&gt;\n&lt;h3 id=\&quot;2-结构体字段引用\&quot;&gt;2. 结构体字段引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-结构体字段引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;如果结构体的某个字段是引用，这个引用的生命周期可以比整个结构体短：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;struct&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Person&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;a&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    name&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;a&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    age&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; name &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Alice\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; person &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Person&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            name&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;name,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            age&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 30&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        };&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;        // person.name 的生命周期在这个作用域内&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{} is {} years old\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, person&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;name, person&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;age);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    } &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// person 和它的引用在这里结束&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Original name: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, name); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// name 仍然有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;关键点：&lt;/strong&gt; &lt;code&gt;person.name&lt;/code&gt; 是对 &lt;code&gt;name&lt;/code&gt; 的引用，它的生命周期受限于 &lt;code&gt;person&lt;/code&gt; 所在的作用域，但 &lt;code&gt;name&lt;/code&gt; 本身可以活得更久。&lt;/p&gt;\n&lt;h3 id=\&quot;3-数组元素引用\&quot;&gt;3. 数组元素引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-数组元素引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;取数组某个元素的引用，其生命周期可以比整个数组短：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; arr &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; [&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;4&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; first &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;arr[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;]; &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// first 的生命周期在这个作用域内&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;First element: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, first); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    } &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// first 在这里结束&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Array: {:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, arr); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// arr 仍然有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;关键点：&lt;/strong&gt; &lt;code&gt;&amp;#x26;arr[0]&lt;/code&gt; 只在内层作用域有效，但 &lt;code&gt;arr&lt;/code&gt; 可以在外层作用域继续使用。&lt;/p&gt;\n&lt;h3 id=\&quot;4-函数参数的局部引用\&quot;&gt;4. 函数参数的局部引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#4-函数参数的局部引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;函数内部可以创建对参数的局部引用，这些引用的生命周期比参数本身短：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process_data&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 取 data 的一部分&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; slice &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;data[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;..&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Slice: {:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, slice);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // slice 的生命周期在这里结束&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 但 data 引用仍然有效，可以继续使用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Full data: {:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, data);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;4&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    process_data&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;numbers);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;关键点：&lt;/strong&gt; &lt;code&gt;slice&lt;/code&gt; 是对 &lt;code&gt;data&lt;/code&gt; 的进一步借用，它的生命周期更短，但只要 &lt;code&gt;data&lt;/code&gt; 有效，&lt;code&gt;slice&lt;/code&gt; 就可以创建和使用。&lt;/p&gt;\n&lt;h3 id=\&quot;5-嵌套引用\&quot;&gt;5. 嵌套引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#5-嵌套引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;引用的引用也遵循相同的规律：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 42&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; r1 &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;x;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; r2 &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;r1; &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// r2 是对 r1 的引用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;r2: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, r2); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: 42&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    } &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// r2 在这里结束&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;r1: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, r1); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// r1 仍然有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;x: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, x);   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// x 仍然有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;关键点：&lt;/strong&gt; 每一层引用的生命周期都可以比它所引用的数据短。&lt;/p&gt;\n&lt;h2 id=\&quot;为什么可以更短\&quot;&gt;为什么可以更短？&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#为什么可以更短\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 的借用检查器（borrow checker）会确保：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;引用有效期内，原始数据不会被释放&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;引用的生命周期可以比原始数据短&lt;/strong&gt;，因为提前结束引用不会影响原始数据&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;原始数据的生命周期可以延续&lt;/strong&gt;，即使引用已经失效&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;这就像租房：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;房东（原始数据）可以在租约（引用）到期后继续拥有房子&lt;/li&gt;\n&lt;li&gt;租客（引用）可以提前退租（生命周期更短）&lt;/li&gt;\n&lt;li&gt;但租客不能在房子被拆除后继续住（引用不能比原始数据长）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;为什么不能更长\&quot;&gt;为什么不能更长？&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#为什么不能更长\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;这是 Rust 所有权系统的核心保证：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; dangling_reference&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ❌ 编译错误：s 在函数结束时被释放&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 但我们试图返回对它的引用&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;如果允许引用的生命周期比原始数据长，就会出现&lt;strong&gt;悬垂引用&lt;/strong&gt;（dangling reference），指向已经被释放的内存，这是内存安全问题的根源。&lt;/p&gt;\n&lt;h2 id=\&quot;实际应用场景\&quot;&gt;实际应用场景&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实际应用场景\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;场景-1临时处理数据片段\&quot;&gt;场景 1：临时处理数据片段&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-1临时处理数据片段\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; analyze_header&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;]) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 只处理前 10 个字节&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; header &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;data[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;..&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Header: {:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, header);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;        // header 在这里结束，但 data 仍然可用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 继续处理完整数据&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Total length: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;场景-2链式引用\&quot;&gt;场景 2：链式引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-2链式引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;struct&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Config&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    settings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Config&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; get_setting&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, index&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;settings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;get&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(index)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;map&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;as_str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; config &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Config&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        settings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;debug=true\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;port=8080\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)],&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    };&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    if&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; let&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Some&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(setting) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; config&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;get_setting&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Setting: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, setting);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;        // setting 引用在这里有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    } &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// setting 在这里结束&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // config 仍然有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Total settings: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, config&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;settings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;场景-3迭代器中的引用\&quot;&gt;场景 3：迭代器中的引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-3迭代器中的引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; words &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;world\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;rust\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    ];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 迭代器产生的引用生命周期在循环内&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; word &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; words&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;        // word 是 &amp;#x26;String，只在这次循环迭代中有效&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, word);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // words 仍然有效，可以继续使用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Total words: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, words&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;常见陷阱\&quot;&gt;常见陷阱&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#常见陷阱\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;陷阱-1试图返回局部变量的引用\&quot;&gt;陷阱 1：试图返回局部变量的引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#陷阱-1试图返回局部变量的引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; get_first_word&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; words&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;split_whitespace&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;collect&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    words[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;] &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ❌ 可能有问题：words 在函数结束时被释放&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;正确做法：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; get_first_word&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;split_whitespace&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;next&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;unwrap_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 直接返回原始 s 的切片，生命周期与 s 相同&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;陷阱-2在结构体中存储临时引用\&quot;&gt;陷阱 2：在结构体中存储临时引用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#陷阱-2在结构体中存储临时引用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;struct&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Cache&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;a&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;a&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; str&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; cache;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; temp &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;temporary\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        cache &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Cache&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; { data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;temp };&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;        // ❌ 编译错误：temp 在这里被释放&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // println!(\&quot;{}\&quot;, cache.data); // cache.data 会成为悬垂引用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;总结\&quot;&gt;总结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#总结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;核心要点\&quot;&gt;核心要点&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#核心要点\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;普遍规律&lt;/strong&gt;：所有引用类型都遵循”可短不可长”的生命周期原则&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;切片引用&lt;/li&gt;\n&lt;li&gt;结构体字段引用&lt;/li&gt;\n&lt;li&gt;数组元素引用&lt;/li&gt;\n&lt;li&gt;函数参数的局部引用&lt;/li&gt;\n&lt;li&gt;嵌套引用&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;可以更短的原因&lt;/strong&gt;：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;引用提前结束不影响原始数据&lt;/li&gt;\n&lt;li&gt;原始数据可以在引用失效后继续存在&lt;/li&gt;\n&lt;li&gt;符合 Rust 的内存安全保证&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;不能更长的原因&lt;/strong&gt;：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;防止悬垂引用&lt;/li&gt;\n&lt;li&gt;确保引用始终指向有效内存&lt;/li&gt;\n&lt;li&gt;Rust 所有权系统的核心保证&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;实践建议&lt;/strong&gt;：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;理解引用的生命周期本质&lt;/li&gt;\n&lt;li&gt;避免创建比原始数据更长的引用&lt;/li&gt;\n&lt;li&gt;利用作用域控制引用的生命周期&lt;/li&gt;\n&lt;li&gt;使用借用检查器的错误提示定位问题&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;记忆口诀\&quot;&gt;记忆口诀&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#记忆口诀\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;&lt;strong&gt;借用可短不可长，原数据寿命是底线。&lt;/strong&gt;&lt;/p&gt;\n&lt;h3 id=\&quot;延伸思考\&quot;&gt;延伸思考&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#延伸思考\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;生命周期标注（&lt;code&gt;&#39;a&lt;/code&gt;）是如何帮助编译器检查的？&lt;/li&gt;\n&lt;li&gt;静态生命周期（&lt;code&gt;&#39;static&lt;/code&gt;）为什么可以”永久存在”？&lt;/li&gt;\n&lt;li&gt;如何在复杂数据结构中管理多个引用的生命周期？&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;希望这篇文章能帮助你全面理解 Rust 中引用生命周期的普遍规律，而不只是局限于切片这一个例子！&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;提示：&lt;/strong&gt; 生命周期是 Rust 最具特色的概念之一，建议结合实际代码练习，多尝试编译器的错误提示，你会逐渐形成直觉。&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;核心原则&quot;],&quot;text&quot;:[0,&quot;核心原则&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;典型案例&quot;],&quot;text&quot;:[0,&quot;典型案例&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-切片引用&quot;],&quot;text&quot;:[0,&quot;1. 切片引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-结构体字段引用&quot;],&quot;text&quot;:[0,&quot;2. 结构体字段引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-数组元素引用&quot;],&quot;text&quot;:[0,&quot;3. 数组元素引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;4-函数参数的局部引用&quot;],&quot;text&quot;:[0,&quot;4. 函数参数的局部引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;5-嵌套引用&quot;],&quot;text&quot;:[0,&quot;5. 嵌套引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;为什么可以更短&quot;],&quot;text&quot;:[0,&quot;为什么可以更短？&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;为什么不能更长&quot;],&quot;text&quot;:[0,&quot;为什么不能更长？&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;实际应用场景&quot;],&quot;text&quot;:[0,&quot;实际应用场景&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-1临时处理数据片段&quot;],&quot;text&quot;:[0,&quot;场景 1：临时处理数据片段&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-2链式引用&quot;],&quot;text&quot;:[0,&quot;场景 2：链式引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-3迭代器中的引用&quot;],&quot;text&quot;:[0,&quot;场景 3：迭代器中的引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;常见陷阱&quot;],&quot;text&quot;:[0,&quot;常见陷阱&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;陷阱-1试图返回局部变量的引用&quot;],&quot;text&quot;:[0,&quot;陷阱 1：试图返回局部变量的引用&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;陷阱-2在结构体中存储临时引用&quot;],&quot;text&quot;:[0,&quot;陷阱 2：在结构体中存储临时引用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;总结&quot;],&quot;text&quot;:[0,&quot;总结&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;核心要点&quot;],&quot;text&quot;:[0,&quot;核心要点&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;记忆口诀&quot;],&quot;text&quot;:[0,&quot;记忆口诀&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;延伸思考&quot;],&quot;text&quot;:[0,&quot;延伸思考&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Rust 引用生命周期：不只是切片&quot;],&quot;date&quot;:[3,&quot;2025-11-27T14:30:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;生命周期&quot;],[0,&quot;引用&quot;],[0,&quot;所有权&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;],&quot;description&quot;:[0,&quot;探讨 Rust 中引用生命周期的普遍规律，揭示所有引用类型（切片、结构体字段、数组元素等）都遵循\&quot;可短不可长\&quot;的生命周期原则。&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/19&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;rust-trait-为泛型类型的具体实例实现特征&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Rust Trait：为泛型类型的具体实例实现特征&quot;],&quot;description&quot;:[0,&quot;深入理解 Rust 中 trait 实现的灵活性：为什么可以为 Vec&lt;String&gt; 这样的泛型类型具体实例实现 trait？探讨 Rust 类型系统中的类型特化（Type Specialization）、trait 实现的作用范围，以及如何利用这一特性编写更灵活的代码。&quot;],&quot;date&quot;:[3,&quot;2025-11-25T10:30:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;Trait&quot;],[0,&quot;泛型&quot;],[0,&quot;类型系统&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;]}],&quot;body&quot;:[0,&quot;## 前言\n\n在学习 Rust 的 trait 系统时，我遇到了一个有趣的问题：**为什么可以为 `Vec&lt;String&gt;` 这样的泛型类型的具体实例实现 trait？** 这似乎与我们通常理解的\&quot;只能为结构体实现 trait\&quot;的观念不太一致。本文将深入探讨这个问题，帮助你更好地理解 Rust 的类型系统。\n\n## 问题的由来\n\n假设我们定义了一个简单的 trait：\n\n```rust\ntrait AppendBar {\n    fn append_bar(&amp;mut self);\n}\n```\n\n然后，我们可以这样为 `Vec&lt;String&gt;` 实现这个 trait：\n\n```rust\nimpl AppendBar for Vec&lt;String&gt; {\n    fn append_bar(&amp;mut self) {\n        self.push(String::from(\&quot;Bar\&quot;));\n    }\n}\n```\n\n这段代码完全合法且能正常工作：\n\n```rust\nfn main() {\n    let mut my_vec: Vec&lt;String&gt; = vec![\n        String::from(\&quot;Foo\&quot;),\n        String::from(\&quot;Baz\&quot;),\n    ];\n\n    my_vec.append_bar();\n\n    println!(\&quot;{:?}\&quot;, my_vec); // 输出: [\&quot;Foo\&quot;, \&quot;Baz\&quot;, \&quot;Bar\&quot;]\n}\n```\n\n但问题来了：**`Vec&lt;String&gt;` 不是一个结构体，而是泛型类型 `Vec&lt;T&gt;` 的一个具体实例，为什么可以为它实现 trait？**\n\n## 核心概念：类型特化（Type Specialization）\n\n### 什么是类型特化？\n\n在 Rust 中，`Vec&lt;T&gt;` 是一个**泛型类型**，其中 `T` 是类型参数。当我们指定 `T = String` 时，`Vec&lt;String&gt;` 就成为了一个**具体类型**（Concrete Type），这个过程被称为**类型特化**。\n\n从 Rust 编译器的角度来看：\n\n- `Vec&lt;T&gt;` 是一个**类型构造器**（Type Constructor），需要一个类型参数才能成为完整的类型\n- `Vec&lt;String&gt;` 是一个**完整的具体类型**，和 `i32`、`String` 等具有同等地位\n\n### 类型特化的实例\n\n```rust\n// 这些都是不同的具体类型\nlet v1: Vec&lt;i32&gt; = vec![1, 2, 3];\nlet v2: Vec&lt;String&gt; = vec![\&quot;hello\&quot;.to_string()];\nlet v3: Vec&lt;Vec&lt;u8&gt;&gt; = vec![vec![1, 2], vec![3, 4]];\n```\n\n在 Rust 的类型系统中，`Vec&lt;i32&gt;`、`Vec&lt;String&gt;` 和 `Vec&lt;Vec&lt;u8&gt;&gt;` 是**三个完全不同的类型**，就像 `Dog` 和 `Cat` 是两个不同的结构体一样。\n\n## Trait 实现的灵活性\n\nRust 的 trait 系统允许你为**任何具体类型**实现 trait，不仅仅是结构体。这包括：\n\n1. **自定义结构体**\n2. **枚举类型**\n3. **泛型类型的具体实例**（如 `Vec&lt;String&gt;`）\n4. **基本类型**（如 `i32`，但需要遵循孤儿规则）\n5. **元组类型**（如 `(i32, String)`）\n\n### 示例 1：为不同的 Vec 实例实现不同的 trait\n\n```rust\ntrait AppendBar {\n    fn append_bar(&amp;mut self);\n}\n\ntrait AppendBaz {\n    fn append_baz(&amp;mut self);\n}\n\n// 为 Vec&lt;String&gt; 实现 AppendBar\nimpl AppendBar for Vec&lt;String&gt; {\n    fn append_bar(&amp;mut self) {\n        self.push(String::from(\&quot;Bar\&quot;));\n    }\n}\n\n// 为 Vec&lt;i32&gt; 实现 AppendBaz\nimpl AppendBaz for Vec&lt;i32&gt; {\n    fn append_baz(&amp;mut self) {\n        self.push(42);\n    }\n}\n\nfn main() {\n    let mut strings = vec![String::from(\&quot;Foo\&quot;)];\n    strings.append_bar(); // ✅ 可以调用\n    // strings.append_baz(); // ❌ 编译错误：Vec&lt;String&gt; 没有实现 AppendBaz\n\n    let mut numbers = vec![1, 2, 3];\n    numbers.append_baz(); // ✅ 可以调用\n    // numbers.append_bar(); // ❌ 编译错误：Vec&lt;i32&gt; 没有实现 AppendBar\n}\n```\n\n### 示例 2：为元组类型实现 trait\n\n```rust\ntrait Describable {\n    fn describe(&amp;self) -&gt; String;\n}\n\n// 为 (i32, String) 元组实现 trait\nimpl Describable for (i32, String) {\n    fn describe(&amp;self) -&gt; String {\n        format!(\&quot;Number: {}, Text: {}\&quot;, self.0, self.1)\n    }\n}\n\nfn main() {\n    let tuple = (42, String::from(\&quot;Hello\&quot;));\n    println!(\&quot;{}\&quot;, tuple.describe()); // 输出: Number: 42, Text: Hello\n}\n```\n\n## 泛型实现 vs 具体实现\n\nRust 允许你选择不同的实现策略：\n\n### 策略 1：为所有 `Vec&lt;T&gt;` 实现（泛型实现）\n\n```rust\ntrait Printable {\n    fn print_all(&amp;self);\n}\n\n// 为所有 Vec&lt;T&gt; 实现，其中 T 必须实现 Debug trait\nimpl&lt;T: std::fmt::Debug&gt; Printable for Vec&lt;T&gt; {\n    fn print_all(&amp;self) {\n        for item in self {\n            println!(\&quot;{:?}\&quot;, item);\n        }\n    }\n}\n\nfn main() {\n    let strings = vec![String::from(\&quot;Foo\&quot;), String::from(\&quot;Bar\&quot;)];\n    strings.print_all(); // ✅ 可以使用\n\n    let numbers = vec![1, 2, 3];\n    numbers.print_all(); // ✅ 也可以使用\n}\n```\n\n**特点：**\n- 为所有满足约束的 `Vec&lt;T&gt;` 实现 trait\n- trait 方法必须对所有可能的 `T` 都有效\n- 实现代码只写一次，适用于多种类型\n\n### 策略 2：为特定的 `Vec&lt;T&gt;` 实现（具体实现）\n\n```rust\ntrait StringOperations {\n    fn to_uppercase_all(&amp;mut self);\n    fn concat_all(&amp;self) -&gt; String;\n}\n\n// 仅为 Vec&lt;String&gt; 实现\nimpl StringOperations for Vec&lt;String&gt; {\n    fn to_uppercase_all(&amp;mut self) {\n        for s in self.iter_mut() {\n            *s = s.to_uppercase();\n        }\n    }\n\n    fn concat_all(&amp;self) -&gt; String {\n        self.join(\&quot;, \&quot;)\n    }\n}\n\nfn main() {\n    let mut strings = vec![String::from(\&quot;hello\&quot;), String::from(\&quot;world\&quot;)];\n    strings.to_uppercase_all();\n    println!(\&quot;{}\&quot;, strings.concat_all()); // 输出: HELLO, WORLD\n\n    // let mut numbers = vec![1, 2, 3];\n    // numbers.to_uppercase_all(); // ❌ 编译错误：Vec&lt;i32&gt; 没有实现 StringOperations\n}\n```\n\n**特点：**\n- 只为特定的 `Vec&lt;String&gt;` 实现\n- 可以使用 `String` 特有的方法（如 `to_uppercase()`）\n- 实现更有针对性，类型更安全\n\n## 实际应用场景\n\n### 场景 1：为标准库类型添加自定义功能\n\n```rust\ntrait Statistics {\n    fn mean(&amp;self) -&gt; f64;\n    fn median(&amp;self) -&gt; f64;\n}\n\nimpl Statistics for Vec&lt;f64&gt; {\n    fn mean(&amp;self) -&gt; f64 {\n        if self.is_empty() {\n            return 0.0;\n        }\n        self.iter().sum::&lt;f64&gt;() / self.len() as f64\n    }\n\n    fn median(&amp;self) -&gt; f64 {\n        if self.is_empty() {\n            return 0.0;\n        }\n        let mut sorted = self.clone();\n        sorted.sort_by(|a, b| a.partial_cmp(b).unwrap());\n        let mid = sorted.len() / 2;\n        if sorted.len() % 2 == 0 {\n            (sorted[mid - 1] + sorted[mid]) / 2.0\n        } else {\n            sorted[mid]\n        }\n    }\n}\n\nfn main() {\n    let data = vec![1.0, 2.0, 3.0, 4.0, 5.0];\n    println!(\&quot;Mean: {}\&quot;, data.mean());     // 输出: Mean: 3\n    println!(\&quot;Median: {}\&quot;, data.median()); // 输出: Median: 3\n}\n```\n\n### 场景 2：实现特定领域的类型约束\n\n```rust\ntrait JsonSerializable {\n    fn to_json(&amp;self) -&gt; String;\n}\n\n// 为字符串数组实现 JSON 序列化\nimpl JsonSerializable for Vec&lt;String&gt; {\n    fn to_json(&amp;self) -&gt; String {\n        let items: Vec&lt;String&gt; = self\n            .iter()\n            .map(|s| format!(\&quot;\\\&quot;{}\\\&quot;\&quot;, s))\n            .collect();\n        format!(\&quot;[{}]\&quot;, items.join(\&quot;, \&quot;))\n    }\n}\n\n// 为数字数组实现 JSON 序列化\nimpl JsonSerializable for Vec&lt;i32&gt; {\n    fn to_json(&amp;self) -&gt; String {\n        let items: Vec&lt;String&gt; = self\n            .iter()\n            .map(|n| n.to_string())\n            .collect();\n        format!(\&quot;[{}]\&quot;, items.join(\&quot;, \&quot;))\n    }\n}\n\nfn main() {\n    let strings = vec![String::from(\&quot;hello\&quot;), String::from(\&quot;world\&quot;)];\n    println!(\&quot;{}\&quot;, strings.to_json()); // 输出: [\&quot;hello\&quot;, \&quot;world\&quot;]\n\n    let numbers = vec![1, 2, 3];\n    println!(\&quot;{}\&quot;, numbers.to_json()); // 输出: [1, 2, 3]\n}\n```\n\n## 孤儿规则（Orphan Rule）\n\n虽然可以为泛型类型的具体实例实现 trait，但必须遵守 Rust 的**孤儿规则**：\n\n&gt; **至少 trait 或类型其中之一必须在当前 crate 中定义。**\n\n### 合法的实现\n\n```rust\n// ✅ 情况 1：trait 在本 crate 中定义\ntrait MyTrait {\n    fn do_something(&amp;self);\n}\n\n// Vec 虽然是标准库的，但 MyTrait 是我们定义的\nimpl MyTrait for Vec&lt;String&gt; {\n    fn do_something(&amp;self) {\n        println!(\&quot;Doing something with {} strings\&quot;, self.len());\n    }\n}\n\n// ✅ 情况 2：类型在本 crate 中定义\nstruct MyType {\n    data: Vec&lt;i32&gt;,\n}\n\n// Display 虽然是标准库的，但 MyType 是我们定义的\nimpl std::fmt::Display for MyType {\n    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#39;_&gt;) -&gt; std::fmt::Result {\n        write!(f, \&quot;MyType with {} elements\&quot;, self.data.len())\n    }\n}\n```\n\n### 非法的实现\n\n```rust\n// ❌ 错误：trait 和类型都不在本 crate 中\n// impl std::fmt::Display for Vec&lt;String&gt; {\n//     fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#39;_&gt;) -&gt; std::fmt::Result {\n//         write!(f, \&quot;Custom Vec Display\&quot;)\n//     }\n// }\n// 编译错误：只有在本地 crate 定义的 trait 才能为外部类型实现\n```\n\n## 特化（Specialization）的未来\n\nRust 正在开发一个更强大的特性：**trait 特化（Trait Specialization）**，它允许你先为泛型类型实现 trait，然后为特定实例提供更优化的实现。\n\n```rust\n#![feature(specialization)] // 需要 nightly Rust\n\ntrait Process {\n    fn process(&amp;self);\n}\n\n// 默认实现：适用于所有 Vec&lt;T&gt;\nimpl&lt;T&gt; Process for Vec&lt;T&gt; {\n    default fn process(&amp;self) {\n        println!(\&quot;Processing {} items (generic)\&quot;, self.len());\n    }\n}\n\n// 特化实现：针对 Vec&lt;String&gt; 的优化版本\nimpl Process for Vec&lt;String&gt; {\n    fn process(&amp;self) {\n        println!(\&quot;Processing {} strings (specialized)\&quot;, self.len());\n        for s in self {\n            println!(\&quot;  - {}\&quot;, s);\n        }\n    }\n}\n```\n\n注意：这个特性目前还在实验阶段，仅在 nightly Rust 中可用。\n\n## 总结\n\n### 关键要点\n\n1. **`Vec&lt;String&gt;` 是一个完整的具体类型**，不是泛型类型\n   - `Vec&lt;T&gt;` 是泛型类型（类型构造器）\n   - `Vec&lt;String&gt;` 是具体类型（`T` 被特化为 `String`）\n\n2. **Rust 允许为任何具体类型实现 trait**\n   - 结构体、枚举\n   - 泛型类型的具体实例（如 `Vec&lt;String&gt;`）\n   - 基本类型、元组等\n\n3. **实现策略的选择**\n   - **泛型实现**：`impl&lt;T&gt; Trait for Vec&lt;T&gt;` - 适用于所有 `T`\n   - **具体实现**：`impl Trait for Vec&lt;String&gt;` - 只适用于特定类型\n\n4. **孤儿规则必须遵守**\n   - trait 或类型至少有一个在本 crate 中定义\n   - 防止不同 crate 之间的实现冲突\n\n5. **类型安全的保证**\n   - 为 `Vec&lt;String&gt;` 实现的 trait 不会影响 `Vec&lt;i32&gt;`\n   - 每个具体类型都是独立的，编译器会严格检查\n\n### 实践建议\n\n- **优先使用泛型实现**：如果 trait 方法适用于所有 `T`，使用 `impl&lt;T&gt; Trait for Vec&lt;T&gt;`\n- **针对性优化时使用具体实现**：当需要使用特定类型的方法时，为具体类型实现 trait\n- **遵守孤儿规则**：确保 trait 或类型至少有一个在本 crate 中定义\n- **类型约束清晰**：使用具体实现可以获得更好的类型安全和代码可读性\n\n### 延伸阅读\n\n- [The Rust Programming Language - Traits](https://doc.rust-lang.org/book/ch10-02-traits.html)\n- [Rust Reference - Trait Implementation](https://doc.rust-lang.org/reference/items/implementations.html)\n- [RFC 1210 - Specialization](https://rust-lang.github.io/rfcs/1210-impl-specialization.html)\n\n希望这篇文章能帮助你更好地理解 Rust 的 trait 系统。记住：**类型特化让 Rust 的类型系统既灵活又安全**，善用这一特性可以写出更优雅的代码！\n\n---\n\n**最后提醒：** 这篇笔记记录了一个初学时容易混淆的概念。如果你也在学习 Rust，建议动手实践这些示例代码，加深理解。类型系统是 Rust 最强大的特性之一，值得深入学习！&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Rust-Trait-为泛型类型的具体实例实现特征.md&quot;],&quot;digest&quot;:[0,&quot;cf3e3092d3e4c992&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h2 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;在学习 Rust 的 trait 系统时，我遇到了一个有趣的问题：&lt;strong&gt;为什么可以为 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 这样的泛型类型的具体实例实现 trait？&lt;/strong&gt; 这似乎与我们通常理解的”只能为结构体实现 trait”的观念不太一致。本文将深入探讨这个问题，帮助你更好地理解 Rust 的类型系统。&lt;/p&gt;\n&lt;h2 id=\&quot;问题的由来\&quot;&gt;问题的由来&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#问题的由来\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;假设我们定义了一个简单的 trait：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;然后，我们可以这样为 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 实现这个 trait：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;push&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Bar\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这段代码完全合法且能正常工作：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; my_vec&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Foo\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Baz\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    ];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    my_vec&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, my_vec); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: [\&quot;Foo\&quot;, \&quot;Baz\&quot;, \&quot;Bar\&quot;]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;但问题来了：&lt;strong&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 不是一个结构体，而是泛型类型 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 的一个具体实例，为什么可以为它实现 trait？&lt;/strong&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;核心概念类型特化type-specialization\&quot;&gt;核心概念：类型特化（Type Specialization）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#核心概念类型特化type-specialization\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;什么是类型特化\&quot;&gt;什么是类型特化？&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#什么是类型特化\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在 Rust 中，&lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 是一个&lt;strong&gt;泛型类型&lt;/strong&gt;，其中 &lt;code&gt;T&lt;/code&gt; 是类型参数。当我们指定 &lt;code&gt;T = String&lt;/code&gt; 时，&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 就成为了一个&lt;strong&gt;具体类型&lt;/strong&gt;（Concrete Type），这个过程被称为&lt;strong&gt;类型特化&lt;/strong&gt;。&lt;/p&gt;\n&lt;p&gt;从 Rust 编译器的角度来看：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 是一个&lt;strong&gt;类型构造器&lt;/strong&gt;（Type Constructor），需要一个类型参数才能成为完整的类型&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 是一个&lt;strong&gt;完整的具体类型&lt;/strong&gt;，和 &lt;code&gt;i32&lt;/code&gt;、&lt;code&gt;String&lt;/code&gt; 等具有同等地位&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;类型特化的实例\&quot;&gt;类型特化的实例&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#类型特化的实例\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 这些都是不同的具体类型&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; v1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; v2&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; v3&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;], &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;4&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;]];&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;在 Rust 的类型系统中，&lt;code&gt;Vec&amp;#x3C;i32&gt;&lt;/code&gt;、&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 和 &lt;code&gt;Vec&amp;#x3C;Vec&amp;#x3C;u8&gt;&gt;&lt;/code&gt; 是&lt;strong&gt;三个完全不同的类型&lt;/strong&gt;，就像 &lt;code&gt;Dog&lt;/code&gt; 和 &lt;code&gt;Cat&lt;/code&gt; 是两个不同的结构体一样。&lt;/p&gt;\n&lt;h2 id=\&quot;trait-实现的灵活性\&quot;&gt;Trait 实现的灵活性&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#trait-实现的灵活性\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 的 trait 系统允许你为&lt;strong&gt;任何具体类型&lt;/strong&gt;实现 trait，不仅仅是结构体。这包括：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;自定义结构体&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;枚举类型&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;泛型类型的具体实例&lt;/strong&gt;（如 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt;）&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;基本类型&lt;/strong&gt;（如 &lt;code&gt;i32&lt;/code&gt;，但需要遵循孤儿规则）&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;元组类型&lt;/strong&gt;（如 &lt;code&gt;(i32, String)&lt;/code&gt;）&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;示例-1为不同的-vec-实例实现不同的-trait\&quot;&gt;示例 1：为不同的 Vec 实例实现不同的 trait&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#示例-1为不同的-vec-实例实现不同的-trait\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBaz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_baz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为 Vec&amp;#x3C;String&gt; 实现 AppendBar&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;push&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Bar\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为 Vec&amp;#x3C;i32&gt; 实现 AppendBaz&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBaz&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_baz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;push&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;42&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Foo\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 可以调用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // strings.append_baz(); // ❌ 编译错误：Vec&amp;#x3C;String&gt; 没有实现 AppendBaz&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    numbers&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;append_baz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 可以调用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // numbers.append_bar(); // ❌ 编译错误：Vec&amp;#x3C;i32&gt; 没有实现 AppendBar&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;示例-2为元组类型实现-trait\&quot;&gt;示例 2：为元组类型实现 trait&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#示例-2为元组类型实现-trait\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Describable&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; describe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为 (i32, String) 元组实现 trait&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Describable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; describe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Number: {}, Text: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; tuple &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;42&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, tuple&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;describe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: Number: 42, Text: Hello&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;泛型实现-vs-具体实现\&quot;&gt;泛型实现 vs 具体实现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#泛型实现-vs-具体实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 允许你选择不同的实现策略：&lt;/p&gt;\n&lt;h3 id=\&quot;策略-1为所有-vect-实现泛型实现\&quot;&gt;策略 1：为所有 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 实现（泛型实现）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#策略-1为所有-vect-实现泛型实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Printable&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为所有 Vec&amp;#x3C;T&gt; 实现，其中 T 必须实现 Debug trait&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Debug&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Printable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; item &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;            println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, item);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Foo\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Bar\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 可以使用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    numbers&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 也可以使用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;特点：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;为所有满足约束的 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 实现 trait&lt;/li&gt;\n&lt;li&gt;trait 方法必须对所有可能的 &lt;code&gt;T&lt;/code&gt; 都有效&lt;/li&gt;\n&lt;li&gt;实现代码只写一次，适用于多种类型&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;策略-2为特定的-vect-实现具体实现\&quot;&gt;策略 2：为特定的 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 实现（具体实现）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#策略-2为特定的-vect-实现具体实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; StringOperations&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_uppercase_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; concat_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 仅为 Vec&amp;#x3C;String&gt; 实现&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; StringOperations&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_uppercase_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter_mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            *&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_uppercase&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; concat_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;join&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;, \&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;world\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_uppercase_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;concat_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: HELLO, WORLD&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let mut numbers = vec![1, 2, 3];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // numbers.to_uppercase_all(); // ❌ 编译错误：Vec&amp;#x3C;i32&gt; 没有实现 StringOperations&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;特点：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;只为特定的 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 实现&lt;/li&gt;\n&lt;li&gt;可以使用 &lt;code&gt;String&lt;/code&gt; 特有的方法（如 &lt;code&gt;to_uppercase()&lt;/code&gt;）&lt;/li&gt;\n&lt;li&gt;实现更有针对性，类型更安全&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;实际应用场景\&quot;&gt;实际应用场景&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实际应用场景\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;场景-1为标准库类型添加自定义功能\&quot;&gt;场景 1：为标准库类型添加自定义功能&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-1为标准库类型添加自定义功能\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Statistics&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; mean&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; median&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Statistics&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; mean&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        if&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;is_empty&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            return&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;sum&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;as&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; median&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        if&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;is_empty&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            return&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;clone&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        sorted&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;sort_by&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;a, b&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;partial_cmp&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;unwrap&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; mid &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 2&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; ==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            (sorted[mid &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;] &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted[mid]) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 2.0&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            sorted[mid]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; data &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;4.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Mean: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;mean&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: Mean: 3&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Median: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;median&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: Median: 3&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;场景-2实现特定领域的类型约束\&quot;&gt;场景 2：实现特定领域的类型约束&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-2实现特定领域的类型约束\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; JsonSerializable&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为字符串数组实现 JSON 序列化&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; JsonSerializable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;map&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;\\\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;{}&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;\\\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, s))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;collect&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;[{}]\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;join&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;, \&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为数字数组实现 JSON 序列化&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; JsonSerializable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;map&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;collect&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;[{}]\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;join&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;, \&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;world\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: [\&quot;hello\&quot;, \&quot;world\&quot;]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, numbers&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: [1, 2, 3]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;孤儿规则orphan-rule\&quot;&gt;孤儿规则（Orphan Rule）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#孤儿规则orphan-rule\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;虽然可以为泛型类型的具体实例实现 trait，但必须遵守 Rust 的&lt;strong&gt;孤儿规则&lt;/strong&gt;：&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;&lt;strong&gt;至少 trait 或类型其中之一必须在当前 crate 中定义。&lt;/strong&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h3 id=\&quot;合法的实现\&quot;&gt;合法的实现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#合法的实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 情况 1：trait 在本 crate 中定义&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyTrait&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; do_something&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Vec 虽然是标准库的，但 MyTrait 是我们定义的&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyTrait&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; do_something&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Doing something with {} strings\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 情况 2：类型在本 crate 中定义&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;struct&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyType&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Display 虽然是标准库的，但 MyType 是我们定义的&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Display&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyType&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; fmt&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, f&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Formatter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;_&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Result&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        write!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(f, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;MyType with {} elements\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;非法的实现\&quot;&gt;非法的实现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#非法的实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ❌ 错误：trait 和类型都不在本 crate 中&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// impl std::fmt::Display for Vec&amp;#x3C;String&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;//     fn fmt(&amp;#x26;self, f: &amp;#x26;mut std::fmt::Formatter&amp;#x3C;&#39;_&gt;) -&gt; std::fmt::Result {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;//         write!(f, \&quot;Custom Vec Display\&quot;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;//     }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 编译错误：只有在本地 crate 定义的 trait 才能为外部类型实现&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;特化specialization的未来\&quot;&gt;特化（Specialization）的未来&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#特化specialization的未来\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 正在开发一个更强大的特性：&lt;strong&gt;trait 特化（Trait Specialization）&lt;/strong&gt;，它允许你先为泛型类型实现 trait，然后为特定实例提供更优化的实现。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;#![feature(specialization)] &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 需要 nightly Rust&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 默认实现：适用于所有 Vec&amp;#x3C;T&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Process&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    default &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Processing {} items (generic)\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 特化实现：针对 Vec&amp;#x3C;String&gt; 的优化版本&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Process&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Processing {} strings (specialized)\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;            println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;  - {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, s);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;注意：这个特性目前还在实验阶段，仅在 nightly Rust 中可用。&lt;/p&gt;\n&lt;h2 id=\&quot;总结\&quot;&gt;总结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#总结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;关键要点\&quot;&gt;关键要点&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#关键要点\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 是一个完整的具体类型&lt;/strong&gt;，不是泛型类型&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 是泛型类型（类型构造器）&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 是具体类型（&lt;code&gt;T&lt;/code&gt; 被特化为 &lt;code&gt;String&lt;/code&gt;）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Rust 允许为任何具体类型实现 trait&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;结构体、枚举&lt;/li&gt;\n&lt;li&gt;泛型类型的具体实例（如 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt;）&lt;/li&gt;\n&lt;li&gt;基本类型、元组等&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;实现策略的选择&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;泛型实现&lt;/strong&gt;：&lt;code&gt;impl&amp;#x3C;T&gt; Trait for Vec&amp;#x3C;T&gt;&lt;/code&gt; - 适用于所有 &lt;code&gt;T&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;具体实现&lt;/strong&gt;：&lt;code&gt;impl Trait for Vec&amp;#x3C;String&gt;&lt;/code&gt; - 只适用于特定类型&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;孤儿规则必须遵守&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;trait 或类型至少有一个在本 crate 中定义&lt;/li&gt;\n&lt;li&gt;防止不同 crate 之间的实现冲突&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;类型安全的保证&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;为 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 实现的 trait 不会影响 &lt;code&gt;Vec&amp;#x3C;i32&gt;&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;每个具体类型都是独立的，编译器会严格检查&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;实践建议\&quot;&gt;实践建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实践建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;优先使用泛型实现&lt;/strong&gt;：如果 trait 方法适用于所有 &lt;code&gt;T&lt;/code&gt;，使用 &lt;code&gt;impl&amp;#x3C;T&gt; Trait for Vec&amp;#x3C;T&gt;&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;针对性优化时使用具体实现&lt;/strong&gt;：当需要使用特定类型的方法时，为具体类型实现 trait&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;遵守孤儿规则&lt;/strong&gt;：确保 trait 或类型至少有一个在本 crate 中定义&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;类型约束清晰&lt;/strong&gt;：使用具体实现可以获得更好的类型安全和代码可读性&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;延伸阅读\&quot;&gt;延伸阅读&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#延伸阅读\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/book/ch10-02-traits.html\&quot;&gt;The Rust Programming Language - Traits&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/reference/items/implementations.html\&quot;&gt;Rust Reference - Trait Implementation&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://rust-lang.github.io/rfcs/1210-impl-specialization.html\&quot;&gt;RFC 1210 - Specialization&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;希望这篇文章能帮助你更好地理解 Rust 的 trait 系统。记住：&lt;strong&gt;类型特化让 Rust 的类型系统既灵活又安全&lt;/strong&gt;，善用这一特性可以写出更优雅的代码！&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;最后提醒：&lt;/strong&gt; 这篇笔记记录了一个初学时容易混淆的概念。如果你也在学习 Rust，建议动手实践这些示例代码，加深理解。类型系统是 Rust 最强大的特性之一，值得深入学习！&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;问题的由来&quot;],&quot;text&quot;:[0,&quot;问题的由来&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;核心概念类型特化type-specialization&quot;],&quot;text&quot;:[0,&quot;核心概念：类型特化（Type Specialization）&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;什么是类型特化&quot;],&quot;text&quot;:[0,&quot;什么是类型特化？&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;类型特化的实例&quot;],&quot;text&quot;:[0,&quot;类型特化的实例&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;trait-实现的灵活性&quot;],&quot;text&quot;:[0,&quot;Trait 实现的灵活性&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;示例-1为不同的-vec-实例实现不同的-trait&quot;],&quot;text&quot;:[0,&quot;示例 1：为不同的 Vec 实例实现不同的 trait&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;示例-2为元组类型实现-trait&quot;],&quot;text&quot;:[0,&quot;示例 2：为元组类型实现 trait&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;泛型实现-vs-具体实现&quot;],&quot;text&quot;:[0,&quot;泛型实现 vs 具体实现&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;策略-1为所有-vect-实现泛型实现&quot;],&quot;text&quot;:[0,&quot;策略 1：为所有 Vec&lt;T&gt; 实现（泛型实现）&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;策略-2为特定的-vect-实现具体实现&quot;],&quot;text&quot;:[0,&quot;策略 2：为特定的 Vec&lt;T&gt; 实现（具体实现）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;实际应用场景&quot;],&quot;text&quot;:[0,&quot;实际应用场景&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-1为标准库类型添加自定义功能&quot;],&quot;text&quot;:[0,&quot;场景 1：为标准库类型添加自定义功能&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-2实现特定领域的类型约束&quot;],&quot;text&quot;:[0,&quot;场景 2：实现特定领域的类型约束&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;孤儿规则orphan-rule&quot;],&quot;text&quot;:[0,&quot;孤儿规则（Orphan Rule）&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;合法的实现&quot;],&quot;text&quot;:[0,&quot;合法的实现&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;非法的实现&quot;],&quot;text&quot;:[0,&quot;非法的实现&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;特化specialization的未来&quot;],&quot;text&quot;:[0,&quot;特化（Specialization）的未来&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;总结&quot;],&quot;text&quot;:[0,&quot;总结&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;关键要点&quot;],&quot;text&quot;:[0,&quot;关键要点&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;实践建议&quot;],&quot;text&quot;:[0,&quot;实践建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;延伸阅读&quot;],&quot;text&quot;:[0,&quot;延伸阅读&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Rust Trait：为泛型类型的具体实例实现特征&quot;],&quot;date&quot;:[3,&quot;2025-11-25T10:30:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;Trait&quot;],[0,&quot;泛型&quot;],[0,&quot;类型系统&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;],&quot;description&quot;:[0,&quot;深入理解 Rust 中 trait 实现的灵活性：为什么可以为 Vec&lt;String&gt; 这样的泛型类型具体实例实现 trait？探讨 Rust 类型系统中的类型特化（Type Specialization）、trait 实现的作用范围，以及如何利用这一特性编写更灵活的代码。&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/18&quot;]}]]],&quot;currentPostSlug&quot;:[0,&quot;rust引用生命周期-不只是切片&quot;],&quot;data-astro-cid-nxumbhks&quot;:[0,true]}" ssr client="load" opts="{&quot;name&quot;:&quot;SeriesPostList&quot;,&quot;value&quot;:true}" await-children><div class="flex flex-col gap-1"><a href="/blog/post/20" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Rust 算术运算的 Panic 陷阱：从取模零说起</span></a><a href="/blog/post/19" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50 text-primary font-medium"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-primary"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-primary">Rust 引用生命周期：不只是切片</span></a><a href="/blog/post/18" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Rust Trait：为泛型类型的具体实例实现特征</span></a></div><!--astro:end--></astro-island> </div> </sider-content> <!-- 内联脚本：在 DOM 解析后立即隐藏不需要的内容，避免闪烁 --> <script data-astro-rerun>
    (function () {
      const container = document.querySelector('sider-content');
      ;
      if (!container) return;

      const defaultType = container.getAttribute('data-default-type') || 'info';
      ;
      const slots = container.querySelectorAll('.sider-slot');
      ;

      slots.forEach((slot) => {
        const slotType = slot.getAttribute('data-slot-type');
        ;
        if (slotType !== defaultType) {
          slot.classList.add('hidden');
        }
      });
    })();
  </script> <astro-island uid="ZaW5Gv" prefix="r28" component-url="/_astro/SeriesNavigation.BuYCsLkT.js" component-export="SeriesNavigation" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;prevPost&quot;:[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;rust算术运算的panic陷阱-从取模零说起&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Rust 算术运算的 Panic 陷阱：从取模零说起&quot;],&quot;description&quot;:[0,&quot;在刷 Rust 算法题时发现了一个独特现象：对零取模会直接导致程序 panic！这与其他语言的行为截然不同。本文深入探讨 Rust 中会导致 panic 的算术运算场景，包括除零、整数溢出、INT_MIN/-1 等特殊情况，以及 Rust 提供的 checked_、wrapping_、saturating_ 等安全替代方案。理解这些行为对于编写健壮的 Rust 程序至关重要。&quot;],&quot;date&quot;:[3,&quot;2025-12-02T10:00:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;算法&quot;],[0,&quot;安全&quot;],[0,&quot;Panic&quot;],[0,&quot;算术运算&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;]}],&quot;body&quot;:[0,&quot;## 前言\n\n今天在刷 Rust 算法题时，遇到了一个让我印象深刻的情况：**当我尝试对 0 取模时，程序直接 panic 了！**\n\n```rust\nfn main() {\n    let x = 10;\n    let y = 0;\n    let result = x % y;  // 💥 thread &#39;main&#39; panicked at &#39;attempt to calculate the remainder with a divisor of zero&#39;\n}\n```\n\n这个行为在其他语言中并不常见。比如在 JavaScript 中，`10 % 0` 会返回 `NaN`；在 Python 中会抛出 `ZeroDivisionError` 异常（可以被捕获）。而 **Rust 选择直接 panic，整个程序崩溃，无法通过普通的错误处理机制捕获**。\n\n这引发了我的好奇：Rust 中还有哪些类似的\&quot;地雷\&quot;？让我们一探究竟。\n\n## Rust 中会导致 Panic 的算术运算\n\n### 1. 除法和取模运算的零除错误\n\n在 Rust 中，**整数的除法和取模运算遇到零除数时会无条件 panic**：\n\n```rust\nfn main() {\n    let a = 10;\n    let b = 0;\n\n    // 💥 除法遇到零：panic!\n    // let div = a / b;\n\n    // 💥 取模遇到零：panic!\n    // let rem = a % b;\n\n    println!(\&quot;这行代码永远不会执行\&quot;);\n}\n```\n\n**为什么会这样？**\n\nRust 的设计哲学是：**宁可 panic 也不产生未定义行为（Undefined Behavior, UB）**。在很多底层语言（如 C/C++）中，除以零会导致 UB，这可能造成：\n- 程序段错误（Segmentation Fault）\n- 返回垃圾值\n- 安全漏洞\n\nRust 通过显式 panic 来避免这些不可预测的行为，让错误在第一时间暴露出来。\n\n**浮点数例外**\n\n有趣的是，**浮点数的除零操作不会 panic**，而是遵循 IEEE 754 标准：\n\n```rust\nfn main() {\n    let x = 10.0;\n    let y = 0.0;\n\n    println!(\&quot;{}\&quot;, x / y);      // ✅ inf (正无穷)\n    println!(\&quot;{}\&quot;, -x / y);     // ✅ -inf (负无穷)\n    println!(\&quot;{}\&quot;, y / y);      // ✅ NaN (Not a Number)\n\n    // 浮点数取模也不会 panic，但会返回 NaN\n    println!(\&quot;{}\&quot;, x % y);      // ✅ NaN\n}\n```\n\n### 2. 整数溢出的特殊边界情况\n\n还有一个更隐蔽的陷阱：**`INT_MIN / -1` 和 `INT_MIN % -1` 也会 panic**！\n\n```rust\nfn main() {\n    let min = i8::MIN;  // -128\n    let divisor = -1;\n\n    // 💥 这会 panic！\n    // let result = min / divisor;\n\n    // 💥 这也会 panic！\n    // let remainder = min % divisor;\n}\n```\n\n**为什么？**\n\n对于 8 位有符号整数 `i8`：\n- 最小值：`i8::MIN = -128`\n- 最大值：`i8::MAX = 127`\n\n当我们计算 `-128 / -1` 时，数学结果应该是 `128`，但这**超出了 `i8` 的表示范围**（最大只能到 127），导致溢出。Rust 选择 panic 而不是返回错误的结果。\n\n```rust\nfn demonstrate_overflow() {\n    // 对于不同的整数类型，都存在这个问题\n    println!(\&quot;i8::MIN  / -1 会 panic: {}\&quot;, i8::MIN);   // -128 / -1 = 128 (溢出!)\n    println!(\&quot;i16::MIN / -1 会 panic: {}\&quot;, i16::MIN);  // -32768 / -1 = 32768 (溢出!)\n    println!(\&quot;i32::MIN / -1 会 panic: {}\&quot;, i32::MIN);  // -2147483648 / -1 = 2147483648 (溢出!)\n    println!(\&quot;i64::MIN / -1 会 panic: {}\&quot;, i64::MIN);  // 同理\n}\n```\n\n### 3. Debug 模式下的整数溢出\n\nRust 在 **debug 模式和 release 模式下对整数溢出的处理不同**：\n\n```rust\nfn main() {\n    let max = u8::MAX;  // 255\n\n    // Debug 模式：💥 panic!\n    // Release 模式：✅ 环绕到 0 (wrapping)\n    let result = max + 1;\n\n    println!(\&quot;Result: {}\&quot;, result);\n}\n```\n\n**行为差异：**\n\n| 模式 | 溢出行为 | 原因 |\n|------|----------|------|\n| **Debug** (`cargo build`) | Panic | 帮助开发者尽早发现 bug |\n| **Release** (`cargo build --release`) | 二进制补码环绕 | 性能优化，避免运行时检查开销 |\n\n在 release 模式下：\n```rust\nu8::MAX + 1      // =&gt; 0   (255 + 1 环绕为 0)\nu8::MIN - 1      // =&gt; 255 (0 - 1 环绕为 255)\ni8::MAX + 1      // =&gt; -128 (127 + 1 环绕为 -128)\n```\n\n这意味着：**同样的代码在不同编译模式下可能有完全不同的行为！**\n\n## Rust 的解决方案：显式的溢出处理\n\n为了让开发者能够精确控制溢出行为，Rust 提供了多种方法变体：\n\n### 1. `checked_*` 系列：安全检查，返回 Option\n\n```rust\nfn safe_division(a: i32, b: i32) -&gt; Option&lt;i32&gt; {\n    a.checked_div(b)\n}\n\nfn main() {\n    println!(\&quot;{:?}\&quot;, 10.checked_div(2));   // Some(5)\n    println!(\&quot;{:?}\&quot;, 10.checked_div(0));   // None - 零除返回 None 而不是 panic\n    println!(\&quot;{:?}\&quot;, i32::MIN.checked_div(-1)); // None - 溢出返回 None\n\n    // 其他 checked 方法\n    println!(\&quot;{:?}\&quot;, 255u8.checked_add(1));     // None\n    println!(\&quot;{:?}\&quot;, 0u8.checked_sub(1));       // None\n    println!(\&quot;{:?}\&quot;, 128i8.checked_mul(2));     // None\n    println!(\&quot;{:?}\&quot;, 10.checked_rem(0));        // None - 取模零也返回 None\n}\n```\n\n**适用场景：**\n- 用户输入处理\n- 外部数据验证\n- 需要优雅处理错误的场景\n\n### 2. `wrapping_*` 系列：显式环绕行为\n\n```rust\nfn main() {\n    // 无论 debug 还是 release 模式，都保证环绕行为\n    println!(\&quot;{}\&quot;, 255u8.wrapping_add(1));      // 0\n    println!(\&quot;{}\&quot;, 0u8.wrapping_sub(1));        // 255\n    println!(\&quot;{}\&quot;, 200u8.wrapping_mul(2));      // 144 (400 % 256)\n\n    // 环绕除法：零除仍然会 panic！\n    // println!(\&quot;{}\&quot;, 10.wrapping_div(0));  // 💥 仍然 panic\n\n    // 但 INT_MIN / -1 会环绕而不是 panic\n    println!(\&quot;{}\&quot;, i8::MIN.wrapping_div(-1));   // -128 (环绕到自身)\n}\n```\n\n**适用场景：**\n- 哈希计算\n- 密码学算法\n- 需要明确的模运算语义\n\n### 3. `saturating_*` 系列：饱和到边界值\n\n```rust\nfn main() {\n    // 溢出时返回类型的最大/最小值\n    println!(\&quot;{}\&quot;, 255u8.saturating_add(1));    // 255 (不超过最大值)\n    println!(\&quot;{}\&quot;, 0u8.saturating_sub(1));      // 0   (不低于最小值)\n    println!(\&quot;{}\&quot;, 200u8.saturating_mul(2));    // 255 (饱和到最大值)\n\n    // 有符号整数\n    println!(\&quot;{}\&quot;, 127i8.saturating_add(1));    // 127\n    println!(\&quot;{}\&quot;, (-128i8).saturating_sub(1)); // -128\n\n    // 除法仍然对零除 panic\n    // println!(\&quot;{}\&quot;, 10.saturating_div(0));  // 💥 panic\n}\n```\n\n**适用场景：**\n- 音频/视频处理（音量、亮度限制）\n- 游戏开发（生命值、伤害计算）\n- UI 组件（滚动位置、进度条）\n\n### 4. `overflowing_*` 系列：返回结果和溢出标志\n\n```rust\nfn main() {\n    let (result, overflowed) = 255u8.overflowing_add(1);\n    println!(\&quot;Result: {}, Overflowed: {}\&quot;, result, overflowed);\n    // Result: 0, Overflowed: true\n\n    let (result, overflowed) = 100u8.overflowing_add(50);\n    println!(\&quot;Result: {}, Overflowed: {}\&quot;, result, overflowed);\n    // Result: 150, Overflowed: false\n\n    // 可以用来实现自定义的溢出处理逻辑\n    let (div, overflow) = i8::MIN.overflowing_div(-1);\n    println!(\&quot;Division: {}, Overflow: {}\&quot;, div, overflow);\n    // Division: -128, Overflow: true\n}\n```\n\n**适用场景：**\n- 需要记录溢出事件\n- 实现自定义的错误报告\n- 性能敏感但需要溢出信息的代码\n\n### 5. `strict_*` 系列：总是 Panic（Rust 1.80+）\n\n```rust\nfn main() {\n    // 无论 debug 还是 release，溢出总是 panic\n    // let result = 255u8.strict_add(1);  // 💥 panic in both debug and release\n\n    // 这对于需要严格保证数学正确性的场景很有用\n}\n```\n\n**适用场景：**\n- 金融计算\n- 科学计算\n- 任何不能容忍静默溢出的场景\n\n## 完整的除零安全处理示例\n\n结合上面的知识，我们可以写一个安全的计算器函数：\n\n```rust\n#[derive(Debug, PartialEq)]\nenum CalcError {\n    DivisionByZero,\n    Overflow,\n}\n\nfn safe_calculator(a: i32, b: i32, op: char) -&gt; Result&lt;i32, CalcError&gt; {\n    match op {\n        &#39;+&#39; =&gt; a.checked_add(b).ok_or(CalcError::Overflow),\n        &#39;-&#39; =&gt; a.checked_sub(b).ok_or(CalcError::Overflow),\n        &#39;*&#39; =&gt; a.checked_mul(b).ok_or(CalcError::Overflow),\n        &#39;/&#39; =&gt; {\n            if b == 0 {\n                Err(CalcError::DivisionByZero)\n            } else {\n                a.checked_div(b).ok_or(CalcError::Overflow)\n            }\n        }\n        &#39;%&#39; =&gt; {\n            if b == 0 {\n                Err(CalcError::DivisionByZero)\n            } else {\n                a.checked_rem(b).ok_or(CalcError::Overflow)\n            }\n        }\n        _ =&gt; panic!(\&quot;Unsupported operation\&quot;),\n    }\n}\n\nfn main() {\n    println!(\&quot;{:?}\&quot;, safe_calculator(10, 2, &#39;/&#39;));   // Ok(5)\n    println!(\&quot;{:?}\&quot;, safe_calculator(10, 0, &#39;/&#39;));   // Err(DivisionByZero)\n    println!(\&quot;{:?}\&quot;, safe_calculator(10, 0, &#39;%&#39;));   // Err(DivisionByZero)\n    println!(\&quot;{:?}\&quot;, safe_calculator(i32::MAX, 1, &#39;+&#39;)); // Err(Overflow)\n    println!(\&quot;{:?}\&quot;, safe_calculator(i32::MIN, -1, &#39;/&#39;)); // Err(Overflow)\n}\n```\n\n## Rust vs 其他语言\n\n让我们对比一下不同语言对除零的处理：\n\n| 语言 | `10 / 0` 行为 | `10 % 0` 行为 | 可捕获？ |\n|------|---------------|---------------|----------|\n| **Rust** | Panic（程序崩溃） | Panic（程序崩溃） | ❌ 不可用 try-catch 捕获 |\n| **Python** | 抛出 `ZeroDivisionError` | 抛出 `ZeroDivisionError` | ✅ 可用 try-except 捕获 |\n| **JavaScript** | `Infinity` | `NaN` | ✅ 不抛出异常，返回特殊值 |\n| **Java** | 抛出 `ArithmeticException` | 抛出 `ArithmeticException` | ✅ 可用 try-catch 捕获 |\n| **C/C++** | 未定义行为（UB） | 未定义行为（UB） | ❌ 无标准异常机制 |\n| **Go** | Panic | Panic | ⚠️ 可用 recover 捕获（不推荐） |\n\n**Rust 的设计权衡：**\n\n1. **不使用异常机制**：Rust 没有 try-catch 异常系统，这避免了隐藏的控制流和性能开销\n2. **强制显式处理**：通过 `checked_*` 等方法，强制开发者在可能出错的地方显式处理\n3. **Panic 是最后手段**：Panic 用于\&quot;不可恢复的错误\&quot;，而零除被认为是编程错误而非业务逻辑错误\n\n## 实战建议\n\n### 1. 算法题中的处理\n\n在刷算法题时，可以这样处理：\n\n```rust\n// ❌ 危险：可能 panic\nfn solve_naive(n: i32, m: i32) -&gt; i32 {\n    (n * n) % m  // 如果 m 为 0，直接崩溃\n}\n\n// ✅ 安全：添加前置检查\nfn solve_safe(n: i32, m: i32) -&gt; Option&lt;i32&gt; {\n    if m == 0 {\n        return None;\n    }\n    Some((n * n) % m)\n}\n\n// ✅ 更好：使用 checked 方法\nfn solve_better(n: i32, m: i32) -&gt; Option&lt;i32&gt; {\n    n.checked_mul(n)?.checked_rem(m)\n}\n```\n\n### 2. 生产代码的建议\n\n```rust\n// 对于用户输入，总是使用 checked_* 方法\nfn process_user_input(dividend: i32, divisor: i32) -&gt; Result&lt;i32, String&gt; {\n    dividend\n        .checked_div(divisor)\n        .ok_or_else(|| {\n            if divisor == 0 {\n                \&quot;除数不能为零\&quot;.to_string()\n            } else {\n                \&quot;计算溢出\&quot;.to_string()\n            }\n        })\n}\n\n// 对于性能敏感且确定不会溢出的代码，可以使用普通运算符\nfn fast_index_calculation(base: usize, offset: usize, size: usize) -&gt; usize {\n    // 假设已经在外层保证了不会溢出\n    (base + offset) % size\n}\n\n// 对于需要环绕语义的场景，明确使用 wrapping_*\nfn hash_combine(hash1: u64, hash2: u64) -&gt; u64 {\n    hash1.wrapping_add(hash2).wrapping_mul(0x9e3779b97f4a7c15)\n}\n```\n\n### 3. 测试建议\n\n```rust\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    #[should_panic(expected = \&quot;divide by zero\&quot;)]\n    fn test_division_by_zero_panics() {\n        let _ = 10 / 0;\n    }\n\n    #[test]\n    #[should_panic(expected = \&quot;remainder\&quot;)]\n    fn test_modulo_by_zero_panics() {\n        let _ = 10 % 0;\n    }\n\n    #[test]\n    fn test_safe_division() {\n        assert_eq!(10.checked_div(2), Some(5));\n        assert_eq!(10.checked_div(0), None);\n        assert_eq!(i32::MIN.checked_div(-1), None);\n    }\n}\n```\n\n## 总结\n\n### 关键要点\n\n1. **Rust 中会导致 panic 的算术运算：**\n   - `a / 0` 和 `a % 0`（整数）\n   - `INT_MIN / -1` 和 `INT_MIN % -1`\n   - Debug 模式下的整数溢出\n\n2. **浮点数例外：**\n   - `f32/f64` 的除零不会 panic，返回 `Infinity` 或 `NaN`\n\n3. **Debug vs Release 的差异：**\n   - Debug：溢出 panic，帮助调试\n   - Release：溢出环绕，优化性能\n   - 使用 `checked_*` 等方法可以统一行为\n\n4. **Rust 的解决方案：**\n   - `checked_*`：安全检查，返回 `Option&lt;T&gt;`\n   - `wrapping_*`：显式环绕\n   - `saturating_*`：饱和到边界\n   - `overflowing_*`：返回结果和溢出标志\n   - `strict_*`：总是 panic（Rust 1.80+）\n\n5. **设计哲学：**\n   - 避免未定义行为\n   - 强制显式处理\n   - Panic 用于不可恢复的编程错误\n\n### 实践建议\n\n- ✅ **用户输入和外部数据**：总是使用 `checked_*` 方法\n- ✅ **算法题**：添加边界检查或使用 `checked_*`\n- ✅ **性能关键路径**：如果确定安全，可以用普通运算符，但要有充分的注释说明\n- ✅ **需要环绕语义**：明确使用 `wrapping_*`\n- ✅ **测试**：为边界情况编写测试，包括 panic 测试\n\n### 延伸阅读\n\n- [Rust RFC 560 - Integer Overflow](https://rust-lang.github.io/rfcs/0560-integer-overflow.html)\n- [Myths and Legends about Integer Overflow in Rust](https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/)\n- [Rust Documentation - Div trait](https://doc.rust-lang.org/std/ops/trait.Div.html)\n- [Behavior not considered unsafe - Rust Reference](https://doc.rust-lang.org/reference/behavior-not-considered-unsafe.html)\n- [Exploring Rust&#39;s Overflow Behavior - Sling Academy](https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/)\n\n---\n\n**最后提醒：** 这些行为不是 bug，而是 Rust 为了安全性做出的有意设计。理解这些特性，才能写出既安全又高效的 Rust 代码。下次刷算法题时，记得留意除法和取模操作，不要让你的解答因为一个 `% 0` 而崩溃！\n\n写到这里，我想起了前一个月的 cloudflare的unwarp 造成的panic!。真的很好笑。\n\n一定要注意rust一切可能引起panic!的可能性，才不会像cloudflare的unwarp方法一样，搞出的几十亿美金的全球网站崩溃漏洞。\n\nSources:\n- [Rust RFC 560 - Integer Overflow](https://rust-lang.github.io/rfcs/0560-integer-overflow.html)\n- [Myths and Legends about Integer Overflow in Rust](https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/)\n- [What happens in Rust programming language when an integer arithmetic operation overflows? - Stack Overflow](https://stackoverflow.com/questions/68807024/what-happens-in-rust-programming-language-when-an-integer-arithmetic-operation-o)\n- [Exploring Rust&#39;s Overflow Behavior: Wrapping, Saturating, and Panicking - Sling Academy](https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/)\n- [Div in std::ops - Rust](https://doc.rust-lang.org/std/ops/trait.Div.html)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Rust算术运算的Panic陷阱-从取模零说起.md&quot;],&quot;digest&quot;:[0,&quot;a24451f5fe38d184&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h2 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;今天在刷 Rust 算法题时，遇到了一个让我印象深刻的情况：&lt;strong&gt;当我尝试对 0 取模时，程序直接 panic 了！&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; result &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y;  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 💥 thread &#39;main&#39; panicked at &#39;attempt to calculate the remainder with a divisor of zero&#39;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这个行为在其他语言中并不常见。比如在 JavaScript 中，&lt;code&gt;10 % 0&lt;/code&gt; 会返回 &lt;code&gt;NaN&lt;/code&gt;；在 Python 中会抛出 &lt;code&gt;ZeroDivisionError&lt;/code&gt; 异常（可以被捕获）。而 &lt;strong&gt;Rust 选择直接 panic，整个程序崩溃，无法通过普通的错误处理机制捕获&lt;/strong&gt;。&lt;/p&gt;\n&lt;p&gt;这引发了我的好奇：Rust 中还有哪些类似的”地雷”？让我们一探究竟。&lt;/p&gt;\n&lt;h2 id=\&quot;rust-中会导致-panic-的算术运算\&quot;&gt;Rust 中会导致 Panic 的算术运算&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#rust-中会导致-panic-的算术运算\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;1-除法和取模运算的零除错误\&quot;&gt;1. 除法和取模运算的零除错误&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-除法和取模运算的零除错误\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在 Rust 中，&lt;strong&gt;整数的除法和取模运算遇到零除数时会无条件 panic&lt;/strong&gt;：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; b &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 除法遇到零：panic!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let div = a / b;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 取模遇到零：panic!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let rem = a % b;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;这行代码永远不会执行\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;为什么会这样？&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Rust 的设计哲学是：&lt;strong&gt;宁可 panic 也不产生未定义行为（Undefined Behavior, UB）&lt;/strong&gt;。在很多底层语言（如 C/C++）中，除以零会导致 UB，这可能造成：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;程序段错误（Segmentation Fault）&lt;/li&gt;\n&lt;li&gt;返回垃圾值&lt;/li&gt;\n&lt;li&gt;安全漏洞&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Rust 通过显式 panic 来避免这些不可预测的行为，让错误在第一时间暴露出来。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;浮点数例外&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;有趣的是，&lt;strong&gt;浮点数的除零操作不会 panic&lt;/strong&gt;，而是遵循 IEEE 754 标准：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ inf (正无穷)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ -inf (负无穷)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, y &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ NaN (Not a Number)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 浮点数取模也不会 panic，但会返回 NaN&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, x &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; y);      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ NaN&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;2-整数溢出的特殊边界情况\&quot;&gt;2. 整数溢出的特殊边界情况&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-整数溢出的特殊边界情况\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;还有一个更隐蔽的陷阱：&lt;strong&gt;&lt;code&gt;INT_MIN / -1&lt;/code&gt; 和 &lt;code&gt;INT_MIN % -1&lt;/code&gt; 也会 panic&lt;/strong&gt;！&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; min &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; divisor &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; -&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 这会 panic！&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let result = min / divisor;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 💥 这也会 panic！&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let remainder = min % divisor;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;为什么？&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;对于 8 位有符号整数 &lt;code&gt;i8&lt;/code&gt;：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;最小值：&lt;code&gt;i8::MIN = -128&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;最大值：&lt;code&gt;i8::MAX = 127&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;当我们计算 &lt;code&gt;-128 / -1&lt;/code&gt; 时，数学结果应该是 &lt;code&gt;128&lt;/code&gt;，但这&lt;strong&gt;超出了 &lt;code&gt;i8&lt;/code&gt; 的表示范围&lt;/strong&gt;（最大只能到 127），导致溢出。Rust 选择 panic 而不是返回错误的结果。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; demonstrate_overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 对于不同的整数类型，都存在这个问题&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i8::MIN  / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128 / -1 = 128 (溢出!)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i16::MIN / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i16&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -32768 / -1 = 32768 (溢出!)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i32::MIN / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -2147483648 / -1 = 2147483648 (溢出!)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;i64::MIN / -1 会 panic: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i64&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 同理&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;3-debug-模式下的整数溢出\&quot;&gt;3. Debug 模式下的整数溢出&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-debug-模式下的整数溢出\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;Rust 在 &lt;strong&gt;debug 模式和 release 模式下对整数溢出的处理不同&lt;/strong&gt;：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; max &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Debug 模式：💥 panic!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Release 模式：✅ 环绕到 0 (wrapping)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; result &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; max &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Result: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, result);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;行为差异：&lt;/strong&gt;&lt;/p&gt;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;模式&lt;/th&gt;&lt;th&gt;溢出行为&lt;/th&gt;&lt;th&gt;原因&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Debug&lt;/strong&gt; (&lt;code&gt;cargo build&lt;/code&gt;)&lt;/td&gt;&lt;td&gt;Panic&lt;/td&gt;&lt;td&gt;帮助开发者尽早发现 bug&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Release&lt;/strong&gt; (&lt;code&gt;cargo build --release&lt;/code&gt;)&lt;/td&gt;&lt;td&gt;二进制补码环绕&lt;/td&gt;&lt;td&gt;性能优化，避免运行时检查开销&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;\n&lt;p&gt;在 release 模式下：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; +&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;      // =&gt; 0   (255 + 1 环绕为 0)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; -&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;      // =&gt; 255 (0 - 1 环绕为 255)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; +&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;      // =&gt; -128 (127 + 1 环绕为 -128)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这意味着：&lt;strong&gt;同样的代码在不同编译模式下可能有完全不同的行为！&lt;/strong&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;rust-的解决方案显式的溢出处理\&quot;&gt;Rust 的解决方案：显式的溢出处理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#rust-的解决方案显式的溢出处理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;为了让开发者能够精确控制溢出行为，Rust 提供了多种方法变体：&lt;/p&gt;\n&lt;h3 id=\&quot;1-checked_-系列安全检查返回-option\&quot;&gt;1. &lt;code&gt;checked_*&lt;/code&gt; 系列：安全检查，返回 Option&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-checked_-系列安全检查返回-option\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; safe_division&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, b&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Some(5)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None - 零除返回 None 而不是 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None - 溢出返回 None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 其他 checked 方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));       &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;128&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_rem&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));        &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// None - 取模零也返回 None&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;用户输入处理&lt;/li&gt;\n&lt;li&gt;外部数据验证&lt;/li&gt;\n&lt;li&gt;需要优雅处理错误的场景&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;2-wrapping_-系列显式环绕行为\&quot;&gt;2. &lt;code&gt;wrapping_*&lt;/code&gt; 系列：显式环绕行为&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-wrapping_-系列显式环绕行为\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 无论 debug 还是 release 模式，都保证环绕行为&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 0&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));        &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;200&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 144 (400 % 256)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 环绕除法：零除仍然会 panic！&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // println!(\&quot;{}\&quot;, 10.wrapping_div(0));  // 💥 仍然 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 但 INT_MIN / -1 会环绕而不是 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128 (环绕到自身)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;哈希计算&lt;/li&gt;\n&lt;li&gt;密码学算法&lt;/li&gt;\n&lt;li&gt;需要明确的模运算语义&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;3-saturating_-系列饱和到边界值\&quot;&gt;3. &lt;code&gt;saturating_*&lt;/code&gt; 系列：饱和到边界值&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-saturating_-系列饱和到边界值\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 溢出时返回类型的最大/最小值&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));    &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255 (不超过最大值)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));      &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 0   (不低于最小值)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;200&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));    &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 255 (饱和到最大值)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 有符号整数&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;127&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));    &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 127&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, (&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;128&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i8&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;saturating_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// -128&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 除法仍然对零除 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // println!(\&quot;{}\&quot;, 10.saturating_div(0));  // 💥 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;音频/视频处理（音量、亮度限制）&lt;/li&gt;\n&lt;li&gt;游戏开发（生命值、伤害计算）&lt;/li&gt;\n&lt;li&gt;UI 组件（滚动位置、进度条）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;4-overflowing_-系列返回结果和溢出标志\&quot;&gt;4. &lt;code&gt;overflowing_*&lt;/code&gt; 系列：返回结果和溢出标志&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#4-overflowing_-系列返回结果和溢出标志\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (result, overflowed) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 255&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;overflowing_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Result: {}, Overflowed: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, result, overflowed);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Result: 0, Overflowed: true&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (result, overflowed) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 100&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;overflowing_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;50&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Result: {}, Overflowed: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, result, overflowed);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Result: 150, Overflowed: false&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 可以用来实现自定义的溢出处理逻辑&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (div, overflow) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i8&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;overflowing_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Division: {}, Overflow: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, div, overflow);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // Division: -128, Overflow: true&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;需要记录溢出事件&lt;/li&gt;\n&lt;li&gt;实现自定义的错误报告&lt;/li&gt;\n&lt;li&gt;性能敏感但需要溢出信息的代码&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;5-strict_-系列总是-panicrust-180\&quot;&gt;5. &lt;code&gt;strict_*&lt;/code&gt; 系列：总是 Panic（Rust 1.80+）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#5-strict_-系列总是-panicrust-180\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 无论 debug 还是 release，溢出总是 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let result = 255u8.strict_add(1);  // 💥 panic in both debug and release&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 这对于需要严格保证数学正确性的场景很有用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;适用场景：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;金融计算&lt;/li&gt;\n&lt;li&gt;科学计算&lt;/li&gt;\n&lt;li&gt;任何不能容忍静默溢出的场景&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;完整的除零安全处理示例\&quot;&gt;完整的除零安全处理示例&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#完整的除零安全处理示例\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;结合上面的知识，我们可以写一个安全的计算器函数：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;#[derive(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Debug&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;PartialEq&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;enum&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; CalcError&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    DivisionByZero&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, b&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, op&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; char&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Result&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    match&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; op {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;+&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;-&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_sub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;*&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; b &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;                Err&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;DivisionByZero&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;                a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;        &#39;%&#39;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; =&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; b &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;                Err&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;DivisionByZero&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;                a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_rem&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;CalcError&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Overflow&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        _ &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; panic!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Unsupported operation\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Ok(5)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(DivisionByZero)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;%&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));   &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(DivisionByZero)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MAX&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;+&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(Overflow)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;safe_calculator&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;/&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Err(Overflow)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;rust-vs-其他语言\&quot;&gt;Rust vs 其他语言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#rust-vs-其他语言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;让我们对比一下不同语言对除零的处理：&lt;/p&gt;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;语言&lt;/th&gt;&lt;th&gt;&lt;code&gt;10 / 0&lt;/code&gt; 行为&lt;/th&gt;&lt;th&gt;&lt;code&gt;10 % 0&lt;/code&gt; 行为&lt;/th&gt;&lt;th&gt;可捕获？&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Rust&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;Panic（程序崩溃）&lt;/td&gt;&lt;td&gt;Panic（程序崩溃）&lt;/td&gt;&lt;td&gt;❌ 不可用 try-catch 捕获&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Python&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ZeroDivisionError&lt;/code&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ZeroDivisionError&lt;/code&gt;&lt;/td&gt;&lt;td&gt;✅ 可用 try-except 捕获&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;JavaScript&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;Infinity&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;NaN&lt;/code&gt;&lt;/td&gt;&lt;td&gt;✅ 不抛出异常，返回特殊值&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Java&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ArithmeticException&lt;/code&gt;&lt;/td&gt;&lt;td&gt;抛出 &lt;code&gt;ArithmeticException&lt;/code&gt;&lt;/td&gt;&lt;td&gt;✅ 可用 try-catch 捕获&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;C/C++&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;未定义行为（UB）&lt;/td&gt;&lt;td&gt;未定义行为（UB）&lt;/td&gt;&lt;td&gt;❌ 无标准异常机制&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Go&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;Panic&lt;/td&gt;&lt;td&gt;Panic&lt;/td&gt;&lt;td&gt;⚠️ 可用 recover 捕获（不推荐）&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;\n&lt;p&gt;&lt;strong&gt;Rust 的设计权衡：&lt;/strong&gt;&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;不使用异常机制&lt;/strong&gt;：Rust 没有 try-catch 异常系统，这避免了隐藏的控制流和性能开销&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;强制显式处理&lt;/strong&gt;：通过 &lt;code&gt;checked_*&lt;/code&gt; 等方法，强制开发者在可能出错的地方显式处理&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Panic 是最后手段&lt;/strong&gt;：Panic 用于”不可恢复的错误”，而零除被认为是编程错误而非业务逻辑错误&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&quot;实战建议\&quot;&gt;实战建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实战建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;1-算法题中的处理\&quot;&gt;1. 算法题中的处理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#1-算法题中的处理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在刷算法题时，可以这样处理：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ❌ 危险：可能 panic&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; solve_naive&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, m&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    (n &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; n) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; m  &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 如果 m 为 0，直接崩溃&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 安全：添加前置检查&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; solve_safe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, m&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; m &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; None&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    Some&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;((n &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; n) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; m)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 更好：使用 checked 方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; solve_better&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, m&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Option&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(n)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;?.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_rem&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(m)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;2-生产代码的建议\&quot;&gt;2. 生产代码的建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2-生产代码的建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 对于用户输入，总是使用 checked_* 方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process_user_input&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(dividend&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, divisor&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Result&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    dividend&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(divisor)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;ok_or_else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;||&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; divisor &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;                \&quot;除数不能为零\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;                \&quot;计算溢出\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        })&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 对于性能敏感且确定不会溢出的代码，可以使用普通运算符&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; fast_index_calculation&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(base&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, offset&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, size&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; usize&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // 假设已经在外层保证了不会溢出&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    (base &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; offset) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; size&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 对于需要环绕语义的场景，明确使用 wrapping_*&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; hash_combine&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(hash1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, hash2&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; u64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    hash1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_add&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(hash2)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wrapping_mul&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0x9e3779b97f4a7c15&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;3-测试建议\&quot;&gt;3. 测试建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#3-测试建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;#[cfg(test)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;mod&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; tests&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    use&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; super&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[test]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[should_panic(expected &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;divide by zero\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; test_division_by_zero_panics&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; _ &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; /&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[test]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[should_panic(expected &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;remainder\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; test_modulo_by_zero_panics&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; _ &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 10&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; %&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    #[test]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; test_safe_division&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        assert_eq!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Some&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        assert_eq!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;10.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;None&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        assert_eq!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;MIN&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;checked_div&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;None&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;总结\&quot;&gt;总结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#总结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;关键要点\&quot;&gt;关键要点&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#关键要点\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Rust 中会导致 panic 的算术运算：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;a / 0&lt;/code&gt; 和 &lt;code&gt;a % 0&lt;/code&gt;（整数）&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;INT_MIN / -1&lt;/code&gt; 和 &lt;code&gt;INT_MIN % -1&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;Debug 模式下的整数溢出&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;浮点数例外：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;f32/f64&lt;/code&gt; 的除零不会 panic，返回 &lt;code&gt;Infinity&lt;/code&gt; 或 &lt;code&gt;NaN&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Debug vs Release 的差异：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Debug：溢出 panic，帮助调试&lt;/li&gt;\n&lt;li&gt;Release：溢出环绕，优化性能&lt;/li&gt;\n&lt;li&gt;使用 &lt;code&gt;checked_*&lt;/code&gt; 等方法可以统一行为&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Rust 的解决方案：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;checked_*&lt;/code&gt;：安全检查，返回 &lt;code&gt;Option&amp;#x3C;T&gt;&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;wrapping_*&lt;/code&gt;：显式环绕&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;saturating_*&lt;/code&gt;：饱和到边界&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;overflowing_*&lt;/code&gt;：返回结果和溢出标志&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;strict_*&lt;/code&gt;：总是 panic（Rust 1.80+）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;设计哲学：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;避免未定义行为&lt;/li&gt;\n&lt;li&gt;强制显式处理&lt;/li&gt;\n&lt;li&gt;Panic 用于不可恢复的编程错误&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;实践建议\&quot;&gt;实践建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实践建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;✅ &lt;strong&gt;用户输入和外部数据&lt;/strong&gt;：总是使用 &lt;code&gt;checked_*&lt;/code&gt; 方法&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;算法题&lt;/strong&gt;：添加边界检查或使用 &lt;code&gt;checked_*&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;性能关键路径&lt;/strong&gt;：如果确定安全，可以用普通运算符，但要有充分的注释说明&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;需要环绕语义&lt;/strong&gt;：明确使用 &lt;code&gt;wrapping_*&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;✅ &lt;strong&gt;测试&lt;/strong&gt;：为边界情况编写测试，包括 panic 测试&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;延伸阅读\&quot;&gt;延伸阅读&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#延伸阅读\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;https://rust-lang.github.io/rfcs/0560-integer-overflow.html\&quot;&gt;Rust RFC 560 - Integer Overflow&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/\&quot;&gt;Myths and Legends about Integer Overflow in Rust&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/std/ops/trait.Div.html\&quot;&gt;Rust Documentation - Div trait&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/reference/behavior-not-considered-unsafe.html\&quot;&gt;Behavior not considered unsafe - Rust Reference&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/\&quot;&gt;Exploring Rust’s Overflow Behavior - Sling Academy&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;最后提醒：&lt;/strong&gt; 这些行为不是 bug，而是 Rust 为了安全性做出的有意设计。理解这些特性，才能写出既安全又高效的 Rust 代码。下次刷算法题时，记得留意除法和取模操作，不要让你的解答因为一个 &lt;code&gt;% 0&lt;/code&gt; 而崩溃！&lt;/p&gt;\n&lt;p&gt;写到这里，我想起了前一个月的 cloudflare的unwarp 造成的panic!。真的很好笑。&lt;/p&gt;\n&lt;p&gt;一定要注意rust一切可能引起panic!的可能性，才不会像cloudflare的unwarp方法一样，搞出的几十亿美金的全球网站崩溃漏洞。&lt;/p&gt;\n&lt;p&gt;Sources:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;https://rust-lang.github.io/rfcs/0560-integer-overflow.html\&quot;&gt;Rust RFC 560 - Integer Overflow&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/\&quot;&gt;Myths and Legends about Integer Overflow in Rust&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://stackoverflow.com/questions/68807024/what-happens-in-rust-programming-language-when-an-integer-arithmetic-operation-o\&quot;&gt;What happens in Rust programming language when an integer arithmetic operation overflows? - Stack Overflow&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://www.slingacademy.com/article/exploring-rusts-overflow-behavior-wrapping-saturating-and-panicking/\&quot;&gt;Exploring Rust’s Overflow Behavior: Wrapping, Saturating, and Panicking - Sling Academy&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/std/ops/trait.Div.html\&quot;&gt;Div in std::ops - Rust&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;rust-中会导致-panic-的算术运算&quot;],&quot;text&quot;:[0,&quot;Rust 中会导致 Panic 的算术运算&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-除法和取模运算的零除错误&quot;],&quot;text&quot;:[0,&quot;1. 除法和取模运算的零除错误&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-整数溢出的特殊边界情况&quot;],&quot;text&quot;:[0,&quot;2. 整数溢出的特殊边界情况&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-debug-模式下的整数溢出&quot;],&quot;text&quot;:[0,&quot;3. Debug 模式下的整数溢出&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;rust-的解决方案显式的溢出处理&quot;],&quot;text&quot;:[0,&quot;Rust 的解决方案：显式的溢出处理&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-checked_-系列安全检查返回-option&quot;],&quot;text&quot;:[0,&quot;1. checked_* 系列：安全检查，返回 Option&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-wrapping_-系列显式环绕行为&quot;],&quot;text&quot;:[0,&quot;2. wrapping_* 系列：显式环绕行为&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-saturating_-系列饱和到边界值&quot;],&quot;text&quot;:[0,&quot;3. saturating_* 系列：饱和到边界值&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;4-overflowing_-系列返回结果和溢出标志&quot;],&quot;text&quot;:[0,&quot;4. overflowing_* 系列：返回结果和溢出标志&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;5-strict_-系列总是-panicrust-180&quot;],&quot;text&quot;:[0,&quot;5. strict_* 系列：总是 Panic（Rust 1.80+）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;完整的除零安全处理示例&quot;],&quot;text&quot;:[0,&quot;完整的除零安全处理示例&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;rust-vs-其他语言&quot;],&quot;text&quot;:[0,&quot;Rust vs 其他语言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;实战建议&quot;],&quot;text&quot;:[0,&quot;实战建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;1-算法题中的处理&quot;],&quot;text&quot;:[0,&quot;1. 算法题中的处理&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;2-生产代码的建议&quot;],&quot;text&quot;:[0,&quot;2. 生产代码的建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;3-测试建议&quot;],&quot;text&quot;:[0,&quot;3. 测试建议&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;总结&quot;],&quot;text&quot;:[0,&quot;总结&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;关键要点&quot;],&quot;text&quot;:[0,&quot;关键要点&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;实践建议&quot;],&quot;text&quot;:[0,&quot;实践建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;延伸阅读&quot;],&quot;text&quot;:[0,&quot;延伸阅读&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Rust 算术运算的 Panic 陷阱：从取模零说起&quot;],&quot;date&quot;:[3,&quot;2025-12-02T10:00:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;算法&quot;],[0,&quot;安全&quot;],[0,&quot;Panic&quot;],[0,&quot;算术运算&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;],&quot;description&quot;:[0,&quot;在刷 Rust 算法题时发现了一个独特现象：对零取模会直接导致程序 panic！这与其他语言的行为截然不同。本文深入探讨 Rust 中会导致 panic 的算术运算场景，包括除零、整数溢出、INT_MIN/-1 等特殊情况，以及 Rust 提供的 checked_、wrapping_、saturating_ 等安全替代方案。理解这些行为对于编写健壮的 Rust 程序至关重要。&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/20&quot;]}],&quot;nextPost&quot;:[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;rust-trait-为泛型类型的具体实例实现特征&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Rust Trait：为泛型类型的具体实例实现特征&quot;],&quot;description&quot;:[0,&quot;深入理解 Rust 中 trait 实现的灵活性：为什么可以为 Vec&lt;String&gt; 这样的泛型类型具体实例实现 trait？探讨 Rust 类型系统中的类型特化（Type Specialization）、trait 实现的作用范围，以及如何利用这一特性编写更灵活的代码。&quot;],&quot;date&quot;:[3,&quot;2025-11-25T10:30:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;Trait&quot;],[0,&quot;泛型&quot;],[0,&quot;类型系统&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;]}],&quot;body&quot;:[0,&quot;## 前言\n\n在学习 Rust 的 trait 系统时，我遇到了一个有趣的问题：**为什么可以为 `Vec&lt;String&gt;` 这样的泛型类型的具体实例实现 trait？** 这似乎与我们通常理解的\&quot;只能为结构体实现 trait\&quot;的观念不太一致。本文将深入探讨这个问题，帮助你更好地理解 Rust 的类型系统。\n\n## 问题的由来\n\n假设我们定义了一个简单的 trait：\n\n```rust\ntrait AppendBar {\n    fn append_bar(&amp;mut self);\n}\n```\n\n然后，我们可以这样为 `Vec&lt;String&gt;` 实现这个 trait：\n\n```rust\nimpl AppendBar for Vec&lt;String&gt; {\n    fn append_bar(&amp;mut self) {\n        self.push(String::from(\&quot;Bar\&quot;));\n    }\n}\n```\n\n这段代码完全合法且能正常工作：\n\n```rust\nfn main() {\n    let mut my_vec: Vec&lt;String&gt; = vec![\n        String::from(\&quot;Foo\&quot;),\n        String::from(\&quot;Baz\&quot;),\n    ];\n\n    my_vec.append_bar();\n\n    println!(\&quot;{:?}\&quot;, my_vec); // 输出: [\&quot;Foo\&quot;, \&quot;Baz\&quot;, \&quot;Bar\&quot;]\n}\n```\n\n但问题来了：**`Vec&lt;String&gt;` 不是一个结构体，而是泛型类型 `Vec&lt;T&gt;` 的一个具体实例，为什么可以为它实现 trait？**\n\n## 核心概念：类型特化（Type Specialization）\n\n### 什么是类型特化？\n\n在 Rust 中，`Vec&lt;T&gt;` 是一个**泛型类型**，其中 `T` 是类型参数。当我们指定 `T = String` 时，`Vec&lt;String&gt;` 就成为了一个**具体类型**（Concrete Type），这个过程被称为**类型特化**。\n\n从 Rust 编译器的角度来看：\n\n- `Vec&lt;T&gt;` 是一个**类型构造器**（Type Constructor），需要一个类型参数才能成为完整的类型\n- `Vec&lt;String&gt;` 是一个**完整的具体类型**，和 `i32`、`String` 等具有同等地位\n\n### 类型特化的实例\n\n```rust\n// 这些都是不同的具体类型\nlet v1: Vec&lt;i32&gt; = vec![1, 2, 3];\nlet v2: Vec&lt;String&gt; = vec![\&quot;hello\&quot;.to_string()];\nlet v3: Vec&lt;Vec&lt;u8&gt;&gt; = vec![vec![1, 2], vec![3, 4]];\n```\n\n在 Rust 的类型系统中，`Vec&lt;i32&gt;`、`Vec&lt;String&gt;` 和 `Vec&lt;Vec&lt;u8&gt;&gt;` 是**三个完全不同的类型**，就像 `Dog` 和 `Cat` 是两个不同的结构体一样。\n\n## Trait 实现的灵活性\n\nRust 的 trait 系统允许你为**任何具体类型**实现 trait，不仅仅是结构体。这包括：\n\n1. **自定义结构体**\n2. **枚举类型**\n3. **泛型类型的具体实例**（如 `Vec&lt;String&gt;`）\n4. **基本类型**（如 `i32`，但需要遵循孤儿规则）\n5. **元组类型**（如 `(i32, String)`）\n\n### 示例 1：为不同的 Vec 实例实现不同的 trait\n\n```rust\ntrait AppendBar {\n    fn append_bar(&amp;mut self);\n}\n\ntrait AppendBaz {\n    fn append_baz(&amp;mut self);\n}\n\n// 为 Vec&lt;String&gt; 实现 AppendBar\nimpl AppendBar for Vec&lt;String&gt; {\n    fn append_bar(&amp;mut self) {\n        self.push(String::from(\&quot;Bar\&quot;));\n    }\n}\n\n// 为 Vec&lt;i32&gt; 实现 AppendBaz\nimpl AppendBaz for Vec&lt;i32&gt; {\n    fn append_baz(&amp;mut self) {\n        self.push(42);\n    }\n}\n\nfn main() {\n    let mut strings = vec![String::from(\&quot;Foo\&quot;)];\n    strings.append_bar(); // ✅ 可以调用\n    // strings.append_baz(); // ❌ 编译错误：Vec&lt;String&gt; 没有实现 AppendBaz\n\n    let mut numbers = vec![1, 2, 3];\n    numbers.append_baz(); // ✅ 可以调用\n    // numbers.append_bar(); // ❌ 编译错误：Vec&lt;i32&gt; 没有实现 AppendBar\n}\n```\n\n### 示例 2：为元组类型实现 trait\n\n```rust\ntrait Describable {\n    fn describe(&amp;self) -&gt; String;\n}\n\n// 为 (i32, String) 元组实现 trait\nimpl Describable for (i32, String) {\n    fn describe(&amp;self) -&gt; String {\n        format!(\&quot;Number: {}, Text: {}\&quot;, self.0, self.1)\n    }\n}\n\nfn main() {\n    let tuple = (42, String::from(\&quot;Hello\&quot;));\n    println!(\&quot;{}\&quot;, tuple.describe()); // 输出: Number: 42, Text: Hello\n}\n```\n\n## 泛型实现 vs 具体实现\n\nRust 允许你选择不同的实现策略：\n\n### 策略 1：为所有 `Vec&lt;T&gt;` 实现（泛型实现）\n\n```rust\ntrait Printable {\n    fn print_all(&amp;self);\n}\n\n// 为所有 Vec&lt;T&gt; 实现，其中 T 必须实现 Debug trait\nimpl&lt;T: std::fmt::Debug&gt; Printable for Vec&lt;T&gt; {\n    fn print_all(&amp;self) {\n        for item in self {\n            println!(\&quot;{:?}\&quot;, item);\n        }\n    }\n}\n\nfn main() {\n    let strings = vec![String::from(\&quot;Foo\&quot;), String::from(\&quot;Bar\&quot;)];\n    strings.print_all(); // ✅ 可以使用\n\n    let numbers = vec![1, 2, 3];\n    numbers.print_all(); // ✅ 也可以使用\n}\n```\n\n**特点：**\n- 为所有满足约束的 `Vec&lt;T&gt;` 实现 trait\n- trait 方法必须对所有可能的 `T` 都有效\n- 实现代码只写一次，适用于多种类型\n\n### 策略 2：为特定的 `Vec&lt;T&gt;` 实现（具体实现）\n\n```rust\ntrait StringOperations {\n    fn to_uppercase_all(&amp;mut self);\n    fn concat_all(&amp;self) -&gt; String;\n}\n\n// 仅为 Vec&lt;String&gt; 实现\nimpl StringOperations for Vec&lt;String&gt; {\n    fn to_uppercase_all(&amp;mut self) {\n        for s in self.iter_mut() {\n            *s = s.to_uppercase();\n        }\n    }\n\n    fn concat_all(&amp;self) -&gt; String {\n        self.join(\&quot;, \&quot;)\n    }\n}\n\nfn main() {\n    let mut strings = vec![String::from(\&quot;hello\&quot;), String::from(\&quot;world\&quot;)];\n    strings.to_uppercase_all();\n    println!(\&quot;{}\&quot;, strings.concat_all()); // 输出: HELLO, WORLD\n\n    // let mut numbers = vec![1, 2, 3];\n    // numbers.to_uppercase_all(); // ❌ 编译错误：Vec&lt;i32&gt; 没有实现 StringOperations\n}\n```\n\n**特点：**\n- 只为特定的 `Vec&lt;String&gt;` 实现\n- 可以使用 `String` 特有的方法（如 `to_uppercase()`）\n- 实现更有针对性，类型更安全\n\n## 实际应用场景\n\n### 场景 1：为标准库类型添加自定义功能\n\n```rust\ntrait Statistics {\n    fn mean(&amp;self) -&gt; f64;\n    fn median(&amp;self) -&gt; f64;\n}\n\nimpl Statistics for Vec&lt;f64&gt; {\n    fn mean(&amp;self) -&gt; f64 {\n        if self.is_empty() {\n            return 0.0;\n        }\n        self.iter().sum::&lt;f64&gt;() / self.len() as f64\n    }\n\n    fn median(&amp;self) -&gt; f64 {\n        if self.is_empty() {\n            return 0.0;\n        }\n        let mut sorted = self.clone();\n        sorted.sort_by(|a, b| a.partial_cmp(b).unwrap());\n        let mid = sorted.len() / 2;\n        if sorted.len() % 2 == 0 {\n            (sorted[mid - 1] + sorted[mid]) / 2.0\n        } else {\n            sorted[mid]\n        }\n    }\n}\n\nfn main() {\n    let data = vec![1.0, 2.0, 3.0, 4.0, 5.0];\n    println!(\&quot;Mean: {}\&quot;, data.mean());     // 输出: Mean: 3\n    println!(\&quot;Median: {}\&quot;, data.median()); // 输出: Median: 3\n}\n```\n\n### 场景 2：实现特定领域的类型约束\n\n```rust\ntrait JsonSerializable {\n    fn to_json(&amp;self) -&gt; String;\n}\n\n// 为字符串数组实现 JSON 序列化\nimpl JsonSerializable for Vec&lt;String&gt; {\n    fn to_json(&amp;self) -&gt; String {\n        let items: Vec&lt;String&gt; = self\n            .iter()\n            .map(|s| format!(\&quot;\\\&quot;{}\\\&quot;\&quot;, s))\n            .collect();\n        format!(\&quot;[{}]\&quot;, items.join(\&quot;, \&quot;))\n    }\n}\n\n// 为数字数组实现 JSON 序列化\nimpl JsonSerializable for Vec&lt;i32&gt; {\n    fn to_json(&amp;self) -&gt; String {\n        let items: Vec&lt;String&gt; = self\n            .iter()\n            .map(|n| n.to_string())\n            .collect();\n        format!(\&quot;[{}]\&quot;, items.join(\&quot;, \&quot;))\n    }\n}\n\nfn main() {\n    let strings = vec![String::from(\&quot;hello\&quot;), String::from(\&quot;world\&quot;)];\n    println!(\&quot;{}\&quot;, strings.to_json()); // 输出: [\&quot;hello\&quot;, \&quot;world\&quot;]\n\n    let numbers = vec![1, 2, 3];\n    println!(\&quot;{}\&quot;, numbers.to_json()); // 输出: [1, 2, 3]\n}\n```\n\n## 孤儿规则（Orphan Rule）\n\n虽然可以为泛型类型的具体实例实现 trait，但必须遵守 Rust 的**孤儿规则**：\n\n&gt; **至少 trait 或类型其中之一必须在当前 crate 中定义。**\n\n### 合法的实现\n\n```rust\n// ✅ 情况 1：trait 在本 crate 中定义\ntrait MyTrait {\n    fn do_something(&amp;self);\n}\n\n// Vec 虽然是标准库的，但 MyTrait 是我们定义的\nimpl MyTrait for Vec&lt;String&gt; {\n    fn do_something(&amp;self) {\n        println!(\&quot;Doing something with {} strings\&quot;, self.len());\n    }\n}\n\n// ✅ 情况 2：类型在本 crate 中定义\nstruct MyType {\n    data: Vec&lt;i32&gt;,\n}\n\n// Display 虽然是标准库的，但 MyType 是我们定义的\nimpl std::fmt::Display for MyType {\n    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#39;_&gt;) -&gt; std::fmt::Result {\n        write!(f, \&quot;MyType with {} elements\&quot;, self.data.len())\n    }\n}\n```\n\n### 非法的实现\n\n```rust\n// ❌ 错误：trait 和类型都不在本 crate 中\n// impl std::fmt::Display for Vec&lt;String&gt; {\n//     fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#39;_&gt;) -&gt; std::fmt::Result {\n//         write!(f, \&quot;Custom Vec Display\&quot;)\n//     }\n// }\n// 编译错误：只有在本地 crate 定义的 trait 才能为外部类型实现\n```\n\n## 特化（Specialization）的未来\n\nRust 正在开发一个更强大的特性：**trait 特化（Trait Specialization）**，它允许你先为泛型类型实现 trait，然后为特定实例提供更优化的实现。\n\n```rust\n#![feature(specialization)] // 需要 nightly Rust\n\ntrait Process {\n    fn process(&amp;self);\n}\n\n// 默认实现：适用于所有 Vec&lt;T&gt;\nimpl&lt;T&gt; Process for Vec&lt;T&gt; {\n    default fn process(&amp;self) {\n        println!(\&quot;Processing {} items (generic)\&quot;, self.len());\n    }\n}\n\n// 特化实现：针对 Vec&lt;String&gt; 的优化版本\nimpl Process for Vec&lt;String&gt; {\n    fn process(&amp;self) {\n        println!(\&quot;Processing {} strings (specialized)\&quot;, self.len());\n        for s in self {\n            println!(\&quot;  - {}\&quot;, s);\n        }\n    }\n}\n```\n\n注意：这个特性目前还在实验阶段，仅在 nightly Rust 中可用。\n\n## 总结\n\n### 关键要点\n\n1. **`Vec&lt;String&gt;` 是一个完整的具体类型**，不是泛型类型\n   - `Vec&lt;T&gt;` 是泛型类型（类型构造器）\n   - `Vec&lt;String&gt;` 是具体类型（`T` 被特化为 `String`）\n\n2. **Rust 允许为任何具体类型实现 trait**\n   - 结构体、枚举\n   - 泛型类型的具体实例（如 `Vec&lt;String&gt;`）\n   - 基本类型、元组等\n\n3. **实现策略的选择**\n   - **泛型实现**：`impl&lt;T&gt; Trait for Vec&lt;T&gt;` - 适用于所有 `T`\n   - **具体实现**：`impl Trait for Vec&lt;String&gt;` - 只适用于特定类型\n\n4. **孤儿规则必须遵守**\n   - trait 或类型至少有一个在本 crate 中定义\n   - 防止不同 crate 之间的实现冲突\n\n5. **类型安全的保证**\n   - 为 `Vec&lt;String&gt;` 实现的 trait 不会影响 `Vec&lt;i32&gt;`\n   - 每个具体类型都是独立的，编译器会严格检查\n\n### 实践建议\n\n- **优先使用泛型实现**：如果 trait 方法适用于所有 `T`，使用 `impl&lt;T&gt; Trait for Vec&lt;T&gt;`\n- **针对性优化时使用具体实现**：当需要使用特定类型的方法时，为具体类型实现 trait\n- **遵守孤儿规则**：确保 trait 或类型至少有一个在本 crate 中定义\n- **类型约束清晰**：使用具体实现可以获得更好的类型安全和代码可读性\n\n### 延伸阅读\n\n- [The Rust Programming Language - Traits](https://doc.rust-lang.org/book/ch10-02-traits.html)\n- [Rust Reference - Trait Implementation](https://doc.rust-lang.org/reference/items/implementations.html)\n- [RFC 1210 - Specialization](https://rust-lang.github.io/rfcs/1210-impl-specialization.html)\n\n希望这篇文章能帮助你更好地理解 Rust 的 trait 系统。记住：**类型特化让 Rust 的类型系统既灵活又安全**，善用这一特性可以写出更优雅的代码！\n\n---\n\n**最后提醒：** 这篇笔记记录了一个初学时容易混淆的概念。如果你也在学习 Rust，建议动手实践这些示例代码，加深理解。类型系统是 Rust 最强大的特性之一，值得深入学习！&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Rust-Trait-为泛型类型的具体实例实现特征.md&quot;],&quot;digest&quot;:[0,&quot;cf3e3092d3e4c992&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h2 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;在学习 Rust 的 trait 系统时，我遇到了一个有趣的问题：&lt;strong&gt;为什么可以为 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 这样的泛型类型的具体实例实现 trait？&lt;/strong&gt; 这似乎与我们通常理解的”只能为结构体实现 trait”的观念不太一致。本文将深入探讨这个问题，帮助你更好地理解 Rust 的类型系统。&lt;/p&gt;\n&lt;h2 id=\&quot;问题的由来\&quot;&gt;问题的由来&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#问题的由来\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;假设我们定义了一个简单的 trait：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;然后，我们可以这样为 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 实现这个 trait：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;push&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Bar\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这段代码完全合法且能正常工作：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; my_vec&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Foo\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Baz\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;),&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    ];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    my_vec&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, my_vec); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: [\&quot;Foo\&quot;, \&quot;Baz\&quot;, \&quot;Bar\&quot;]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;但问题来了：&lt;strong&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 不是一个结构体，而是泛型类型 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 的一个具体实例，为什么可以为它实现 trait？&lt;/strong&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;核心概念类型特化type-specialization\&quot;&gt;核心概念：类型特化（Type Specialization）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#核心概念类型特化type-specialization\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;什么是类型特化\&quot;&gt;什么是类型特化？&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#什么是类型特化\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在 Rust 中，&lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 是一个&lt;strong&gt;泛型类型&lt;/strong&gt;，其中 &lt;code&gt;T&lt;/code&gt; 是类型参数。当我们指定 &lt;code&gt;T = String&lt;/code&gt; 时，&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 就成为了一个&lt;strong&gt;具体类型&lt;/strong&gt;（Concrete Type），这个过程被称为&lt;strong&gt;类型特化&lt;/strong&gt;。&lt;/p&gt;\n&lt;p&gt;从 Rust 编译器的角度来看：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 是一个&lt;strong&gt;类型构造器&lt;/strong&gt;（Type Constructor），需要一个类型参数才能成为完整的类型&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 是一个&lt;strong&gt;完整的具体类型&lt;/strong&gt;，和 &lt;code&gt;i32&lt;/code&gt;、&lt;code&gt;String&lt;/code&gt; 等具有同等地位&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;类型特化的实例\&quot;&gt;类型特化的实例&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#类型特化的实例\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 这些都是不同的具体类型&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; v1&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; v2&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; v3&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;u8&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;], &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;4&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;]];&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;在 Rust 的类型系统中，&lt;code&gt;Vec&amp;#x3C;i32&gt;&lt;/code&gt;、&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 和 &lt;code&gt;Vec&amp;#x3C;Vec&amp;#x3C;u8&gt;&gt;&lt;/code&gt; 是&lt;strong&gt;三个完全不同的类型&lt;/strong&gt;，就像 &lt;code&gt;Dog&lt;/code&gt; 和 &lt;code&gt;Cat&lt;/code&gt; 是两个不同的结构体一样。&lt;/p&gt;\n&lt;h2 id=\&quot;trait-实现的灵活性\&quot;&gt;Trait 实现的灵活性&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#trait-实现的灵活性\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 的 trait 系统允许你为&lt;strong&gt;任何具体类型&lt;/strong&gt;实现 trait，不仅仅是结构体。这包括：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;strong&gt;自定义结构体&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;枚举类型&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;泛型类型的具体实例&lt;/strong&gt;（如 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt;）&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;基本类型&lt;/strong&gt;（如 &lt;code&gt;i32&lt;/code&gt;，但需要遵循孤儿规则）&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;元组类型&lt;/strong&gt;（如 &lt;code&gt;(i32, String)&lt;/code&gt;）&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;示例-1为不同的-vec-实例实现不同的-trait\&quot;&gt;示例 1：为不同的 Vec 实例实现不同的 trait&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#示例-1为不同的-vec-实例实现不同的-trait\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBaz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_baz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为 Vec&amp;#x3C;String&gt; 实现 AppendBar&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBar&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;push&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Bar\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为 Vec&amp;#x3C;i32&gt; 实现 AppendBaz&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; AppendBaz&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; append_baz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;push&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;42&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Foo\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;append_bar&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 可以调用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // strings.append_baz(); // ❌ 编译错误：Vec&amp;#x3C;String&gt; 没有实现 AppendBaz&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    numbers&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;append_baz&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 可以调用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // numbers.append_bar(); // ❌ 编译错误：Vec&amp;#x3C;i32&gt; 没有实现 AppendBar&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;示例-2为元组类型实现-trait\&quot;&gt;示例 2：为元组类型实现 trait&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#示例-2为元组类型实现-trait\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Describable&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; describe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为 (i32, String) 元组实现 trait&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Describable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; describe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Number: {}, Text: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; tuple &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; (&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;42&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, tuple&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;describe&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: Number: 42, Text: Hello&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;泛型实现-vs-具体实现\&quot;&gt;泛型实现 vs 具体实现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#泛型实现-vs-具体实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 允许你选择不同的实现策略：&lt;/p&gt;\n&lt;h3 id=\&quot;策略-1为所有-vect-实现泛型实现\&quot;&gt;策略 1：为所有 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 实现（泛型实现）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#策略-1为所有-vect-实现泛型实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Printable&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为所有 Vec&amp;#x3C;T&gt; 实现，其中 T 必须实现 Debug trait&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Debug&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Printable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; item &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;            println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{:?}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, item);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Foo\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Bar\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 可以使用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    numbers&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;print_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 也可以使用&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;特点：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;为所有满足约束的 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 实现 trait&lt;/li&gt;\n&lt;li&gt;trait 方法必须对所有可能的 &lt;code&gt;T&lt;/code&gt; 都有效&lt;/li&gt;\n&lt;li&gt;实现代码只写一次，适用于多种类型&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;策略-2为特定的-vect-实现具体实现\&quot;&gt;策略 2：为特定的 &lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 实现（具体实现）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#策略-2为特定的-vect-实现具体实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; StringOperations&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_uppercase_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; concat_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 仅为 Vec&amp;#x3C;String&gt; 实现&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; StringOperations&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_uppercase_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter_mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            *&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_uppercase&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; concat_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;join&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;, \&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;world\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_uppercase_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;concat_all&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: HELLO, WORLD&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // let mut numbers = vec![1, 2, 3];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;    // numbers.to_uppercase_all(); // ❌ 编译错误：Vec&amp;#x3C;i32&gt; 没有实现 StringOperations&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;特点：&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;只为特定的 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 实现&lt;/li&gt;\n&lt;li&gt;可以使用 &lt;code&gt;String&lt;/code&gt; 特有的方法（如 &lt;code&gt;to_uppercase()&lt;/code&gt;）&lt;/li&gt;\n&lt;li&gt;实现更有针对性，类型更安全&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;实际应用场景\&quot;&gt;实际应用场景&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实际应用场景\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;场景-1为标准库类型添加自定义功能\&quot;&gt;场景 1：为标准库类型添加自定义功能&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-1为标准库类型添加自定义功能\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Statistics&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; mean&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; median&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Statistics&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; mean&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        if&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;is_empty&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            return&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;        self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;sum&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;as&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; median&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; f64&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        if&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;is_empty&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            return&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; mut&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;clone&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        sorted&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;sort_by&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;a, b&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; a&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;partial_cmp&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(b)&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;unwrap&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; mid &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        if&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;%&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 2&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; ==&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            (sorted[mid &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;] &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;+&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; sorted[mid]) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;/&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 2.0&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        } &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;else&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            sorted[mid]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; data &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;4.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;5.0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Mean: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;mean&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());     &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: Mean: 3&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Median: {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;median&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: Median: 3&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;场景-2实现特定领域的类型约束\&quot;&gt;场景 2：实现特定领域的类型约束&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#场景-2实现特定领域的类型约束\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; JsonSerializable&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为字符串数组实现 JSON 序列化&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; JsonSerializable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;map&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;s&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;\\\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;{}&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;\\\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, s))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;collect&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;[{}]\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;join&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;, \&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 为数字数组实现 JSON 序列化&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; JsonSerializable&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;iter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;map&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;|&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; n&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_string&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;            .&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;collect&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        format!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;[{}]\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, items&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;join&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;, \&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;))&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;() {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; strings &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;hello\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;), &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;from&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;world\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;)];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, strings&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: [\&quot;hello\&quot;, \&quot;world\&quot;]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    let&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; numbers &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; vec!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;1&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;2&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;3&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;];&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;    println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;{}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, numbers&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;to_json&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;()); &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 输出: [1, 2, 3]&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;孤儿规则orphan-rule\&quot;&gt;孤儿规则（Orphan Rule）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#孤儿规则orphan-rule\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;虽然可以为泛型类型的具体实例实现 trait，但必须遵守 Rust 的&lt;strong&gt;孤儿规则&lt;/strong&gt;：&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;&lt;strong&gt;至少 trait 或类型其中之一必须在当前 crate 中定义。&lt;/strong&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h3 id=\&quot;合法的实现\&quot;&gt;合法的实现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#合法的实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 情况 1：trait 在本 crate 中定义&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyTrait&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; do_something&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Vec 虽然是标准库的，但 MyTrait 是我们定义的&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyTrait&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; do_something&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Doing something with {} strings\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ✅ 情况 2：类型在本 crate 中定义&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;struct&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyType&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;i32&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;,&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// Display 虽然是标准库的，但 MyType 是我们定义的&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Display&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; MyType&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; fmt&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, f&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;:&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; &amp;#x26;mut&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Formatter&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;_&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;-&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; std&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;fmt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;::&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Result&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        write!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(f, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;MyType with {} elements\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;data&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;非法的实现\&quot;&gt;非法的实现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#非法的实现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// ❌ 错误：trait 和类型都不在本 crate 中&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// impl std::fmt::Display for Vec&amp;#x3C;String&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;//     fn fmt(&amp;#x26;self, f: &amp;#x26;mut std::fmt::Formatter&amp;#x3C;&#39;_&gt;) -&gt; std::fmt::Result {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;//         write!(f, \&quot;Custom Vec Display\&quot;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;//     }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 编译错误：只有在本地 crate 定义的 trait 才能为外部类型实现&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;特化specialization的未来\&quot;&gt;特化（Specialization）的未来&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#特化specialization的未来\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Rust 正在开发一个更强大的特性：&lt;strong&gt;trait 特化（Trait Specialization）&lt;/strong&gt;，它允许你先为泛型类型实现 trait，然后为特定实例提供更优化的实现。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;rust\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;#![feature(specialization)] &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 需要 nightly Rust&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;trait&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 默认实现：适用于所有 Vec&amp;#x3C;T&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;Process&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;T&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    default &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Processing {} items (generic)\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;// 特化实现：针对 Vec&amp;#x3C;String&gt; 的优化版本&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;impl&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Process&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; for&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Vec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&amp;#x3C;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    fn&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; process&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x26;&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;        println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;Processing {} strings (specialized)\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;self&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;len&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;());&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        for&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; s &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;in&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; self&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;            println!&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;  - {}\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, s);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;注意：这个特性目前还在实验阶段，仅在 nightly Rust 中可用。&lt;/p&gt;\n&lt;h2 id=\&quot;总结\&quot;&gt;总结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#总结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;关键要点\&quot;&gt;关键要点&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#关键要点\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 是一个完整的具体类型&lt;/strong&gt;，不是泛型类型&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;T&gt;&lt;/code&gt; 是泛型类型（类型构造器）&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 是具体类型（&lt;code&gt;T&lt;/code&gt; 被特化为 &lt;code&gt;String&lt;/code&gt;）&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;Rust 允许为任何具体类型实现 trait&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;结构体、枚举&lt;/li&gt;\n&lt;li&gt;泛型类型的具体实例（如 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt;）&lt;/li&gt;\n&lt;li&gt;基本类型、元组等&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;实现策略的选择&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;泛型实现&lt;/strong&gt;：&lt;code&gt;impl&amp;#x3C;T&gt; Trait for Vec&amp;#x3C;T&gt;&lt;/code&gt; - 适用于所有 &lt;code&gt;T&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;具体实现&lt;/strong&gt;：&lt;code&gt;impl Trait for Vec&amp;#x3C;String&gt;&lt;/code&gt; - 只适用于特定类型&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;孤儿规则必须遵守&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;trait 或类型至少有一个在本 crate 中定义&lt;/li&gt;\n&lt;li&gt;防止不同 crate 之间的实现冲突&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;&lt;strong&gt;类型安全的保证&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;为 &lt;code&gt;Vec&amp;#x3C;String&gt;&lt;/code&gt; 实现的 trait 不会影响 &lt;code&gt;Vec&amp;#x3C;i32&gt;&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;每个具体类型都是独立的，编译器会严格检查&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 id=\&quot;实践建议\&quot;&gt;实践建议&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#实践建议\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;strong&gt;优先使用泛型实现&lt;/strong&gt;：如果 trait 方法适用于所有 &lt;code&gt;T&lt;/code&gt;，使用 &lt;code&gt;impl&amp;#x3C;T&gt; Trait for Vec&amp;#x3C;T&gt;&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;针对性优化时使用具体实现&lt;/strong&gt;：当需要使用特定类型的方法时，为具体类型实现 trait&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;遵守孤儿规则&lt;/strong&gt;：确保 trait 或类型至少有一个在本 crate 中定义&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;类型约束清晰&lt;/strong&gt;：使用具体实现可以获得更好的类型安全和代码可读性&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;延伸阅读\&quot;&gt;延伸阅读&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#延伸阅读\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/book/ch10-02-traits.html\&quot;&gt;The Rust Programming Language - Traits&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://doc.rust-lang.org/reference/items/implementations.html\&quot;&gt;Rust Reference - Trait Implementation&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;https://rust-lang.github.io/rfcs/1210-impl-specialization.html\&quot;&gt;RFC 1210 - Specialization&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;希望这篇文章能帮助你更好地理解 Rust 的 trait 系统。记住：&lt;strong&gt;类型特化让 Rust 的类型系统既灵活又安全&lt;/strong&gt;，善用这一特性可以写出更优雅的代码！&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;strong&gt;最后提醒：&lt;/strong&gt; 这篇笔记记录了一个初学时容易混淆的概念。如果你也在学习 Rust，建议动手实践这些示例代码，加深理解。类型系统是 Rust 最强大的特性之一，值得深入学习！&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;问题的由来&quot;],&quot;text&quot;:[0,&quot;问题的由来&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;核心概念类型特化type-specialization&quot;],&quot;text&quot;:[0,&quot;核心概念：类型特化（Type Specialization）&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;什么是类型特化&quot;],&quot;text&quot;:[0,&quot;什么是类型特化？&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;类型特化的实例&quot;],&quot;text&quot;:[0,&quot;类型特化的实例&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;trait-实现的灵活性&quot;],&quot;text&quot;:[0,&quot;Trait 实现的灵活性&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;示例-1为不同的-vec-实例实现不同的-trait&quot;],&quot;text&quot;:[0,&quot;示例 1：为不同的 Vec 实例实现不同的 trait&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;示例-2为元组类型实现-trait&quot;],&quot;text&quot;:[0,&quot;示例 2：为元组类型实现 trait&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;泛型实现-vs-具体实现&quot;],&quot;text&quot;:[0,&quot;泛型实现 vs 具体实现&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;策略-1为所有-vect-实现泛型实现&quot;],&quot;text&quot;:[0,&quot;策略 1：为所有 Vec&lt;T&gt; 实现（泛型实现）&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;策略-2为特定的-vect-实现具体实现&quot;],&quot;text&quot;:[0,&quot;策略 2：为特定的 Vec&lt;T&gt; 实现（具体实现）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;实际应用场景&quot;],&quot;text&quot;:[0,&quot;实际应用场景&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-1为标准库类型添加自定义功能&quot;],&quot;text&quot;:[0,&quot;场景 1：为标准库类型添加自定义功能&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;场景-2实现特定领域的类型约束&quot;],&quot;text&quot;:[0,&quot;场景 2：实现特定领域的类型约束&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;孤儿规则orphan-rule&quot;],&quot;text&quot;:[0,&quot;孤儿规则（Orphan Rule）&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;合法的实现&quot;],&quot;text&quot;:[0,&quot;合法的实现&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;非法的实现&quot;],&quot;text&quot;:[0,&quot;非法的实现&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;特化specialization的未来&quot;],&quot;text&quot;:[0,&quot;特化（Specialization）的未来&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;总结&quot;],&quot;text&quot;:[0,&quot;总结&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;关键要点&quot;],&quot;text&quot;:[0,&quot;关键要点&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;实践建议&quot;],&quot;text&quot;:[0,&quot;实践建议&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;延伸阅读&quot;],&quot;text&quot;:[0,&quot;延伸阅读&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Rust Trait：为泛型类型的具体实例实现特征&quot;],&quot;date&quot;:[3,&quot;2025-11-25T10:30:00.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;Rust&quot;],[0,&quot;Trait&quot;],[0,&quot;泛型&quot;],[0,&quot;类型系统&quot;]]],&quot;categories&quot;:[0,&quot;Rust 学习笔记&quot;],&quot;description&quot;:[0,&quot;深入理解 Rust 中 trait 实现的灵活性：为什么可以为 Vec&lt;String&gt; 这样的泛型类型具体实例实现 trait？探讨 Rust 类型系统中的类型特化（Type Specialization）、trait 实现的作用范围，以及如何利用这一特性编写更灵活的代码。&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/18&quot;]}],&quot;className&quot;:[0,&quot;w-full px-2&quot;],&quot;data-astro-cid-nxumbhks&quot;:[0,true]}" ssr client="load" opts="{&quot;name&quot;:&quot;SeriesNavigation&quot;,&quot;value&quot;:true}" await-children><div class="border-border mt-4 flex flex-col gap-3 border-t pt-4 md:mt-0 md:pt-2 w-full px-2"><div class="flex items-center justify-between gap-2"><a href="/blog/post/20" class="group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary max-w-[45%] min-w-0 flex-1" title="Rust 算术运算的 Panic 陷阱：从取模零说起"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 shrink-0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10.8284 12.0007L15.7782 16.9504L14.364 18.3646L8 12.0007L14.364 5.63672L15.7782 7.05093L10.8284 12.0007Z"></path></svg><span class="truncate text-xs">Rust 算术运算的 Panic 陷阱：从取模零说起</span></a><a href="/blog/post/18" class="group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary max-w-[45%] min-w-0 flex-1 justify-end text-right" title="Rust Trait：为泛型类型的具体实例实现特征"><span class="truncate text-xs">Rust Trait：为泛型类型的具体实例实现特征</span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 shrink-0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M13.1717 12.0007L8.22192 7.05093L9.63614 5.63672L16.0001 12.0007L9.63614 18.3646L8.22192 16.9504L13.1717 12.0007Z"></path></svg></a></div><div class="flex justify-center gap-2"><button class="flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary text-xs" title="回到顶部" aria-label="回到顶部"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.9999 10.8284L7.0502 15.7782L5.63599 14.364L11.9999 8L18.3639 14.364L16.9497 15.7782L11.9999 10.8284Z"></path></svg>回到顶部</button><button class="flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary text-xs" title="滚到底部" aria-label="滚到底部"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.9999 13.1714L16.9497 8.22168L18.3639 9.63589L11.9999 15.9999L5.63599 9.63589L7.0502 8.22168L11.9999 13.1714Z"></path></svg>滚到底部</button></div></div><!--astro:end--></astro-island> <astro-island uid="ZhqBkt" prefix="r29" component-url="/_astro/ScrollProgress.BRACH8UE.js" component-export="ScrollProgress" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;className&quot;:[0,&quot;mt-auto w-full rounded-full pt-4&quot;],&quot;data-astro-cid-nxumbhks&quot;:[0,true]}" ssr client="load" opts="{&quot;name&quot;:&quot;ScrollProgress&quot;,&quot;value&quot;:true}" await-children><div class="mt-auto w-full rounded-full pt-4"><div class="bg-primary h-1 origin-left rounded-full" style="transform:scaleX(0)"></div></div><!--astro:end--></astro-island> </div>   </div> </div> <script type="module" src="/_astro/MobileDrawer.astro_astro_type_script_index_0_lang.CiZBajGc.js"></script> <!-- 遮罩层 --><div id="search-overlay" data-state="closed" class="fixed inset-0 z-40 bg-black/50 opacity-0 backdrop-blur-sm transition-opacity duration-200 data-[state=closed]:hidden" role="presentation" aria-hidden="true"></div> <!-- 搜索对话框 --> <div id="search-dialog" data-state="closed" class="fixed inset-0 z-50 grid place-items-center px-4 data-[state=closed]:hidden" role="dialog" aria-label="搜索文章" aria-modal="true"> <div id="search-dialog-content" class="bg-gradient-start shadow-box w-full max-w-3xl overflow-auto rounded-xl opacity-0 transition-all duration-200"> <div class="relative p-6 md:p-3"> <div class="search-dialog"> <!-- Header --> <div class="relative mb-4 flex items-center justify-between"> <h2 class="flex items-center gap-2 text-lg font-semibold md:text-base"> <i class="fa-solid fa-magnifying-glass text-base md:text-sm" aria-hidden="true"></i>
搜索文章
</h2> <button id="search-dialog-close" class="flex size-8 items-center justify-center rounded-full bg-black/5 transition-colors duration-300 hover:bg-black/10 md:size-7 dark:bg-white/10 dark:hover:bg-white/20" aria-label="关闭搜索"> <i class="fa-solid fa-xmark text-base md:text-sm" aria-hidden="true"></i> </button> </div> <div id="search-empty-hint" class="search-empty-hint absolute inset-x-0 top-32 text-center text-sm opacity-60 md:top-28"> <p>输入关键词搜索博客文章</p> <p class="mt-1 text-xs">
按 <kbd class="rounded bg-black/10 px-1.5 py-0.5 font-mono dark:bg-white/10">ESC</kbd> 关闭
</p> </div> <!-- Search Content Area --> <div class="vertical-scrollbar scroll-feather-mask -mx-6 h-[calc(80dvh-140px)] overflow-auto scroll-smooth px-6 pb-10 md:-mx-3 md:h-[calc(80dvh-120px)] md:px-3"> <!-- Search Container --> <div id="search-dialog-container"></div> </div> </div> <!-- Keyboard hints --> <div class="bg-background/2 absolute inset-x-0 bottom-0 z-10 flex items-center justify-center gap-4 px-4 pt-2 pb-4 text-xs text-black/50 dark:border-white/10 dark:text-white/50"> <span><kbd class="kbd">↑↓</kbd> 选择</span> <span><kbd class="kbd">Enter</kbd> 打开</span> <span><kbd class="kbd">ESC</kbd> 关闭</span> </div> </div> </div> </div> <script type="module" src="/_astro/SearchDialog.astro_astro_type_script_index_0_lang.rdAe_kv8.js"></script>  <!-- 遮罩层 --><div id="code-fullscreen-overlay" data-state="closed" class="fixed inset-0 z-40 bg-black/80 opacity-0 backdrop-blur-sm transition-opacity duration-200 data-[state=closed]:hidden" role="presentation" aria-hidden="true"></div> <!-- 代码全屏对话框 --> <div id="code-fullscreen-dialog" data-state="closed" class="fixed inset-0 z-50 grid place-items-center px-4 data-[state=closed]:hidden" role="dialog" aria-label="代码全屏预览" aria-modal="true"> <div id="code-fullscreen-content" class="bg-background relative flex h-[85vh] w-[90vw] max-w-6xl flex-col overflow-hidden rounded-xl opacity-0 shadow-2xl transition-opacity duration-200 md:max-w-[90vw]"> <!-- Toolbar --> <div class="border-border bg-muted/50 flex shrink-0 items-center justify-between border-b px-4 py-3 backdrop-blur-sm"> <div class="flex items-center gap-3"> <div class="flex gap-2"> <span class="h-3 w-3 rounded-full bg-[#ff5f56]"></span> <span class="h-3 w-3 rounded-full bg-[#ffbd2e]"></span> <span class="h-3 w-3 rounded-full bg-[#27c93f]"></span> </div> <span id="code-fullscreen-language" class="text-muted-foreground font-mono text-xs font-medium tracking-wider uppercase">
text
</span> </div> <div class="flex items-center gap-1"> <button id="code-fullscreen-copy" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-2 rounded-md px-3 py-1.5 transition-colors"> <!-- Copy icon --> <svg id="code-fullscreen-copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 448 512" fill="currentColor"> <path d="M192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-200.6c0-17.4-7.1-34.1-19.7-46.2L370.6 17.8C358.7 6.4 342.8 0 326.3 0L192 0zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-64 0 0 16-192 0 0-256 16 0 0-64-16 0z"></path> </svg> <!-- Checkmark icon (hidden by default) --> <svg id="code-fullscreen-check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" class="hidden"> <mask id="checkmark-anim-fullscreen"> <g fill="none" stroke="#fff" stroke-dasharray="24" stroke-dashoffset="24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"> <path d="M2 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" dur="0.4s" values="24;0"></animate> </path> <path stroke="#000" stroke-width="6" d="M7.5 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"></animate> </path> <path d="M7.5 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"></animate> </path> </g> </mask> <rect width="24" height="24" fill="currentColor" mask="url(#checkmark-anim-fullscreen)"></rect> </svg> <span id="code-fullscreen-copy-text" class="text-sm">复制</span> </button> <button id="code-fullscreen-close" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground rounded-md p-2 transition-colors" aria-label="关闭"> <i class="fa-solid fa-xmark text-base" aria-hidden="true"></i> </button> </div> </div> <!-- Code Content --> <div class="scroll-feather-mask flex-1 overflow-auto"> <pre id="code-fullscreen-pre" class="p-4"><code id="code-fullscreen-code"></code></pre> </div> </div> </div> <script type="module" src="/_astro/CodeBlockFullscreen.astro_astro_type_script_index_0_lang.DlZ7j563.js"></script> <!-- Overlay --><div id="mermaid-fullscreen-overlay" data-state="closed" class="fixed inset-0 z-40 bg-black/80 opacity-0 backdrop-blur-sm transition-opacity duration-200 data-[state=closed]:hidden" role="presentation" aria-hidden="true"></div> <!-- Mermaid Fullscreen Dialog --> <div id="mermaid-fullscreen-dialog" data-state="closed" class="fixed inset-0 z-50 grid place-items-center px-4 data-[state=closed]:hidden" role="dialog" aria-label="Mermaid diagram fullscreen" aria-modal="true"> <div id="mermaid-fullscreen-content" class="bg-background relative flex h-[85vh] w-[90vw] max-w-6xl flex-col overflow-hidden rounded-xl opacity-0 shadow-2xl transition-opacity duration-200 md:max-w-[90vw]"> <!-- Toolbar --> <div class="border-border bg-muted/50 flex shrink-0 items-center justify-between border-b px-4 py-3 backdrop-blur-sm"> <div class="flex items-center gap-3"> <div class="flex gap-2"> <span class="h-3 w-3 rounded-full bg-[#ff5f56]"></span> <span class="h-3 w-3 rounded-full bg-[#ffbd2e]"></span> <span class="h-3 w-3 rounded-full bg-[#27c93f]"></span> </div> <span class="text-muted-foreground font-mono text-xs font-medium tracking-wider uppercase"> mermaid </span> </div> <div class="flex items-center gap-1"> <!-- Zoom info --> <span id="mermaid-zoom-level" class="text-muted-foreground mr-2 text-sm">100%</span> <!-- Reset zoom button --> <button id="mermaid-fullscreen-reset" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-2 rounded-md px-3 py-1.5 transition-colors" title="Reset zoom"> <i class="fa-solid fa-rotate-right text-sm" aria-hidden="true"></i> </button> <!-- Copy button --> <button id="mermaid-fullscreen-copy" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-2 rounded-md px-3 py-1.5 transition-colors"> <svg id="mermaid-fullscreen-copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 448 512" fill="currentColor"> <path d="M192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-200.6c0-17.4-7.1-34.1-19.7-46.2L370.6 17.8C358.7 6.4 342.8 0 326.3 0L192 0zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-64 0 0 16-192 0 0-256 16 0 0-64-16 0z"></path> </svg> <svg id="mermaid-fullscreen-check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" class="hidden"> <mask id="checkmark-anim-mermaid-fullscreen"> <g fill="none" stroke="#fff" stroke-dasharray="24" stroke-dashoffset="24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"> <path d="M2 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" dur="0.4s" values="24;0"></animate> </path> <path stroke="#000" stroke-width="6" d="M7.5 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"></animate> </path> <path d="M7.5 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"></animate> </path> </g> </mask> <rect width="24" height="24" fill="currentColor" mask="url(#checkmark-anim-mermaid-fullscreen)"></rect> </svg> <span id="mermaid-fullscreen-copy-text" class="text-sm">Copy</span> </button> <!-- Close button --> <button id="mermaid-fullscreen-close" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground rounded-md p-2 transition-colors" aria-label="Close"> <i class="fa-solid fa-xmark text-base" aria-hidden="true"></i> </button> </div> </div> <!-- SVG Container with zoom/pan --> <div id="mermaid-fullscreen-viewport" class="flex flex-1 cursor-grab items-center justify-center overflow-hidden active:cursor-grabbing"> <div id="mermaid-fullscreen-svg" class="mermaid-svg-container origin-center transition-transform duration-100"></div> </div> </div> </div> <script type="module" src="/_astro/MermaidFullscreen.astro_astro_type_script_index_0_lang.1oZJ2I3k.js"></script> </div> </body></html>